(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1079:function(e,t,a){e.exports={chatThread:"_30PXV",userName:"_1Zgab",profileLink:"tvmzp",rightHeaderIcons:"_2hs6N",smsButton:"_3zHJ9",callButton:"_3xBTg",flagBtn:"CNK1L",tipsBtn:"_1KoME",adImg:"_12TKz",chatContainer:"_1ZsL6",chatScroller:"_2eO1R",increasedSroller:"_2_vA-",rotate180:"_3p7El",messageBox:"_3dOi3",messageTextBox:"pajTZ",messageBoxVoice:"_3t0Zy",messageBoxSend:"_3kVyA",messageSendVoice:"_2zDEN",messageStopVoice:"_3gFf7",recordingActionsContainer:"-e6jh",recordingSign:"hYZpe",recordingText:"_-4JMk",secondsRecordedText:"_1YMyE",attachmentIcon:"_3ITiD",attachIcon:"_2CF_U",attachmentContainer:"_2QItI",first:"_3LvtQ",last:"_2BTF9",attachmentChild:"_1ijt5",shareIcon:"_2kCQS",shareText:"_22BwL",enabled:"_1tQpn",disabled:"L8QnD",buttonContainer:"_3AJtw",buttonStyle:"_324WP",itemWrapper:"_1prpQ",toastContainer:"R0Jck",desktopUnreadToast:"QbO7i",unreadToastContainer:"_2Ur26",smsCalltoast:"_1khU6",toastWrapper:"_2epr8",unreadMsgToastWrapper:"zjvvv",toastIcon:"_20HOk",phoneIcon:"_1eINZ",toastText:"DxTPk",unreadMsgToastText:"_2nAty",timeToast:"_2JSSH",voiceRecordedContainer:"CQLgd",msgContainer:"_1_D3U",noMsgPadding:"_2BHKM",voiceMessageContainer:"_3Mw6t",voiceAvatarContainer:"_3ImUy",senderVoiceIcon:"_1_wW2",recieverVoiceIcon:"_3egHi",voiceMessagePlayer:"_1XpRv",playButton:"_3v3aT",sliderContainer:"_1YKdT",filledSlider:"_2AAxE",slider:"_3CYWE",dataContainer:"_2etGf",durationContainer:"_3slFr",dateContainer:"_3Tlqb",voiceLoadError:"_3nNfi",voiceErrorMessage:"_3LelV",sentloaderColor:"_36YUG",recievedloaderColor:"_2IE3j",sentMsg:"_1vXaS",recievedMsg:"_3N7OA",playingSlider:"_3fLix",chatMsg:"_3a1n2",msgArrow:"_2B6hF",sentArrow:"_1GSeq",recievedArrow:"BZHrs",popup:"_199SR",chatDate:"sCDHz",displayed:"_1z2MP",notDisplayed:"_2Otva",notDisplayedFeature:"_3TL6n",msgIcons:"_15m6Y",userInfo:"_2TD_7",userTitle:"_2m3zy",titleTranslate:"_2JV8H",userStatus:"_2Q2j2",systemMessage:"_2POVl",enter:"_21DlB","enter-active":"pV4GO",leave:"_365Uz","leave-active":"dZRXk",hidden:"_2Axgu",shareMsgContainer:"_2HtUP",shareImgMsg:"_1Knhk",shareLocMsg:"_1EgYY",timeBox:"_1Z-G3",time:"dfEHh",imagePreview:"BHYjm",loadingContainer:"_3hn1L",icon:"_1Y0ET",loader:"_35ro5",loadingIcon:"_3nRgZ",gradient:"_3x32G",blockModal:"_3UTs6",modalTitle:"_3T2Zi",messageInfo:"dFQI9",refreshIcon:"_1ObC6",optionsMenu:"_2WtiA",dropDownList:"_2T_RL",smsModal:"_3KsIN",avatar:"_2WwnL",avatarWithImage:"Aaf-S",chatHeaderIcons:"_2jS4e",attachmentEmptyChild:"Il7H_"}},1146:function(e,t,a){e.exports={loader:"_1EqkP",callToActions:"ZXDzH",price:"_3ZTlJ",title:"_1yIAw",adExpiration:"_1XVRD",adExpired:"_1RNh4",adWillExpire:"VOOb0",cta:"_3Crc-",width32:"wziTw",buyerCTA:"_2Haba",confirmModal:"_1IyVq",makeAnOfferModal:"_2uGeF",chatLink:"_3nlJm",callToActionCard:"_1p1Lq",disabled:"_2iUP_",callToActionsUserItem:"_2jbb7",callToActionsUserItemContent:"_15uZM",userIsSeller:"_22xiE",modalPopup:"_3YsIO",markAsSoldModal:"_1wNrp",selectedIcon:"_1gI46",buyersMainHeading:"duOZa",itemCard:"_3miUG",itemImage:"_2pZHb",itemDesc:"_3BsQx",clear:"Y1vUS",callModal:"_2UQix",smsModal:"_3t-Za"}},1171:function(e,t,a){"use strict";t.__esModule=!0;var s=C(a(24)),n=C(a(13)),o=C(a(20)),i=C(a(21)),r=C(a(173)),d=C(a(32)),l=C(a(1)),u=C(a(0)),c=C(a(1172)),p=C(a(129)),f=C(a(236)),h=a(54),m=a(44),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(10)),v=C(a(238)),I=a(377);function C(e){return e&&e.__esModule?e:{default:e}}var M=function(e){var t=["size","zoom","language","scale","maptype","markers"],a={center:e.latitude+","+e.longitude},s=(0,d.default)(e),n=Array.isArray(s),o=0;for(s=n?s:(0,r.default)(s);;){var i;if(n){if(o>=s.length)break;i=s[o++]}else{if((o=s.next()).done)break;i=o.value}var l=i;t.includes(l)&&(a[l]=e[l])}return a},_=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.componentWillMount=function(){var e=M(this.props);"undefined"!=typeof window&&(this.props.staticMapUrl(e)||this.props.getStaticMapUrl(e))},t.prototype.componentWillReceiveProps=function(e){var t=this;["latitude","longitude","size","zoom","language","scale","maptype","markers"].reduce(function(a,s){return a||t.props[s]!==e[s]},!1)&&this.props.getStaticMapUrl(M(e))},t.prototype.render=function(){var e=void 0,t=this.props.staticMapUrl(M(this.props)),a=this.props.circleClassName||c.default.circle,n=f.default.className([c.default.mapCard,this.props.circle?a:null]),o=this.props.isFetchingStaticMapUrl(M(this.props));return this.props.hrefToGoogle?e="https://www.google.com/maps/place/"+this.props.latitude+","+this.props.longitude:this.props.href&&(e=this.props.href),o?(0,s.default)("div",{className:c.default.isFetchingMap},void 0,(0,s.default)(v.default,{className:c.default.loader})):e?(0,s.default)("div",{className:n},void 0,(0,s.default)(p.default,{to:e},void 0,(0,s.default)("img",{src:t}))):(0,s.default)("div",{className:n,onClick:this.props.onClick},void 0,(0,s.default)("img",{src:t}))},t}(u.default.Component);_.propTypes={circleClassName:l.default.string,circle:l.default.bool,href:l.default.string,hrefToGoogle:l.default.bool,onClick:l.default.func,latitude:l.default.string.isRequired,longitude:l.default.string.isRequired,size:l.default.string,zoom:l.default.string,language:l.default.string,scale:l.default.string,maptype:l.default.string,markers:l.default.string,isFetchingStaticMapUrl:l.default.func,staticMapUrl:l.default.func,getStaticMapUrl:l.default.func},_.defaultProps={circle:!1,circleClassName:"",href:"",hrefToGoogle:!1,onClick:function(){},size:"640x256",zoom:"15",language:"es",scale:"1"};t.default=(0,m.connect)(function(e){return{isFetchingStaticMapUrl:function(t){return e.maps.isFetching[I.urls.getStaticMapUrl+"?"+g.paramsToQueryString(t)]},staticMapUrl:function(t){return e.maps.collections[I.urls.getStaticMapUrl+"?"+g.paramsToQueryString(t)]}}},function(e){return{getStaticMapUrl:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e((0,h.get)(I.urls.getStaticMapUrl,"MAPS",t))}}})(_)},1172:function(e,t,a){e.exports={mapCard:"_1ohyB",circle:"tPdnb",isFetchingMap:"CH99P",loader:"_23WNg",mobile:"_1sVb_",desktop:"_22Qby"}},1207:function(e,t,a){"use strict";t.__esModule=!0;var s=h(a(4)),n=h(a(24)),o=h(a(13)),i=h(a(20)),r=h(a(21)),d=h(a(0)),l=h(a(1)),u=h(a(1104)),c=h(a(1279)),p=h(a(346)),f=h(a(65));function h(e){return e&&e.__esModule?e:{default:e}}var m=p.default.icons,g=27,v=39,I=37,C=function(e){function t(){var a,s,n;(0,o.default)(this,t);for(var r=arguments.length,d=Array(r),l=0;l<r;l++)d[l]=arguments[l];return a=s=(0,i.default)(this,e.call.apply(e,[this].concat(d))),s.next=function(e){s.slider.slickNext(),s.stopEvent(e)},s.previous=function(e){s.slider.slickPrev(),s.stopEvent(e)},s.closeImage=function(e){s.stopEvent(e),s.props.toggleFullScreen()},s.handleKeyDown=function(e){e.keyCode===g&&s.props.toggleFullScreen(),e.keyCode===I&&s.previous(e),e.keyCode===v&&s.next(e)},s.stopEvent=function(e){e.preventDefault(),e.stopPropagation()},n=a,(0,i.default)(s,n)}return(0,r.default)(t,e),t.prototype.componentDidMount=function(){"undefined"!=typeof document&&(document.body.style.overflow="hidden",document.addEventListener("keydown",this.handleKeyDown,!0))},t.prototype.componentWillUnmount=function(){"undefined"!=typeof document&&(document.body.style.overflow="auto",document.removeEventListener("keydown",this.handleKeyDown,!0))},t.prototype.render=function(){var e=this,t=void 0;this.props.images.length>1&&(t=(0,n.default)("div",{className:c.default.arrows},void 0,(0,n.default)("span",{className:(0,f.default)(c.default.arrow,c.default.prev,m.panameraIcons,m["icon-ArrowLeft"]),onClick:this.previous}),(0,n.default)("span",{className:(0,f.default)(c.default.arrow,c.default.next,m.panameraIcons,m["icon-ArrowRight"]),onClick:this.next})));var a=this.props.images.map(function(t,a){var s=t.src;return t.full?s=t.full.url:t.imageUrls&&t.imageUrls.full&&(s=t.imageUrls.full.url),(0,n.default)("div",{},void 0,(0,n.default)("div",{className:c.default.slides},a,(0,n.default)("div",{className:(0,f.default)(c.default.imageWrapper,e.props.imageWrapperClassname)},void 0,(0,n.default)("img",{src:s,onClick:e.stopEvent,alt:e.props.alt+" "+a})),t.label&&(0,n.default)("div",{className:c.default.imageLabel},void 0,t.label)))}),o={speed:500,dots:!0,arrows:!1,infinite:!0,lazyLoad:!0,slidesToShow:1,slidesToScroll:1,dotsClass:c.default.customPaging,className:c.default.fullScreenSlider,initialSlide:this.props.initialSlide,customPaging:function(t){return(0,n.default)("span",{},void 0,t+1," / ",e.props.images.length)},afterChange:function(t){return e.props.onChange(t)}};return(0,n.default)("section",{className:c.default.imageGallery},void 0,(0,n.default)("div",{className:c.default.fullScreen,onClick:this.closeImage,onKeyPress:this.handleKeyDown},void 0,d.default.createElement(u.default,(0,s.default)({ref:function(t){return e.slider=t}},o),a),t,(0,n.default)("span",{className:(0,f.default)(c.default.close,m.panameraIcons,m["icon-Cross"]),onClick:this.closeImage}),this.props.children))},t}(d.default.PureComponent);C.propTypes={images:l.default.array,toggleFullScreen:l.default.func,initialSlide:l.default.number,children:l.default.oneOfType([l.default.element,l.default.array,l.default.string]),alt:l.default.string,onChange:l.default.func,imageWrapperClassname:l.default.string},C.defaultProps={images:[],initialSlide:0,toggleFullScreen:function(){},onChange:function(){},alt:"",imageWrapperClassname:""},t.default=C},1276:function(e,t,a){"use strict";t.__esModule=!0,t.mapDispatchToProps=t.mapStateToProps=t.ReportModal=void 0;var s=w(a(24)),n=w(a(56)),o=w(a(13)),i=w(a(20)),r=w(a(21)),d=w(a(1)),l=w(a(0)),u=a(31),c=a(44),p=w(a(1277)),f=w(a(172)),h=a(64),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(170)),g=w(a(165)),v=w(a(1189)),I=w(a(1052)),C=w(a(238)),M=w(a(1102)),_=w(a(355)),y=w(a(104)),S=w(a(128));function w(e){return e&&e.__esModule?e:{default:e}}var k=(0,f.default)().fetch,b=t.ReportModal=function(e){function t(a){(0,o.default)(this,t);var r=(0,i.default)(this,e.call(this,a));return r.handleReason=function(e){r.setState({reason:e.value,reasonIsValid:!0})},r.handleComment=function(e){r.setState({comment:e,commentIsValid:!!e})},r.reportAd=function(){var e={};if(r.state.reason&&r.state.comment){e.type=r.state.reason,e.description=r.state.comment;var t={method:"POST",body:(0,n.default)(e),headers:{Accept:"application/json","Content-Type":"application/json"}};"users"===r.props.type?r.props.track("trust_tap_report_user",{reason:r.state.reason,user_affected:r.props.ID}):r.props.track("trust_tap_report_ad",{reason:r.state.reason,item_id:r.props.ID}),r.setState({showLoader:!0}),k("/api/"+r.props.type+"/"+r.props.ID+"/report",t).then(function(e){return e}).then(function(e){r.setState({showLoader:!1}),m.isSuccess(e.status)&&(r.props.setToastMessageState({isOpen:!0,message:(0,s.default)(h.FormattedMessage,{id:"report_sent_message"}),expiration:5e3}),r.props.onClick())},function(e){r.props.setToastMessageState({isOpen:!0,message:e,expiration:5e3})})}else r.setState({reasonIsValid:!!r.state.reason,commentIsValid:!!r.state.comment})},r.state={reason:"",comment:"",showLoader:!1,reasonIsValid:!0,commentIsValid:!0},r.translations={reportModalTitle:"users"===a.type?(0,s.default)(h.FormattedMessage,{id:"report_profile_title"}):(0,s.default)(h.FormattedMessage,{id:"report_ad_title"})},r}return(0,r.default)(t,e),t.prototype.render=function(){var e=this,t=void 0,a=this.props.bannedReasons[this.props.type].map(function(t,a){return(0,s.default)("li",{},a,(0,s.default)(M.default,{id:t.value,name:t.value,value:t.value,checked:e.state.reason===t.value,onClick:e.handleReason}),(0,s.default)("label",{htmlFor:t.value},void 0,(0,s.default)(h.FormattedMessage,{id:t.key})))});return t=this.state.showLoader?(0,s.default)(C.default,{className:p.default.loader}):(0,s.default)(l.default.Fragment,{},void 0,(0,s.default)("div",{className:p.default.reasons,"data-aut-id":"reasons"},void 0,(0,s.default)("ul",{},void 0,a),!this.state.reasonIsValid&&(0,s.default)("span",{className:p.default.error,"data-aut-id":"reasonError"},void 0,(0,s.default)(h.FormattedMessage,{id:"report_error_no_reason"}))),(0,s.default)(v.default,{value:this.state.comment,name:"comment",placeholder:this.props.intl.formatMessage({id:"comment"}),onChange:this.handleComment,className:p.default.inputComment,placeholderAnimation:!0,errorMessage:this.state.commentIsValid?"":this.props.intl.formatMessage({id:"report_error_no_comment"})}),(0,s.default)(g.default,{type:"btnMain",className:p.default.submitBtn,onClick:this.reportAd,"data-aut-id":"reportAd"},void 0,(0,s.default)(h.FormattedMessage,{id:"send_complaint"}))),(0,s.default)(I.default,{onClick:this.props.onClick,title:this.state.showLoader?"":this.translations.reportModalTitle,className:p.default.reportModal},void 0,t)},t}(l.default.Component);b.propTypes={onClick:d.default.func.isRequired,type:d.default.string.isRequired,ID:d.default.string.isRequired,setToastMessageState:d.default.func.isRequired,track:d.default.func.isRequired,bannedReasons:d.default.object.isRequired,intl:d.default.object.isRequired};var T=t.mapStateToProps=function(e,t){return{bannedReasons:t.config.get("bannedReasons")}},N=t.mapDispatchToProps=function(e){return{setToastMessageState:function(t){return e((0,_.default)(t))}}};t.default=(0,u.compose)(y.default,S.default,h.injectIntl,(0,c.connect)(T,N))(b)},1277:function(e,t,a){e.exports={reportModal:"Unp-o",loader:"_3s4tQ",reasons:"_1F6Y_",error:"w49EI",inputComment:"na52_",submitBtn:"_3UJUX"}},1279:function(e,t,a){e.exports={fullScreen:"_1kYfr",arrow:"wReyS",close:"_1N7mv",arrows:"_2D6Zs",prev:"GFnBk",next:"_3Dhfh",customPaging:"_1ZOOm",fullScreenSlider:"_7OdTj",slides:"gTtSk",imageWrapper:"_2EnR3",imageLabel:"_3Wvhp"}},1301:function(e,t){e.exports="/assets/img-tips.olx.dd67e799.png"},1339:function(e,t,a){"use strict";t.__esModule=!0;var s=i(a(26)),n=i(a(13)),o=i(a(1290));function i(e){return e&&e.__esModule?e:{default:e}}var r=3,d=4,l=5,u=function(){function e(){(0,n.default)(this,e),this.db=new o.default("intelliChat"),this.db.version(1).stores({interventions:"userId,uniqueId,interventionId,itemId,timestamp",interventionData:"id,type,priority"}),this.db.version(2).stores({interventions:null,interventionData:"id,type,priority"}),this.db.version(r).stores({interventions:"[userId+itemId],uniqueId,userId,interventionId,itemId,timestamp",interventionData:"id,type,priority"}),this.db.version(d).stores({interventions:null,interventionData:"id,type,priority"}),this.db.version(l).stores({interventions:"userItemId,uniqueId,userId,interventionId,itemId,timestamp",interventionData:"id,type,priority"}).upgrade(function(e){e.interventions.toCollection().modify(function(e){e.userItemId=e.userId+"_"+e.itemId})}),this.db.open().catch(function(e){return console.error(e)})}return e.prototype.saveInterventionIdData=function(e,t){return t.id=e,this.db.interventionData.put(t)},e.prototype.saveInterventionsData=function(e){var t=this;if(e.length){var a={},s=[];return e.forEach(function(e){if(e){var n=e.id.toString(),o={type:e.type,shownWindow:e.display_screen,text:e.display_text||"",actions:e.actions,priority:e.priority,invalidateConditions:e.remove_conditions,icon:e.icon};a[n]=o,s.push(t.saveInterventionIdData(n,o).catch(function(){}))}}),o.default.Promise.all(s).then(function(){return a}).catch(function(){})}return null},e.prototype.getInterventionsData=function(){return this.db.interventionData.toArray().then(function(e){var t={};return e.forEach(function(e){t[e.id]=e}),t})},e.prototype.getUserIntervention=function(e,t){return this.db.interventions.where("userItemId").equals(e+"_"+t).toArray()},e.prototype.getInterventionIdData=function(e){return this.db.interventionData.where("id").equals(e).toArray()},e.prototype.getRemoveConditions=function(e){return this.db.interventionData.where("id").equals(e).toArray().then(function(e){return e[0]&&e[0].invalidateConditions})},e.prototype.saveIntervention=function(e,t){var a=this,n=e.intervention,o=n.userId&&n.userId.split("_")[0],i=n.interventionId;return this.getUserIntervention(o,e.extras.itemId).then(function(r){var d=r[0];return a.getInterventionIdData(i).then(function(l){if(l.length){var u=l[0],c=u.priority,p=u.invalidateConditions&&u.invalidateConditions.expiry_time,f={},h=[];if(n.price&&(f.price=n.price),!d||c&&c<d.priority||e.extras.itemId!==r[0].itemId)return a.db.interventions.put({uniqueId:o+"_"+e.extras.itemId+"_"+i,interventionId:i,userId:o,itemId:e.extras.itemId,timestamp:t,params:f,priority:c,userItemId:o+"_"+e.extras.itemId,expiry:p&&t+1e3*p||"",id:e.id}).then(function(){return r.length&&h.push({event:"item_chat_interv_invalidated",data:{intervention_id:d.interventionId,interv_msg_id:d.id,item_id:d.itemId}}),h.push({event:"item_chat_interv_received",data:{intervention_id:n.interventionId,interv_msg_id:e.id,item_id:e.extras.itemId}}),h})}return s.default.reject()})})},e.prototype.updateInterventionSeenData=function(e,t,a){var s={seen:a};return this.db.interventions.update([e,t],s)},e.prototype.getActiveInterventions=function(){return this.db.interventions.toArray().then(function(e){var t={};return e.forEach(function(e){t[e.userId+"_"+e.itemId]=e}),t})},e.prototype.removeIntervention=function(e,t,a){return this.db.interventions.where("uniqueId").equals(e+"_"+t+"_"+a).delete()},e.prototype.removeUserIntervention=function(e,t){return this.db.interventions.where("userItemId").equals(e+"_"+t).delete()},e.prototype.clear=function(){return this.db.interventions.clear()},e}();t.default=u},1366:function(e,t,a){"use strict";t.__esModule=!0;var s=v(a(24)),n=v(a(13)),o=v(a(20)),i=v(a(21)),r=v(a(0)),d=v(a(1)),l=a(44),u=v(a(1367)),c=a(351),p=a(64),f=v(a(346)),h=v(a(1052)),m=v(a(165)),g=v(a(1301));function v(e){return e&&e.__esModule?e:{default:e}}var I=f.default.icons,C=3,M=function(e){function t(a,i){(0,n.default)(this,t);var r=(0,o.default)(this,e.call(this,a));return r.checkTime=function(){r.timeSpent+=1,r.timeSpent>=C&&(window.localStorage.setItem("sufficientTimeSpent",!0),r.track("FTUE_read_user_tips"),clearInterval(r.interval))},r.handleContinue=function(){window&&window.localStorage&&!window.localStorage.getItem("seenFirstTimeUserTips")&&window.localStorage.setItem("seenFirstTimeUserTips",!0),r.track("FTUE_tap_continue"),r.props.toggleModal()},r.bindings={track:r.track.bind(r)},r.btnText="","chat"===a.initationPoint||"toolTip"===a.initationPoint||"contextualTip"===a.initationPoint?r.btnText=(0,s.default)(p.FormattedMessage,{id:"continueToChat"}):"call"===a.initationPoint?r.btnText=(0,s.default)(p.FormattedMessage,{id:"continueToCall"}):"sms"===a.initationPoint?r.btnText=(0,s.default)(p.FormattedMessage,{id:"continueToSms"}):"makeAnOffer"===a.initationPoint&&(r.btnText=(0,s.default)(p.FormattedMessage,{id:"continueToOffer"})),r.date=new Date,r.trackSelection={chat:"Chat",call:"call",makeAnOffer:"Make An Offer",toolTip:"Tool Tip",contextualTip:"cont_hints"},r.timeSpent=0,r.brand=i.config.get("theme","brand"),r}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){"chat"===this.props.origin&&"toolTip"!==this.props.initationPoint&&"contextualTip"!==this.props.initationPoint&&window&&window.localStorage&&window.localStorage.getItem("seenFirstTimeUserTips")||(this.track("FTUE_view_user_tips"),this.interval=setInterval(this.checkTime,1e3))},t.prototype.componentWillUnmount=function(){clearInterval(this.interval)},t.prototype.track=function(e){var t={origin:this.props.origin,select_from:this.trackSelection[this.props.initationPoint]};this.context.track(e,t)},t.prototype.render=function(){var e=this.context.config.get("firstTimeSafetyTip")&&!(window&&window.localStorage&&window.localStorage.getItem("seenFirstTimeUserTips")&&"chat"===this.props.origin),t="toolTip"===this.props.initationPoint||"contextualTip"===this.props.initationPoint,a={brand:this.brand&&this.brand.toUpperCase()};return e||t?(0,s.default)(h.default,{onClick:this.handleContinue,icon:!1,className:u.default.tipsModal+" "+u.default.modalPopup},void 0,(0,s.default)("div",{className:u.default.imgContainer},void 0,(0,s.default)("img",{src:g.default,width:"50",height:"50"})),(0,s.default)("div",{className:u.default.textContainer},void 0,(0,s.default)("p",{className:u.default.heading},void 0,(0,s.default)(p.FormattedMessage,{id:"ftutHeading"})),(0,s.default)("div",{className:u.default.tips},void 0,(0,s.default)("div",{className:u.default.iconSec},void 0,(0,s.default)("i",{className:I.panameraIcons+" "+I["icon-Cash"]+" "+u.default.tipsIcon})),(0,s.default)("div",{className:u.default.textSec},void 0,(0,s.default)(p.FormattedMessage,{id:"ftutAdvanceMoneyTips"}))),(0,s.default)("div",{className:u.default.tips},void 0,(0,s.default)("div",{className:u.default.iconSec},void 0,(0,s.default)("i",{className:I.panameraIcons+" "+I["icon-meeting"]+" "+u.default.tipsIcon})),(0,s.default)("div",{className:u.default.textSec},void 0,(0,s.default)(p.FormattedMessage,{id:"ftutMeetingTips"}))),(0,s.default)("div",{className:u.default.tips},void 0,(0,s.default)("div",{className:u.default.iconSec},void 0,(0,s.default)("i",{className:I.panameraIcons+" "+I["icon-Chat"]+" "+u.default.tipsIcon})),(0,s.default)("div",{className:u.default.textSec},void 0,(0,s.default)(p.FormattedMessage,{id:"ftutOLXChatTips",values:a}))),(0,s.default)("div",{className:u.default.tips+" "+u.default.reportTips},void 0,(0,s.default)("div",{className:u.default.iconSec},void 0,(0,s.default)("i",{className:I.panameraIcons+" "+I["icon-Flag"]+" "+u.default.tipsIcon})),(0,s.default)("div",{className:u.default.textSec},void 0,(0,s.default)(p.FormattedMessage,{id:"ftutReportFraudTips",values:a}))),(0,s.default)(m.default,{className:u.default.continueBtn,type:"btnOutline",onClick:this.handleContinue,"data-aut-id":"continueBtn"},void 0,this.btnText))):null},t}(r.default.Component);M.contextTypes={track:d.default.func,trackerOrigins:d.default.object,config:d.default.object},M.propTypes={toggleModal:d.default.func,initationPoint:d.default.string,origin:d.default.string};t.default=(0,l.connect)(null,function(e){return{setOriginTrack:function(t){return e((0,c.setOrigin)(t))}}})(M)},1367:function(e,t,a){e.exports={tipsModal:"_35b44",modalPopup:"r69ve",imgContainer:"_1t0aR",textContainer:"_1MYkU",heading:"_2B7D4",tips:"PTPqo",reportTips:"wwWmY",tipsIcon:"_3SHEO",iconSec:"_1wfKf",textSec:"_24sJx",continueBtn:"A_uYe"}},1376:function(e,t,a){"use strict";t.__esModule=!0,t.MarkAsSoldModal=t.mapDispatchToProps=t.mapStateToProps=void 0;var s=M(a(24)),n=M(a(13)),o=M(a(20)),i=M(a(21)),r=M(a(0)),d=M(a(1)),l=a(44),u=M(a(1377)),c=M(a(1146)),p=a(54),f=a(64),h=a(350),m=a(239),g=a(132),v=M(a(165)),I=M(a(1052)),C=M(a(238));function M(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(a,i){(0,n.default)(this,t);var r=(0,o.default)(this,e.call(this,a));return r.selectBuyer=function(e){r.setState({buyersId:e})},r.markAsSoldFunc=function(){var e={reason:"sold"};r.setState({showLoader:!0}),r.state.buyersId&&(e.buyer_id=r.state.buyersId),r.props.deleteItem(e,function(e,t){r.done(e,t),r.props.callback()})},r.state={buyersId:"",showLoader:!1},r.translations={someoneFromOutside:function(e){return(0,s.default)(f.FormattedMessage,{id:"someoneFromOutside",values:e})}},r.elements={someoneFromOutside:r.translations.someoneFromOutside({brand:i.config.get("theme","brand")})},r.styles={btnMain:{width:"100%",marginTop:"20px"}},r}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){this.props.buyers.length||this.props.getItemBuyers()},t.prototype.getItemCard=function(){var e="";return this.props.images&&this.props.images.length>0&&this.props.images[0].small&&(e=this.props.images[0].small.url),(0,s.default)("div",{className:c.default.itemCard},void 0,(0,s.default)("div",{style:{backgroundImage:"url("+e},className:c.default.itemImage}),(0,s.default)("div",{className:c.default.itemDesc},void 0,(0,s.default)("p",{},void 0,this.props.price),(0,s.default)("p",{},void 0,this.props.title)),(0,s.default)("p",{className:c.default.clear}))},t.prototype.getBuyersList=function(){var e=this;return[{id:null,name:this.elements.someoneFromOutside,avatar_id:1}].concat(this.props.buyers).map(function(t){return(0,s.default)(u.default,{buyer:t,buyersId:e.state.buyersId,selectBuyer:e.selectBuyer},t.id)})},t.prototype.done=function(e,t){e.ok&&(t((0,p.get)(m.urls.getItem(this.props.itemId),"ELEMENT_ITEMS")),this.props.onClick(),this.context.track("mark_as_sold_complete",{bucket_new:this.state.buyersId?this.state.buyersId:"outside",user_id:this.props.userId,item_id:this.props.itemId}))},t.prototype.render=function(){var e=void 0;return e=this.state.showLoader?(0,s.default)("div",{className:c.default.loader},void 0,(0,s.default)(C.default,{})):(0,s.default)("div",{},void 0,this.getItemCard(),(0,s.default)("div",{className:c.default.buyersList},void 0,(0,s.default)("h2",{},void 0,(0,s.default)(f.FormattedMessage,{id:"markAsSold"})),(0,s.default)("p",{className:c.default.buyersMainHeading},void 0,(0,s.default)(f.FormattedMessage,{id:"whomYouSold"})),(0,s.default)("ul",{},void 0,this.getBuyersList()),(0,s.default)(v.default,{type:"btnMain",style:this.styles.btnMain,onClick:this.markAsSoldFunc,"data-aut-id":"btnMarkAsSold"},void 0,(0,s.default)(f.FormattedMessage,{id:"markAsSold",tagName:"div"})))),(0,s.default)(I.default,{onClick:this.props.onClick,className:c.default.markAsSoldModal+" "+c.default.modalPopup},void 0,e)},t}(r.default.Component);_.contextTypes={track:d.default.func,config:d.default.shape({get:d.default.func})},_.propTypes={title:d.default.string.isRequired,price:d.default.string,images:d.default.array,itemId:d.default.string.isRequired,userId:d.default.string,onClick:d.default.func.isRequired,buyers:d.default.array,getItemBuyers:d.default.func,deleteItem:d.default.func,callback:d.default.func},_.defaultProps={price:"",userId:"",images:[],callback:function(){}};var y=t.mapStateToProps=function(e,t){return{isFetchingBuyers:e.users.isFetching[h.urls.getItemBuyers(t.itemId)],buyers:(0,g.getFilledCollection)(e.users,h.urls.getItemBuyers(t.itemId))}},S=t.mapDispatchToProps=function(e,t){return{getItemBuyers:function(){return e((0,p.get)(h.urls.getItemBuyers(t.itemId),"USERS"))},deleteItem:function(a,s){return e((0,p.del)(m.urls.deleteItem(t.itemId),"ITEMS",a)).then(function(t){return s(t,e)})}}};t.MarkAsSoldModal=_,t.default=(0,l.connect)(y,S)(_)},1377:function(e,t,a){"use strict";t.__esModule=!0;var s=f(a(24)),n=f(a(13)),o=f(a(20)),i=f(a(21)),r=f(a(1049)),d=f(a(346)),l=f(a(1)),u=f(a(0)),c=f(a(1146)),p=a(1056);function f(e){return e&&e.__esModule?e:{default:e}}var h=d.default.icons,m=function(e){function t(){(0,n.default)(this,t);var a=(0,o.default)(this,e.call(this));return a.bindings={selectBuyer:a.selectBuyer.bind(a)},a.styles={avatar:{flex:"0 0 40px"}},a}return(0,i.default)(t,e),t.prototype.selectBuyer=function(){this.props.selectBuyer(this.props.buyer.id)},t.prototype.render=function(){return(0,s.default)("li",{onClick:this.bindings.selectBuyer},void 0,this.props.buyersId===this.props.buyer.id&&(0,s.default)("span",{className:c.default.selectedIcon},void 0,(0,s.default)("i",{className:h.panameraIcons+" "+h["icon-OK"]})),this.props.buyersId!==this.props.buyer.id&&(0,s.default)(r.default,{image:(0,p.getUserImage)(this.props.buyer),diameter:"40px",style:this.styles.avatar}),(0,s.default)("p",{},void 0,this.props.buyer.name))},t}(u.default.Component);m.propTypes={buyer:l.default.object.isRequired,selectBuyer:l.default.func,buyersId:l.default.string},m.defaultProps={selectBuyer:function(){},buyersId:""},t.default=m},1380:function(e,t,a){e.exports={myChatsPage:"_20ggd",chatList:"_3fvDk",imageContainer:"_3lsZc",itemImage:"CzisG",loadingItemImage:"_1YR14",placeHolderShimmer:"_8MnD-",userImage:"_3kiaY",loadingUserImage:"_3oI12",tabsHolder:"YKcxO",tabsTitle:"_3ZfYI",selected:"_4cGPg",unreadMessages:"_2MUba",itemInfoBox:"_1R5Yn",chatHeader:"_33D-O",loading:"_34nwN",itemInfo:"_3Wb0W",lastMessage:"U96GK",moreInfo:"_11GTY",postingDate:"ARexy",themeColor:"_1wkn9",price:"RQbhk",chatContainerUnread:"_3O3C2",chatContainerRead:"_3F1eT",chatContainer:"_3JKcp",currentConv:"_233G5",deleteButtonDiv:"_3pysS",actionHeader:"_33fbQ",headerPart2:"_2oP6o",dropDown:"_1NvkR",dropDownList:"_1I8-R",optionsDiv:"_1TlGz",chatNotificationContainer:"_1lgz4",notificationText:"_19GHC",noConversation:"_1ecm3",itemCount:"_3cibb",count:"_1G9l3",msgIcons:"_2EmfW",displayed:"gLCom",lstmsg:"_2WLQT",voiceMsg:"_1ZRkF",options:"_1nj4J",downArrow:"_2ukza",radioBtn:"_1Rx4Q",active:"_2xPDx",fill:"_31hWJ",disabled:"_1_YZn",closeButton:"qtmrk",deleteButton:"_1shr5",enabled:"_1g0l1",infoContainer:"_3A_br",loader:"_3pojW",refreshIcon:"_2_J8p",customTranstion:"_2RLGm",clear:"_1QBX5",searchBox:"_3QJZ_",crossIcon:"_eCUI",searchIcon:"_2M0Sw",messageSearchBox:"_3gLYX",highlight:"_1w-9j",offline:"OCq2c"}},1381:function(e,t,a){"use strict";t.__esModule=!0,t.PriceInput=t.mapDispatchToProps=t.mapStateToProps=void 0;var s=g(a(4)),n=g(a(24)),o=g(a(13)),i=g(a(20)),r=g(a(21)),d=g(a(1)),l=g(a(0)),u=g(a(1382)),c=a(44),p=a(54),f=a(64),h=g(a(1059)),m=a(67);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(a){(0,o.default)(this,t);var s=(0,i.default)(this,e.call(this,a));return s.state={value:0,showCurrency:!1},s.extras=s.props.extras,s.extras.min=s.props.extras.min||1,s.translations={price:a.label?a.label:(0,n.default)("span",{},void 0,(0,n.default)(f.FormattedMessage,{id:"price"})," *")},s}return(0,r.default)(t,e),t.prototype.componentDidMount=function(){this.props.config||this.props.getConfig()},t.prototype.componentWillReceiveProps=function(e){this.props.extras!==e.extras&&(this.extras=(0,s.default)({},this.props.extras,e.extras))},t.prototype.render=function(){var e=void 0,t=void 0,a=void 0,s=this.props.config,o=s&&s.location&&s.location.currencies?s.location.currencies:[];return 1===o.length&&(o[0].pre?(a=u.default.prePrice,e=(0,n.default)("div",{className:u.default.currency+" "+u.default.preCurrency},void 0,o[0].pre)):o[0].post&&(a=u.default.postPrice,t=(0,n.default)("div",{className:u.default.currency+" "+u.default.postCurrency},void 0,o[0].post))),(0,n.default)("div",{className:u.default.priceField},void 0,void 0,e,(0,n.default)(h.default,{className:a,name:"price",id:"price",type:"number",onChange:this.props.onChange,errorText:this.props.errorText,onFocus:this.props.onFocus,onBlur:this.props.onBlur,isInvalid:this.props.isInvalid,value:this.props.price,label:this.translations.price,extras:this.extras,autoFocus:this.props.autoFocus}),t)},t}(l.default.Component);v.propTypes={onChange:d.default.func,isInvalid:d.default.bool,errorText:d.default.oneOfType([d.default.element,d.default.string]),price:d.default.string,config:d.default.object,getConfig:d.default.func,onFocus:d.default.func,onBlur:d.default.func,extras:d.default.object,label:d.default.string,autoFocus:d.default.bool},v.defaultProps={onChange:function(){},onFocus:function(){},onBlur:function(){},price:"",extras:{},autoFocus:!1};var I=t.mapStateToProps=function(e){return{config:e.config.collections[m.urls.getConfig]}},C=t.mapDispatchToProps=function(e){return{getConfig:function(){return e((0,p.get)(m.urls.getConfig,"CONFIG"))}}};t.PriceInput=v,t.default=(0,c.connect)(I,C)(v)},1382:function(e,t,a){e.exports={priceField:"_2Ptix",currency:"_2HDor",preCurrency:"_1YTqO",postCurrency:"_2fQfX",prePrice:"_2WxjH",postPrice:"_22ccO"}},1386:function(e,t,a){"use strict";t.__esModule=!0,t.getString=t.render=void 0;var s=o(a(24)),n=(o(a(0)),a(64));function o(e){return e&&e.__esModule?e:{default:e}}t.render=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments[2];return"function"==typeof a?(0,s.default)(n.FormattedMessage,{id:e,values:t},void 0,function(e){return a(e)}):(0,s.default)(n.FormattedMessage,{id:e,values:t})},t.getString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,n.defineMessages)({data:{id:t}}).data}},1427:function(e,t){},1428:function(e,t){},1445:function(e,t){},1448:function(e,t){},1500:function(e,t,a){"use strict";t.__esModule=!0,t.ConversationComponent=t.mapDispatchToProps=t.mapStateToProps=void 0;var s=b(a(24)),n=b(a(13)),o=b(a(20)),i=b(a(21)),r=a(239),d=a(350),l=b(a(1049)),u=b(a(1080)),c=b(a(346)),p=b(a(1501)),f=b(a(1)),h=b(a(0)),m=a(64),g=a(44),v=a(54),I=b(a(1380)),C=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(1061)),M=a(380),_=b(a(2043)),y=a(82),S=a(31),w=a(1056),k=b(a(104));function b(e){return e&&e.__esModule?e:{default:e}}var T=c.default.icons,N=function(e){function t(a){(0,n.default)(this,t);var i=(0,o.default)(this,e.call(this,a));return i.deleteChat=function(e){return function(){i.props.deleteChat(e)}},i.onInterventionClick=function(e,t,a){i.props.showRadioButton&&i.props.showDeleteChatOption(),i.props.router.push("/nf/chat/user/"+i.props.conversation.userId+"/"+i.props.conversation.itemId),e&&e.msg&&i.props.onInterventionClick(e,t,a)},i.onListClick=function(){i.props.showRadioButton?(i.setState({fillButton:!i.state.fillButton}),i.props.toggleButton()):i.props.onClick()},i.optionsClick=function(e){e.stopPropagation()},i.getDefaultUserName=function(){return(0,s.default)(m.FormattedMessage,{id:"defaultUserNameChat",values:i.brand})},i.getDefaultAdTitle=function(){return(0,s.default)(m.FormattedMessage,{id:"defaultAdTitleChat",values:i.brand})},i.chatState={composing:(0,s.default)(m.FormattedMessage,{id:"typingStatus"}),active:"",paused:"",available:"",unavailable:""},i.state={fillButton:!1},i.retry={item:!0,user:!0},i.elements={dropdownButton:(0,s.default)("span",{className:T.panameraIcons+" "+I.default.downArrow+" "+T["icon-ArrowDown"]}),dropdownOptions:[(0,s.default)("div",{"data-aut-id":"deleteChat",onClick:i.deleteChat([{userId:i.props.conversation.userId,itemId:i.props.conversation.itemId}])},0,(0,s.default)(m.FormattedMessage,{id:"deleteChat"})),(0,s.default)("div",{"data-aut-id":"deleteMultipleChat",onClick:i.props.showDeleteChatOption},1,(0,s.default)(m.FormattedMessage,{id:"deleteMultipleChats"}))]},i.brand={brand:a.config.get("theme","brand")},i}return(0,i.default)(t,e),t.prototype.componentWillMount=function(){"undefined"!=typeof window&&(!this.props.item&&this.props.conversation.lastMessage.itemId&&this.props.getItem(),this.props.user||this.props.getUser())},t.prototype.componentWillReceiveProps=function(e){"undefined"!=typeof window&&(this.props.conversation.lastMessage&&this.props.conversation.lastMessage.itemId!==e.conversation.lastMessage.itemId?this.props.getItem():!this.props.item&&this.retryVal("item",e.offline)&&this.props.conversation.lastMessage&&!1===this.props.isFetchingItem&&(this.retry.item=!1,this.props.getItem()),this.props.conversation.userId!==e.conversation.userId?this.props.getUser():!this.props.user&&this.retryVal("user",e.offline)&&this.props.conversation.userId&&!1===this.props.isFetchingUser&&(this.retry.user=!1,this.props.getUser()),this.props.showRadioButton===e.showRadioButton||e.showRadioButton||this.setState({fillButton:!1}))},t.prototype.retryVal=function(e,t){return this.retry[e]||!t&&this.props.offline!==t},t.prototype.renderUnReadMessages=function(){return this.props.conversation.unreadCount>0?(0,s.default)("div",{className:I.default.chatNotificationContainer},void 0,(0,s.default)("span",{className:I.default.notificationText,"data-aut-id":"unreadCount"},void 0,this.props.conversation.unreadCount)):null},t.prototype.showMessageStatus=function(e){return e.isMine?e.displayed?(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+I.default.displayed+" "+T["icon-DoubleCheckRead"]}):e.received?(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+I.default.notDisplayed+" "+T["icon-DoubleCheckRead"]}):(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+I.default.notDisplayed+" "+T["icon-OK"]}):null},t.prototype.getLastMessage=function(){var e=this.props.conversation.lastMessage;return e.image?(0,s.default)("div",{},void 0,(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+T["icon-Photo"]}),(0,s.default)("div",{className:I.default.lstmsg},void 0,(0,s.default)(m.FormattedMessage,{id:"imageMsg"}))):e.location?(0,s.default)("div",{},void 0,(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+T["icon-Location"]+" "+I.default.locIcon}),(0,s.default)("div",{className:I.default.lstmsg},void 0,(0,s.default)(m.FormattedMessage,{id:"LocationMsg"}))):e.sms?this.context.config.get("chat").newChat.showSmsHistory?(0,s.default)("div",{},void 0,(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+I.default.notDisplayed+" "+T["icon-SMS"]}),(0,s.default)("div",{className:I.default.lstmsg},void 0,"SMS")):null:e.call?this.context.config.get("chat").newChat.showCallHistory?(0,s.default)("div",{},void 0,(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+I.default.notDisplayed+" "+T["icon-PhoneProfile"]}),(0,s.default)("div",{className:I.default.lstmsg},void 0,(0,s.default)(m.FormattedMessage,{id:"incomingCall"}))):null:e.voice?(0,s.default)("div",{},void 0,(0,s.default)("span",{className:T.panameraIcons+" "+I.default.msgIcons+" "+T["icon-mic"]}),(0,s.default)("div",{className:I.default.lstmsg+" "+I.default.voiceMsg},void 0,"Voice Message")):e.system?(0,s.default)("div",{className:I.default.lstmsg},void 0,e.system.title):(0,s.default)("div",{},void 0,this.showMessageStatus(this.props.conversation.lastMessage),(0,s.default)("div",{className:I.default.lstmsg},void 0,this.highLight(e&&e.body||"","messages")))},t.prototype.showRadioOption=function(){return(0,s.default)("div",{"data-aut-id":"selectChat",className:I.default.radioBtn+" "+T.panameraIcons+" "+(this.state.fillButton?I.default.active+" "+T["icon-OK"]:"")})},t.prototype.renderLastMessageDate=function(){if(this.props.conversation.lastMessage&&this.props.conversation.lastMessage.date){var e=new Date(this.props.conversation.lastMessage.date),t=C.daysUntilNow(this.props.conversation.lastMessage.date),a={dayDiff:t};return 0===t?(0,s.default)(m.FormattedTime,{value:e,hour12:!1}):1===t?(0,s.default)(m.FormattedMessage,{id:"yesterday"}):t>1&&t<6?(0,s.default)(m.FormattedMessage,{id:"daysAgo",values:a}):(0,s.default)("span",{},void 0,C.formatDate(e,"DD/MM/YY"))}return null},t.prototype.highLight=function(e,t){var a=this.props.highLightQuery;return a&&a.type===t?(0,s.default)(_.default,{className:I.default.highlight,text:e,searchWord:a.value}):e},t.prototype.render=function(){if(!this.props.conversation)return null;if(!this.props.conversation.itemId||!this.props.conversation.userId)return null;var e=!1,t=!1;this.props.item||(void 0===this.props.isFetchingItem?e=!0:this.props.isFetchingItem&&(e=!0)),this.props.user||(void 0===this.props.isFetchingUser?t=!0:this.props.isFetchingUser&&(t=!0));var a=t||e,n=(0,w.getUserImage)(this.props.user),o=(0,w.getUserImage)(),i=null;return this.props.item&&this.props.user&&(i=this.props.item&&this.props.item.images&&this.props.item.images.length&&this.props.item.images[0].small?this.props.item.images[0].small.url:(0,w.getUserImage)({avatar_id:this.props.user.avatar_id})),(0,s.default)("div",{className:I.default.chatContainer+" "+I.default.chatContainerRead+" "+(this.props.currentConversation===this.props.conversation.userId&&this.props.currentItem===this.props.conversation.itemId?I.default.currentConv:""),"data-aut-id":"listItemConversation",onClick:this.onListClick},void 0,(0,s.default)("div",{className:I.default.conversation},void 0,this.props.showRadioButton&&this.showRadioOption(),(0,s.default)("div",{"data-aut-id":"imageContainer",className:""+I.default.imageContainer},void 0,a?(0,s.default)("div",{className:I.default.loadingItemImage}):(0,s.default)(l.default,{image:i||o,diameter:"40px",className:I.default.itemImage}),a?(0,s.default)("div",{className:I.default.loadingUserImage}):(0,s.default)(l.default,{className:I.default.userImage,image:n||o,diameter:"24px"})),(0,s.default)("div",{className:I.default.itemInfoBox},void 0,(0,s.default)("div",{"data-aut-id":"conversationUsername",className:I.default.chatHeader+" "+(a?I.default.loading:"")},void 0,!a&&this.highLight(this.props.user&&this.props.user.name||this.getDefaultUserName(),"users")),(0,s.default)("div",{"data-aut-id":"conversationItemTitle",className:I.default.itemInfo+" "+(a?I.default.loading:"")},void 0,this.props.showActivity,!a&&this.highLight(this.props.item&&this.props.item.title||this.getDefaultAdTitle(),"items")),(0,s.default)("div",{"data-aut-id":"conversationLastMessage",className:I.default.lastMessage+" "+(a?I.default.loading:"")+" "+(this.chatState[this.props.userPresence]&&I.default.displayed)},void 0,!a&&(this.props.showActivity&&this.chatState[this.props.userPresence]||this.getLastMessage()))),(0,s.default)("div",{className:I.default.moreInfo},void 0,(0,s.default)("div",{"data-aut-id":"lastMessageTimestamp",className:I.default.postingDate+" "+(this.props.showActivity&&this.props.conversation.unreadCount>0?I.default.themeColor:"")},void 0,!a&&this.renderLastMessageDate()),(0,s.default)("div",{className:I.default.optionsDiv,tabIndex:"0"},void 0,!a&&this.props.showActivity&&(this.props.currentConversation!==this.props.conversation.userId||this.props.currentItem!==this.props.conversation.itemId)&&this.renderUnReadMessages(),this.props.showActivity&&!this.props.showRadioButton&&(0,s.default)("div",{className:I.default.options,onClick:this.optionsClick},void 0,(0,s.default)(u.default,{actionable:this.elements.dropdownButton,className:I.default.dropDown,listClassName:I.default.dropDownList},void 0,this.elements.dropdownOptions)))),(0,s.default)("div",{className:I.default.clear})),this.props.intervention&&this.props.showActivity&&(0,s.default)(p.default,{userId:this.props.conversation.userId,intervention:this.props.intervention,screen:"chat_list",injectComponentinDOM:this.props.injectComponentinDOM,sendMessage:this.onInterventionClick,updateInterventionSeenData:this.props.updateInterventionSeenData,removeIntervention:this.props.removeIntervention,lastMsg:this.props.conversation.lastMessage}))},t}(h.default.Component);N.propTypes={conversation:f.default.object,item:f.default.object,currentItem:f.default.string,user:f.default.object,userPresence:f.default.string,onClick:f.default.func,getItem:f.default.func,getUser:f.default.func,currentConversation:f.default.string,showDeleteChatOption:f.default.func,deleteChat:f.default.func,showRadioButton:f.default.bool,toggleButton:f.default.func,isFetchingItem:f.default.bool,isFetchingUser:f.default.bool,offline:f.default.bool,intervention:f.default.object,onInterventionClick:f.default.func,updateInterventionSeenData:f.default.func,removeIntervention:f.default.func,showActivity:f.default.bool,highLightQuery:f.default.oneOfType([f.default.object,f.default.bool]),router:f.default.object.isRequired,injectComponentinDOM:f.default.func,config:f.default.object},N.contextTypes={config:f.default.object},N.defaultProps={onClick:function(){},deleteChat:function(){},showActivity:!0,highLightQuery:!1,injectComponentinDOM:function(){}};var x=t.mapStateToProps=function(e,t){var a=t.conversation.userId,s=t.conversation.lastMessage&&t.conversation.lastMessage.itemId;return{user:e.users.elements[a],item:e.items.elements[s],isFetchingItem:e.items.isFetching[r.urls.getItem(s)],isFetchingUser:e.users.isFetching[d.urls.getExistingUser(a)],intervention:e.interventions&&e.interventions[a+"_"+s]}},D=t.mapDispatchToProps=function(e,t){return{getItem:function(){return e((0,v.get)(r.urls.getItem(t.conversation.lastMessage&&t.conversation.lastMessage.itemId),"ELEMENT_ITEMS"))},getUser:function(){return e((0,v.get)(d.urls.getExistingUser(t.conversation.userId),"ELEMENT_USERS"))},onInterventionClick:function(t,a,s){return e((0,M.onInterventionClick)(t,a,s))}}};t.ConversationComponent=N,t.default=(0,S.compose)(k.default,y.withRouter,(0,g.connect)(x,D))(N)},1501:function(e,t,a){"use strict";t.__esModule=!0,t.InterventionContainerComponent=t.mapDispatchToProps=t.mapStateToProps=void 0;var s=S(a(32)),n=S(a(14)),o=S(a(24)),i=S(a(13)),r=S(a(20)),d=S(a(21)),l=S(a(0)),u=S(a(1)),c=a(44),p=a(64),f=S(a(1502)),h=S(a(2039)),m=S(a(2041)),g=S(a(37)),v=a(54),I=S(a(2042)),C=a(351),M=a(239),_=a(1503),y=S(a(165));function S(e){return e&&e.__esModule?e:{default:e}}var w=S(a(346)).default.icons,k=function(e){function t(a,s){(0,i.default)(this,t);var d=(0,r.default)(this,e.call(this,a,s));return d.sendIntervention=function(e,t,a){return function(){var s=d.props.intervention,n=d.props.interventionData;if(d.setState({disabled:!0}),"make_offer"===t)d.msgObj=e,d.props.injectComponentinDOM((0,o.default)(h.default,{itemId:d.props.intervention.itemId,toggleModal:d.toggleMakeAnOfferModal,onSubmit:d.onSubmitOffer})),d.trackOffer("item_chat_tap_make_offer");else if("mark_sold"===t)d.props.injectComponentinDOM((0,o.default)(m.default,{itemId:d.props.intervention.itemId,toggleModal:d.toggleMarkAsSoldModal,callback:d.markAsSoldCallback}));else if("dismiss"===t)d.props.removeIntervention(s.userId,s.itemId,s.interventionId);else if("share_location"===t)d.props.shareLocation();else if("share_image"===t)d.props.sharePhoto();else{if("message"!==t)return;d.props.sendMessage(e,s.userId,s.itemId)}d.context.track("item_tap_interv_action",{intervention_id:s.interventionId,intervention_type:n.type,shown_at:n.shownWindow.join("_"),interv_msg_id:s.id,action_id:e.actionId,intellichat_label:a,item_id:s.itemId})}},d.onSubmitOffer=function(e){var t=d.msgObj&&d.msgObj.msg,a=d.props.intervention;t=t.replace(/\$\{price\}/g,e),d.msgObj.msg=t,d.msgObj.params={price:e},d.props.sendMessage(d.msgObj,a.userId,a.itemId),d.toggleMakeAnOfferModal(),d.trackOffer("item_chat_tap_send_offer",e)},d.markAsSoldCallback=function(){var e=d.props.intervention;d.props.removeIntervention(e.userId,e.itemId,e.interventionId),d.context.track("item_tap_mark_as_sold",(0,n.default)({},{intervention_id:e.interventionId,item_id:e.itemId,origin:d.props.trackOrigin}))},d.toggleMakeAnOfferModal=function(){d.props.injectComponentinDOM(null)},d.toggleMarkAsSoldModal=function(){d.props.injectComponentinDOM(null)},d.stopEventPropagation=function(e){e.stopPropagation()},d.state={disabled:!1,showAnimation:!1},d.iconMappings={ic_intervention_offer:"icon-offer",ic_intervention_edit:"icon-Edit",ic_intervention_calendar:"icon-meeting"},d.msgObj={},d}return(0,d.default)(t,e),t.prototype.componentWillMount=function(){var e=this,t=this.props.intervention;"chat_window"!==this.props.screen||t.seen&&t.seen[this.props.screen]||this.setState({showAnimation:!0},function(){setTimeout(function(){e.setState({showAnimation:!1})},2e3)})},t.prototype.componentDidMount=function(){this.trackSeenIntervention(this.props.intervention),this.props.setOriginTrack("chat_intervention")},t.prototype.componentWillReceiveProps=function(e){var t=e.intervention;this.props.intervention&&t&&this.props.intervention.interventionId!==t.interventionId&&this.trackSeenIntervention(t)},t.prototype.trackSeenIntervention=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.interventionData,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props.screen;if(e&&t&&t.shownWindow.indexOf(a)>-1&&(!e.seen||!e.seen[a])){var s=e.seen||{};s[a]=!0,this.props.updateInterventionSeenData(e.userId,e.itemId,s),this.context.track("item_chat_interv_seen",{intervention_id:e.interventionId,intervention_type:t.type,shown_at:t.shownWindow.join("_"),seen_at:a,interv_msg_id:e.id,item_id:e.itemId})}},t.prototype.showInterventionText=function(e,t,a,n){var i=e&&e[this.props.screen];return i&&a&&(0,s.default)(a).length&&(0,s.default)(a).forEach(function(e){i=i.replace("${"+e+"}",a[e])}),i?(0,o.default)("div",{className:f.default.title},void 0,!n&&t&&(0,o.default)("span",{className:w.panameraIcons+" "+f.default.interventionIcon+" "+w[this.iconMappings[t]]}),i):null},t.prototype.trackOffer=function(e,t){var a=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props.intervention.itemId;this.props.getItem(s,function(n){var o=n.data&&n.data.data,i={intervention_id:a.props.intervention.interventionId,item_id:s,seller_id:o&&o.user_id,origin:a.props.trackOrigin,item_price:o&&o.price&&o.price.value.display};t&&(i.offer_price=t),a.context.track(e,i)})},t.prototype.renderActionButton=function(e,t,a){return(0,o.default)(y.default,{type:"btnOutline",className:f.default.actions+" "+(this.state.disabled?"disabled":""),icon:""+(e.icon?this.iconMappings[e.icon]:""),onClick:this.sendIntervention({msg:e.response_text,actionId:e.id,id:t},e.type,e.display_text)},a,e.display_text)},t.prototype.showActions=function(e,t){var a=this,s=this.props.intervention.interventionId;if(!e)return null;var n=e.length;if(1===n){var i=e[0];return this.renderActionButton(i,s,0)}if(n>1&&(t||n<=2))return(0,o.default)("div",{className:f.default.actionContainer},void 0,e.map(function(e,t){return a.renderActionButton(e,s,t)}));var r=!0;return(0,o.default)("div",{className:f.default.actionContainer},void 0,e.map(function(e,t){return t<2?a.renderActionButton(e,s,t):r?(r=!1,(0,o.default)(y.default,{type:"btnOutline",className:f.default.actions,onClick:a.props.sendMessage},t,(0,o.default)(p.FormattedMessage,{id:"interventionMoreButton"}))):null}))},t.prototype.isOutboundMessage=function(e){return g.default.getUser()&&g.default.getUser().id==e},t.prototype.checkRemoveConditions=function(e){var t=this.props.lastMsg,a=this.props.intervention,s=this.props.interventionData,n=t&&this.isOutboundMessage(t.from);(t&&a.timestamp<t.date&&(n&&e.message_sent||!n&&e.message_received)||s.expiry&&s.expiry<Date.now)&&(this.props.removeIntervention(a.userId,a.itemId,a.interventionId),this.context.track("item_chat_interv_invalidated",{intervention_id:a.interventionId,intervention_type:s.type,shown_at:s.shownWindow.join("_"),interv_msg_id:a.id,item_id:a.itemId}))},t.prototype.render=function(){var e=this.props.interventionData,t=this.props.intervention,a="chat_window"===this.props.screen,s=this.props.interventionMsg,n=e&&e.actions?e.actions.filter(function(e){return(0,_.isSupportedActionType)(e.type)}):[];if(!t||!e||!(0,_.isSupportedInterventionType)(e.type)||!n.length||e.shownWindow.indexOf(this.props.screen)<0||s&&a&&s.userId===t.userId)return null;var i=e.invalidateConditions;return i&&this.checkRemoveConditions(i),a&&this.state.showAnimation?(0,o.default)(I.default,{}):(0,o.default)("div",{className:f.default.interventionContainer+" "+(a?f.default.chatWindow:f.default.chatList)},void 0,(0,o.default)("div",{className:f.default.interventionAnimation,onClick:this.stopEventPropagation},void 0,this.showInterventionText(e.text,e.icon,t.params,a),this.showActions(n,a)))},t}(l.default.Component);k.propTypes={intervention:u.default.object,lastMsg:u.default.object,interventionData:u.default.object,screen:u.default.string,sendMessage:u.default.func,removeIntervention:u.default.func,updateInterventionSeenData:u.default.func,setOriginTrack:u.default.func,getItem:u.default.func,interventionMsg:u.default.object,trackOrigin:u.default.string,shareLocation:u.default.func,sharePhoto:u.default.func,injectComponentinDOM:u.default.func},k.defaultProps={interventions:null,lastMsg:null,removeIntervention:function(){},sharePhoto:function(){},injectComponentinDOM:function(){}},k.contextTypes={track:u.default.func};var b=t.mapStateToProps=function(e,t){return{interventionData:e.interventionsData&&e.interventionsData[t.intervention&&t.intervention.interventionId],interventionMsg:e.sendIntervention,trackOrigin:e.track.origin}},T=t.mapDispatchToProps=function(e){return{setOriginTrack:function(t){return e((0,C.setOrigin)(t))},getItem:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return e((0,v.get)(M.urls.getItem(t),"ELEMENT_ITEMS")).then(function(e){return a(e)})}}};t.InterventionContainerComponent=k,t.default=(0,c.connect)(b,T)(k)},1502:function(e,t,a){e.exports={interventionContainer:"_2kszO",disabled:"nsDxS",chatWindow:"_1EgeS",interventionAnimation:"_1WMxe",customTranstion:"_2OqF2",actionContainer:"Kdwd9",noPadding:"_3w6L6",title:"_2hzPG",actions:"_3sguP",lessGradient:"_206CW",chatList:"_2ius5",noCursor:"_34zsn",interventionIcon:"_7pKV-",dotContainer:"_14l_a",dot:"_2A6IA",active:"_35wrC",animation:"_3bQrT",isTyping:"_30mzR",icon:"DE7O8"}},1503:function(e,t,a){"use strict";t.__esModule=!0;t.isSupportedActionType=function(e){return-1!==["message","make_offer","mark_sold","suggestion","dismiss","share_location","share_image"].indexOf(e)},t.isSupportedInterventionType=function(e){return-1!==["suggestion","hint"].indexOf(e)}},1504:function(e,t,a){e.exports={chatContainer:"_3R-Nl",item:"_24Uy3",placeHolderShimmer:"_349_O",imageContainer:"_29SzT",itemInfoBox:"_3Pez3",itemInfo:"_2tOR8",lastMessage:"ZnqJl",clear:"_2iLUY",itemTile:"_2Dv1q",itemTileHeader:"_3LQ0O",itemTileData:"ntTy4",itemTileFooter:"_3wb8-",chatLoader:"qEXFn"}},1505:function(e,t){e.exports="/assets/emptyChat.olx.6f5a8d50.png"},1506:function(e,t,a){"use strict";t.__esModule=!0;var s=p(a(24)),n=p(a(13)),o=p(a(20)),i=p(a(21)),r=p(a(1052)),d=p(a(346)),l=p(a(1)),u=p(a(0)),c=p(a(1079));function p(e){return e&&e.__esModule?e:{default:e}}var f=d.default.icons,h=function(e){function t(){(0,n.default)(this,t);var a=(0,o.default)(this,e.call(this));return a.toggleSmsModal=function(){if(a.props.isBlocked)a.props.smsClickHandler();else{var e=a.context.config.get("breakpoint");a.state.showSmsModal||a.props.smsClickHandler(),window.screen.availWidth>=e?a.setState({showSmsModal:!a.state.showSmsModal}):window.open("sms:"+a.props.phone)}},a.state={showSmsModal:!1},a}return(0,i.default)(t,e),t.prototype.render=function(){var e=this.props,t=e.phone,a=e.smsButtonClassName;return(0,s.default)("div",{},void 0,(0,s.default)("span",{className:f.panameraIcons+" "+f["icon-SMS"]+" "+a,onClick:this.toggleSmsModal}),this.state.showSmsModal&&(0,s.default)(r.default,{onClick:this.toggleSmsModal,className:c.default.smsModal,title:"Phone"},void 0,(0,s.default)("div",{},void 0,(0,s.default)("a",{className:f.panameraIcons+" "+f["icon-SMS"],href:"sms:"+t},void 0,t))))},t}(u.default.Component);h.contextTypes={config:l.default.object},h.propTypes={phone:l.default.oneOfType([l.default.string,l.default.bool]),smsButtonClassName:l.default.string,smsClickHandler:l.default.func,isBlocked:l.default.bool},t.default=h},1507:function(e,t,a){"use strict";t.__esModule=!0;var s=p(a(24)),n=p(a(13)),o=p(a(20)),i=p(a(21)),r=p(a(1052)),d=p(a(346)),l=p(a(1)),u=p(a(0)),c=p(a(1146));function p(e){return e&&e.__esModule?e:{default:e}}var f=d.default.icons,h=function(e){function t(){(0,n.default)(this,t);var a=(0,o.default)(this,e.call(this));return a.sendTrackInfo=function(e){return a.props.track(e,{select_from:"chat"})},a.toggleCallModal=function(){a.props.isBlocked?a.props.callClickHandler():(a.state.showCallModal||a.props.track("item_intent_call"),!a.state.showCallModal&&a.context.config.get("chat").newChat.showCallHistory&&a.props.callClickHandler(),a.isDesktop()?a.setState({showCallModal:!a.state.showCallModal},function(){a.state.showCallModal&&a.sendTrackInfo("item_tap_call")}):(a.sendTrackInfo("item_tap_call"),window.open("tel:"+a.props.phone)))},a.state={showCallModal:!1},a}return(0,i.default)(t,e),t.prototype.isDesktop=function(){var e=this.context.config.get("breakpoint");return window.screen.availWidth>=e},t.prototype.render=function(){var e=this.props,t=e.phone,a=e.callButtonClassName;return(0,s.default)("div",{},void 0,(0,s.default)("span",{className:f.panameraIcons+" "+f["icon-call"]+" "+a,onClick:this.toggleCallModal}),this.state.showCallModal&&(0,s.default)(r.default,{onClick:this.toggleCallModal,className:c.default.callModal+" "+c.default.modalPopup,title:"Phone"},void 0,(0,s.default)("div",{},void 0,(0,s.default)("a",{className:f.panameraIcons+" "+f["icon-PhoneProfile"],href:"tel:"+t},void 0,t))))},t}(u.default.Component);h.contextTypes={config:l.default.object},t.default=h,h.propTypes={phone:l.default.oneOfType([l.default.string,l.default.bool]),callButtonClassName:l.default.string,callClickHandler:l.default.func,track:l.default.func,isBlocked:l.default.bool}},1508:function(e,t,a){"use strict";t.__esModule=!0;var s=c(a(24)),n=c(a(13)),o=c(a(20)),i=c(a(21)),r=c(a(1)),d=c(a(0)),l=a(64),u=c(a(2053));function c(e){return e&&e.__esModule?e:{default:e}}var p=c(a(346)).default.icons,f=function(e){function t(){(0,n.default)(this,t);var a=(0,o.default)(this,e.call(this));return a.tick=function(){a.setState({animationClass:!a.state.animationClass})},a.toggleFirstTimeUserTips=function(){a.setState({showAnimation:!1}),clearInterval(a.interval),a.props.toggleFirstTimeUserTips("toolTip")},a.state={animationClass:!1,showTips:!1,showAnimation:!1},a}return(0,i.default)(t,e),t.prototype.componentWillMount=function(){var e=this,t=window&&window.localStorage&&window.localStorage.getItem("seenFirstTimeUserTips")&&!window.localStorage.getItem("sufficientTimeSpent")||this.props.showToolTip;this.setState({showAnimation:t},function(){e.state.showAnimation&&(e.interval=setInterval(e.tick,300))})},t.prototype.componentWillUnmount=function(){clearInterval(this.interval)},t.prototype.render=function(){var e=this.state.showAnimation;return(0,s.default)("div",{},void 0,(0,s.default)("div",{className:u.default.tips+" ",onClick:this.toggleFirstTimeUserTips},void 0,(0,s.default)("i",{className:p.panameraIcons+" "+p["icon-Tips"]+" "+u.default.tipsIcon}),e&&(0,s.default)("span",{className:u.default.toolTipShow+" "+(this.state.animationClass?u.default.animate:"")},void 0,(0,s.default)(l.FormattedMessage,{id:"ftutHeading"}),"!")))},t}(d.default.Component);f.propTypes={toggleFirstTimeUserTips:r.default.func,showToolTip:r.default.bool},t.default=f},1514:function(e,t,a){e.exports={itemBanner:"_3nNmj",adContainer:"KiKn_",adInfo:"_1fhzd",moreDeals:"_1U2xy",adTitle:"L2X98",adImg:"_1RJlY"}},2036:function(e,t,a){"use strict";t.__esModule=!0;var s=O(a(4)),n=O(a(26)),o=O(a(32)),i=O(a(105)),r=O(a(24)),d=O(a(14)),l=O(a(13)),u=O(a(20)),c=O(a(21)),p=O(a(0)),f=O(a(1)),h=O(a(2037)),m=O(a(2049)),g=O(a(1055)),v=O(a(2051)),I=O(a(2054)),C=O(a(37)),M=a(44),_=a(54),y=O(a(1339)),S=O(a(423)),w=a(380),k=a(1503),b=O(a(180)),T=a(239),N=a(64),x=a(82),D=a(31),P=O(a(1505)),U=O(a(355));function O(e){return e&&e.__esModule?e:{default:e}}var B=function(e){function t(a,s){(0,l.default)(this,t);var c=(0,u.default)(this,e.call(this,a,s));c.changeHeader=function(e){c.searchEnabled=e,c.setHeader(c.props)},c.setHeaderParams=function(e){c.setState({oHeaderParams:e})},c.checkUnreadThreads=function(){c.xmpp&&c.xmpp.connEstablished&&c.xmpp.getUnreadThreads(function(e){c.resetNotificationCount(e)})},c.resetNotificationCount=function(e){c.props.toggleUnreadChats(e>0)},c.createConnection=function(){b.default.getXMPPModules().getInstance(c.chatConfig,c.getMessages,c.onInterventionChange,c.getUsers,c.getUserState,c.onAuthFailure,c.connection,c.onMamStateChange).then(function(e){c.xmpp=e,c.xmpp.setTracker(c.xmppTrack),c.getMessages(),c.getUsers(),c.getUserState()}),window.navigator&&!1===window.navigator.onLine&&c.offlineHandler()},c.createChatConnection=function(){var e=b.default.getXMPPModules();c.state.offline||e.instanceExists()&&(!c.xmpp||c.xmpp.connEstablished)||c.inChatConnection||!C.default.isLoggedIn()||(c.inChatConnection=!0,c.createConnection())},c.onClose=function(){return c.xmpp&&c.xmpp.logout(!1)},c.onAuthFailure=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];e&&!t?c.getToken():c.trackAuthError(t)},c.updateInterventionSeenData=function(e,t,a){c.chatDb.updateInterventionSeenData(e,t,a).then(c.onInterventionChange)},c.onMamStateChange=function(e){var t=e.state;clearTimeout(c.timeout),"end"===t?(c.threads.length?c.setState({hideLoader:!0}):(c.keepLoader=!0,c.setLoaderTimer()),c.checkInterventionsExpiry(e.latestMsgs)):"start"===t&&(c.state.hideLoader&&c.setState({hideLoader:!1}),c.mamStarted=!0),c.checkUnreadThreads()},c.chatThreadBackClick=function(){c.props.router.replace("/nf/chat"),c.hideChatThreadWindow(),c.sendState("active",c.props.params.itemId),c.setHeader()},c.showChatThreadWindow=function(e){"hidden"===c.state.chatThreadClass&&e&&c.setState({myChatClass:"hidden",chatThreadClass:""})},c.hideChatThreadWindow=function(){c.setState({myChatClass:"",chatThreadClass:"hidden"})},c.connection=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments[2];if(t!==c.state.showRetry||c.state.connectImmediate!==a?c.setState({connAvailable:e,showRetry:t,connectImmediate:a}):e!==c.state.connAvailable&&c.setState({connAvailable:e}),c.inChatConnection&&(c.inChatConnection=!1),e){var s=c.props.params,n=s.userId,o=s.itemId;c.xmpp&&c.getUnreadThreads(),n&&c.updateLastActivity(n),n&&o&&c.sendThreadOpenEvent(o,n)}return null},c.getUnreadThreads=function(){c.xmpp.getUnreadThreads(function(e){c.unreadCount!=e&&(c.unreadCount=e,c.resetNotificationCount(e))})},c.getUserState=function(e){e&&e.from.resource&&c.updateUsersPresence(e.from.local.split("_")[0],e.chatState,"status",e.extras&&e.extras.itemId)},c.removeLastSeen=function(e){"available"!==e.status&&"active"!==e.status||delete e.lastSeen},c.sendState=function(e,t){c.props.params.userId&&c.currentState!==e&&c.state.connAvailable&&!c.state.offline&&(c.xmpp.sendState(c.props.params.userId,e,t),c.currentState=e)},c.onInterventionChange=function(e){c.chatDb.getActiveInterventions().then(function(e){c.props.saveInterventions(e),c.updateConversationList(c.threads,e)}),e&&e.length&&c.props.interventionData&&e.forEach(function(e){var t=e.data,a=c.props.interventionData[t.intervention_id];t&&c.context.track(e.event,(0,d.default)({},t,{intervention_type:a.type,shown_at:a.shownWindow.join("_"),intellichat_label:a.text}))})},c.removeIntervention=function(e,t,a){return c.chatDb.removeIntervention(e,t,a).then(c.onInterventionChange)},c.getMessages=function(){c.xmpp.getThreads(c.processThreads),c.checkUnreadThreads()},c.processThreads=function(e){var t=c.threads.length,a=c.props.params;if(e&&e.length){var s=e[0].lastMessage,n=t&&c.threads[0].lastMessage,o=e.filter(function(e){return e.itemId===a.itemId&&e.userId===a.userId});!c.keepLoader||c.state.hideLoader||c.mamStarted||(c.keepLoader=!1,c.setState({hideLoader:!0})),t&&s.date===n.date&&e.length===t&&!c.anyMsgUpdate(e)||(c.xmpp.getNewReceivedSystemMessages(function(e){e.forEach(function(e){var t=e.system;c.track("system_msg_received",e.itemId,{result_set_format:t.layout,resultset_type:t.subType,interv_msg_id:e.id,reason:t.subtitle})})}),!a.userId||s.to!==a.userId&&s.from!==a.userId&&e.length===t||c.getThreadMessages(a.userId,a.itemId),a.itemId&&o.length&&!a.amount&&c.props.router.replace("/nf/chat/user/"+a.userId+"/"+a.itemId),c.getUnreadThreads(),c.state.isChatListFetched||c.setState({isChatListFetched:!0}),c.updateConversationList(e))}else c.showingThread(),!e.length&&t&&(c.updateConversationList(e),a.userId&&c.chatThreadBackClick(),c.getUnreadThreads()),c.setState({isChatListFetched:!0})},c.showChatStatusMessage=function(){c.props.setToastMessageState({isOpen:!0,message:(0,r.default)(N.FormattedMessage,{id:"chatIsDownMessage"}),expiration:5e3})},c.sendMessage=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.props.params.itemId,s=arguments[3],n=arguments[4],o=c.props.itemsCollection[a],i=c.xmpp.sendMessage(e,t,a,s,n,o&&o.user_id);return c.context.track("item_chat_tap_send",{resultset_id:i}),i},c.sendThreadOpenEvent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.props.params.itemId,t=arguments[1],a=c.props.itemsCollection[e];c.xmpp&&c.xmpp.connEstablished&&(a?c.xmpp.sendThreadOpenEvent(e,t,a.user_id):c.props.getItem(e,function(a){var s=a.data&&a.data.data;c.xmpp.sendThreadOpenEvent(e,t,s.user_id)}))},c.getUsers=function(){c.xmpp.getUsers(function(e){var t={};(0,i.default)(e).map(function(e){var a=e.id;c.updateUsersPresence(a,e.presence,"status"),void 0!==c.state.blockList[a]&&c.state.blockList[a]===e.isBlock||(t[a]=e.isBlock)}),(0,o.default)(t).length&&c.setState({blockList:(0,d.default)({},c.state.blockList,t)})})},c.xmppTrack=function(e,t){c.context.track(e,t)},c.chatItemClicked=function(e,t,a,s){var n=c.props.params.userId===e,o=c.props.params.itemId===t;if(!n||!o||"hidden"===c.state.chatThreadClass||s)if(c.setState({toMessage:s,currentItemId:"",mobileScroll:"undefined"==typeof window?0:window.scrollY},function(){c.props.router.replace("/nf/chat/user/"+e+"/"+t),n&&s&&c.getThreadMessages(e,t)}),s&&s.search){var i="";i="messages"===s.type?"message":"users"===s.type?"user":"ads",c.context.track("chat_search_action",{result_count:s.count,select_from:i,search_string:s.search})}else c.track("item_chat_tap_chat",t,(0,d.default)({origin:c.props.trackOrigin},{filters:c.props.trackFilters},{select_from:a},c.props.trackFiltersMetadata))},c.blockUser=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(c.context.track("trust_tap_unblock_user",{user_affected:e}),c.xmpp.unblockUser(e)):(c.context.track("trust_tap_block_user",{user_affected:e}),c.xmpp.blockUser(e))},c.deleteUsersChat=function(e){if(c.state.offline)c.props.setToastMessageState({isOpen:!0,message:(0,r.default)(N.FormattedMessage,{id:"noInternetError"}),expiration:5e3});else{var t=c.props.params.userId,a=!1;e.length&&e.map(function(e){e.userId===t&&(a=!0),c.track("item_chat_delete",e.userId),c.xmpp.deleteChat(e.userId,e.itemId).then(function(){c.props.removeConversation(e.userId+"_"+e.itemId),c.chatDb.removeUserIntervention(e.userId,e.itemId).then(function(){c.onInterventionChange()})})}),c.state.deleteOption&&c.showDeleteChatOption(),a&&c.chatThreadBackClick()}},c.showDeleteChatOption=function(){c.setState({deleteOption:!c.state.deleteOption},function(){c.setHeader()})},c.toggleSearch=function(){c.setState({showSearch:!c.state.showSearch})},c.offlineHandler=function(){c.state.hideLoader?c.setState({connAvailable:!1,offline:!0}):c.setState({connAvailable:!1,offline:!0,hideLoader:!0}),c.xmpp.logout(!1)},c.onlineHandler=function(){c.setState({offline:!1}),c.createConnection()},c.getSearchResults=function(e){return new n.default(function(t){t(c.xmpp.searchMessages(e))})},c.getItems=function(){return new n.default(function(e){e(c.xmpp.getItems())})},c.injectComponentinDOM=function(e){c.setState({injectedComponent:e})},c.chatConfig=s.config.get("chat").newChat;var p=!1;return"undefined"!=typeof window&&(p=!(window.screen.availWidth<s.config.get("breakpoint"))),c.state={myChatClass:a.params.itemId||a.params.userId?"hidden":"default",chatThreadClass:a.params.itemId||a.params.userId?"":"hidden",newChat:{itemId:a.params.itemId,userId:a.params.userId},currentItemId:a.params.itemId,conversations:[],usersPresence:{},connAvailable:!1,showThread:!1,blockList:{},deleteOption:!1,hideDelete:!1,showRetry:!1,offline:!1,isChatListFetched:!1,connectImmediate:!1,mamStarted:!1,hideLoader:!1,unReadCount:0,showSearch:p,mobileScroll:0,injectedComponent:null,oHeaderParams:{}},c.chatState={composing:(0,r.default)(N.FormattedMessage,{id:"typingStatus"}),active:(0,r.default)(N.FormattedMessage,{id:"onlineStatus"}),paused:"",available:(0,r.default)(N.FormattedMessage,{id:"onlineStatus"}),unavailable:""},c.currentState="",c.unreadCount=0,c.eventsAdded=!1,c.inChatConnection=!1,c.keepLoader=!1,c.threads=[],c.searchEnabled=!1,c}return(0,c.default)(t,e),t.prototype.componentWillMount=function(){C.default.getUser()&&this.props.params.userId&&this.props.params.userId===C.default.getUser().id&&this.props.params.itemId&&this.props.router.push("/item/iid-"+this.props.params.itemId),"undefined"!=typeof window&&(this.chatDb=new y.default,this.createConnection(),this.addEventListners(),this.onInterventionChange()),this.setHeader()},t.prototype.componentDidMount=function(){var e=this;this.chatDb.getInterventionsData().then(function(t){e.props.saveInterventionsData(t)})},t.prototype.componentWillReceiveProps=function(e){!e.params.userId||this.props.params.userId===e.params.userId&&this.props.params.itemId===e.params.itemId||this.getThreadMessages(e.params.userId,e.params.itemId),this.props.children!==e.children&&this.setHeader(e);var t=this.props.interventions,a=e.interventions,s=this.props.messages,n=e.messages,i=this.props.conversationList,r=e.conversationList;!t||this.props.interventionData===e.interventionData&&a||this.updateConversationList(this.threads,a),r&&!i?this.setHeader(e):r&&i&&(i.otherActions.length!==r.otherActions.length||i.pendingActions.length!==r.pendingActions.length)&&this.setHeader(e),n&&s&&(0,o.default)(s).length!==(0,o.default)(n).length&&this.getMessages(),this.props.chatServiceStatus||!this.props.params.userId||e.params.userId||this.showChatStatusMessage()},t.prototype.componentWillUnmount=function(){var e=this;C.default.isLoggedIn()&&b.default.getXMPPModules().getInstance(this.chatConfig,this.getUnreadThreads,this.onInterventionChange).then(function(t){e.xmpp=t,e.xmpp.setTracker(e.xmppTrack)});this.timeout&&clearTimeout(this.timeout),"undefined"!=typeof window&&(window.removeEventListener("offline",this.offlineHandler,!1),window.removeEventListener("online",this.onlineHandler,!1),window.removeEventListener("focus",this.createChatConnection,!1),window.removeEventListener("beforeunload",this.onClose,!1))},t.prototype.setHeader=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;if(!e.params.userId){this.searchEnabled&&this.setHeaderParams({onClickBack:this.props.router.goBack,title:(0,r.default)(N.FormattedMessage,{id:"chatHeader"})});var t=e.conversationList,a=!0;t&&(t.otherActions.length||t.pendingActions.length)||(a=!1),this.setHeaderParams({onClickBack:this.props.router.goBack,title:(0,r.default)(N.FormattedMessage,{id:"chatHeader"}),editOption:a&&(this.state.deleteOption?"cancelOption":"editAd"),onEditClick:this.showDeleteChatOption,searchOption:"editAd",onSearchClick:this.toggleSearch})}},t.prototype.addEventListners=function(){this.eventsAdded||(window.addEventListener("beforeunload",this.onClose,!1),window.addEventListener("offline",this.offlineHandler,!1),window.addEventListener("online",this.onlineHandler,!1),window.addEventListener("focus",this.createChatConnection,!1),this.eventsAdded=!0)},t.prototype.getObjectLength=function(e){return(0,o.default)(e).length},t.prototype.trackAuthError=function(e){this.context.track("item_chat_authentication_error",{resultset_type:e})},t.prototype.getToken=function(){var e=this;C.default.regenerateToken(function(t){t?e.createConnection():e.trackAuthError(t)})},t.prototype.checkInterventionsExpiry=function(e){var t=this,a=this.props.interventions;e&&this.getObjectLength(e)&&this.getObjectLength(a)&&(0,o.default)(a).forEach(function(s){var n=e[s],o=a[s],i=o.interventionId;if(i){var r=t.props.interventionData&&t.props.interventionData[i],d=r&&r.invalidateConditions;n&&d&&(n.sent&&d.message_sent&&o.timestamp<n.sent?t.removeIntervention(o.userId,o.itemId,i):n.received&&d.message_received&&o.timestamp<n.received&&t.removeIntervention(o.userId,o.itemId,i))}})},t.prototype.setLoaderTimer=function(){var e=this;this.timeout=setTimeout(function(){e.setState({hideLoader:!0}),e.mamStarted=!1},3e3)},t.prototype.updateUsersPresence=function(e,t,a,n){var o=this.state.usersPresence[e],i={};if(!o||o[a]!==t||n)if("status"===a&&this.state.usersPresence[e]&&!this.chatState[t]&&t!==this.state.usersPresence[e].status&&this.updateLastActivity(e),n)if("composing"===t)i[e+"_"+n]=(0,s.default)({},this.state.usersPresence[e+"_"+n]),i[e+"_"+n][a]=t,this.setState({usersPresence:(0,d.default)({},this.state.usersPresence,i)});else{var r=this.state.usersPresence;i[e]=(0,s.default)({},r[e]),i[e][a]=t,this.removeLastSeen(i[e]),delete r[e+"_"+n],this.setState({usersPresence:(0,d.default)({},r,i)})}else i[e]=(0,s.default)({},this.state.usersPresence[e]),i[e][a]=t,this.removeLastSeen(i[e]),this.setState({usersPresence:(0,d.default)({},this.state.usersPresence,i)})},t.prototype.markAsRead=function(e){var t=this;if(this.state.connAvailable&&!this.state.offline){var a=(0,d.default)([],e);a.reverse().some(function(e){if(!e.isMine){if(!0===e.displayed)return!0;if(e.system){var a={result_set_format:e.system.layout,resultset_type:e.system.subType,interv_msg_id:e.id,reason:e.system.subtitle};t.track("system_msg_seen",e.itemId,a)}t.xmpp.sendDisplayed(e)}return!1}),a.filter(function(e){return!e.displayed&&!e.isMine}).forEach(function(e){return t.xmpp.sendDisplayed(e)})}},t.prototype.anyMsgUpdate=function(e){for(var t=void 0,a=void 0,s=0;s<e.length;++s)if(t=e[s],(a=this.threads[s])&&(t.unreadCount!==a.unreadCount||t.lastMessage.displayed!==a.lastMessage.displayed||t.lastMessage.received!==a.lastMessage.received))return!0;return!1},t.prototype.updateConversationList=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.interventions;this.threads=t;var s={pendingActions:[],otherActions:[]};this.getObjectLength(a)?this.threads.forEach(function(t){var n=a[t.userId+"_"+t.itemId],o=e.props.interventionData,i=void 0,r=[];n&&n.interventionId&&o&&o[n.interventionId]&&(i=o[n.interventionId]).actions&&i.actions.length&&(r=i.actions.filter(function(e){return(0,k.isSupportedActionType)(e.type)})),n&&o&&i&&(0,k.isSupportedInterventionType)(i.type)&&r&&r.length&&o[n.interventionId].shownWindow.indexOf("chat_list")>-1&&s.pendingActions.length<2?s.pendingActions.push(t):s.otherActions.push(t)}):s.otherActions=this.threads,this.props.saveConversationList(s)},t.prototype.updateLastActivity=function(e){var t=this;this.state.connAvailable&&this.xmpp&&!this.state.offline&&(this.state.usersPresence[e]&&this.state.usersPresence[e].lastSeen||this.xmpp.getLastActivity(e).then(function(a){return a&&a.query&&a.query.seconds&&t.updateUsersPresence(e,Math.round(new Date)-1e3*parseInt(a.query.seconds,10),"lastSeen"),n.default.resolve()},function(e){return n.default.resolve(e)}))},t.prototype.showingThread=function(){this.state.showThread||this.setState({showThread:!0})},t.prototype.getThreadMessages=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.params.userId,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props.params.itemId;if(t){var s=this.props.params;this.xmpp.getThreadMessages(t,a,function(n){e.showChatThreadWindow(t),n&&n.length?(e.props.saveConversation(t+"_"+a,n),e.updateLastActivity(t),e.showingThread(),e.markAsRead(n)):!s.itemId&&s.userId&&e.chatThreadBackClick(),s.itemId&&s.amount&&e.props.router.replace("/nf/chat/user/"+s.userId+"/"+s.itemId),a?(e.setState({currentItemId:a}),e.showingThread()):e.setState({currentItemId:n.length&&n.slice(-1).pop().itemId&&n.slice(-1).pop().itemId.toString()})})}},t.prototype.track=function(e,t,a){var s=this,n=this.props.itemsCollection[t],o=void 0;n?(o={item_id:n.id,seller_id:n.user_id,creation_date:n.created_at,category_id:n.category_id},this.context.track(e,(0,d.default)(o,a))):this.props.getItem(t,function(t){var n=t.data&&t.data.data;o=n?{item_id:n.id,seller_id:n.user_id,creation_date:n.created_at,category_id:n.category_id}:{},s.context.track(e,(0,d.default)(o,a))})},t.prototype.getUserUnreadCount=function(){var e=this,t=this.threads.find(function(t){return t.userId===e.props.params.userId});return t&&t.unreadCount},t.prototype.render=function(){var e=this,t=this.props.conversationList,a=this.props.children&&this.state.showThread&&this.state.currentItemId&&this.props.params.userId&&this.props.params.itemId?I.default.onChatThread:"",s=this.state.showSearch?I.default.isSearching:"",n=p.default.createElement(v.default,this.state.oHeaderParams);return t&&(t.otherActions.length||t.pendingActions.length)||this.props.params.itemId||!this.state.hideLoader||!this.state.isChatListFetched?(0,r.default)(g.default,{header:n,footer:null},void 0,(0,r.default)("div",{id:"myDiv",className:I.default.chatScreen+" "+s+" "+a},void 0,(0,r.default)("div",{className:I.default.myChatsScreen+" "+I.default[this.state.myChatClass]},void 0,(0,r.default)(h.default,{className:"myChatsScreen",conversations:t,onChatClick:this.chatItemClicked,currentConversation:this.props.params.userId,currentItem:this.props.params.itemId,usersPresence:this.state.usersPresence,deleteUsersChat:this.deleteUsersChat,showDeleteChatOption:this.showDeleteChatOption,showRadioButton:this.state.deleteOption,offline:this.state.offline,showLoader:!this.state.hideLoader||!this.state.isChatListFetched,updateInterventionSeenData:this.updateInterventionSeenData,removeIntervention:this.removeIntervention,getSearchResults:this.getSearchResults,getItems:this.getItems,changeHeader:this.changeHeader,showChatStatusMessage:this.showChatStatusMessage,showSearch:this.state.showSearch,injectComponentinDOM:this.injectComponentinDOM,user:C.default&&C.default.getUser()&&C.default.getUser().id,toggleSearch:this.toggleSearch,mobileScroll:this.state.mobileScroll})),(0,r.default)("div",{className:I.default.chatThreadScreen+" "+I.default[this.state.chatThreadClass]},void 0,this.props.children&&this.state.showThread&&this.state.currentItemId&&this.props.params.userId&&this.props.params.itemId&&p.default.Children.map(this.props.children,function(t){return p.default.cloneElement(t,{className:"chatThreadScreen",chatThreadBackClick:e.chatThreadBackClick,itemId:e.props.params.itemId,chatState:e.state.chatState,sendState:e.sendState,sendMessage:e.sendMessage,retryConnection:e.createConnection,focusMessage:e.state.toMessage,userPresence:e.state.usersPresence[e.props.params.userId],userTypingStatus:e.state.usersPresence[e.props.params.userId+"_"+e.props.params.itemId],connAvailable:e.state.connAvailable,isBlocked:e.state.blockList[e.props.params.userId],blockUser:e.blockUser,checkUnreadThreads:e.checkUnreadThreads,getUsers:e.getUsers,deleteUsersChat:e.deleteUsersChat,deleteOption:e.state.deleteOption,setHeaderParams:e.setHeaderParams,hideDeleteOption:e.showDeleteChatOption,showRetry:e.state.showRetry,offline:e.state.offline,connectImmediate:e.state.connectImmediate,unreadCount:e.getUserUnreadCount(),injectComponentinDOM:e.injectComponentinDOM,removeIntervention:e.removeIntervention,sendThreadOpenEvent:e.sendThreadOpenEvent,updateInterventionSeenData:e.updateInterventionSeenData,showChatStatusMessage:e.showChatStatusMessage})}),!this.props.children&&(0,r.default)("div",{className:I.default.noThread},void 0,(0,r.default)("div",{},void 0,(0,r.default)("img",{className:I.default.noChatImage,src:P.default})),(0,r.default)("div",{className:I.default.selectChatText},void 0,(0,r.default)(N.FormattedMessage,{id:"noSelectedChat"})))),this.state.injectedComponent)):(0,r.default)(g.default,{header:n,footer:null},void 0,(0,r.default)(m.default,{}))},t}(p.default.Component);B.contextTypes={config:f.default.object,track:f.default.func},B.propTypes={sendMessage:f.default.func,conversations:f.default.array,params:f.default.object,children:f.default.element,getItem:f.default.func,itemsCollection:f.default.object,trackFilters:f.default.object,trackFiltersMetadata:f.default.object,trackOrigin:f.default.string,saveInterventions:f.default.func,saveInterventionsData:f.default.func,saveConversation:f.default.func,saveConversationList:f.default.func,conversationList:f.default.object,interventions:f.default.object,interventionData:f.default.object,removeConversation:f.default.func,chatServiceStatus:f.default.bool,router:f.default.object,messages:f.default.object,toggleUnreadChats:f.default.func,setToastMessageState:f.default.func.isRequired},B.defaultProps={conversations:{},trackFilters:{},trackFiltersMetadata:{},trackOrigin:"",sendMessage:function(){},chatManager:function(){},messages:{},toggleUnreadChats:function(){}};t.default=(0,D.compose)(x.withRouter,(0,M.connect)(function(e){return{itemsCollection:e.items.elements,isFetchingItem:function(t){return e.items.isFetching[t]},trackFilters:e.track.filters,trackFiltersMetadata:e.track.filtersMetadata,trackOrigin:e.track.origin,interventions:e.interventions||{},conversationList:e.chat&&e.chat.conversationList,messages:e.chat&&e.chat.messages,interventionData:e.interventionsData,chatServiceStatus:e.chatServiceStatus}},function(e){return{getItem:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return e((0,_.get)(T.urls.getItem(t),"ELEMENT_ITEMS")).then(function(e){return a(e)})},saveInterventions:function(t){return e((0,w.saveInterventions)(t))},saveInterventionsData:function(t){return e((0,w.saveInterventionsData)(t))},saveConversation:function(t,a){return e((0,w.saveConversation)(t,a))},saveConversationList:function(t){return e((0,w.saveConversationList)(t))},removeConversation:function(t){return e((0,w.removeConversation)(t))},toggleUnreadChats:function(t){return e((0,S.default)(t))},setToastMessageState:function(t){return e((0,U.default)(t))}}}))(B)},2037:function(e,t,a){"use strict";t.__esModule=!0,t.MyChatsComponent=t.mapStateToProps=void 0;var s=M(a(32)),n=M(a(24)),o=M(a(4)),i=M(a(13)),r=M(a(20)),d=M(a(21)),l=M(a(2038)),u=M(a(2044)),c=M(a(238)),p=M(a(346)),f=M(a(2046)),h=M(a(1)),m=M(a(0)),g=M(a(1380)),v=a(64),I=a(44),C=M(a(2047));function M(e){return e&&e.__esModule?e:{default:e}}var _=p.default.icons,y=function(e){function t(){(0,i.default)(this,t);var a=(0,r.default)(this,e.call(this));return a.clearDelOnSwitch=function(){a.delObj=[],a.resetButtonVal()},a.deleteUsersChat=function(e){return function(){a.props.deleteUsersChat(e)}},a.toggleButton=function(e,t){return function(){a.delObj=a.delObj||[];var s=a.delObj.find(function(a){return a.userId===e&&a.itemId===t});s?a.delObj.splice(a.delObj.indexOf(s),1):a.delObj.push({userId:e,itemId:t}),a.resetButtonVal()}},a.retryConnection=function(){a.setState({showConnecting:!0}),setTimeout(function(){a.setState({showConnecting:!1})},1e3)},a.showChatList=function(e,t){var s=(0,o.default)({},e);return s&&(s.otherActions&&s.otherActions.length||s.pendingActions&&s.pendingActions.length)?(0,n.default)(l.default,{conversations:s,interventions:a.props.interventions,onClick:a.props.onChatClick,usersPresence:a.props.usersPresence,currentConversation:a.props.currentConversation,currentItem:a.props.currentItem,deleteChat:a.props.deleteUsersChat,showDeleteChatOption:a.props.showDeleteChatOption,showRadioButton:a.props.showRadioButton,toggleButton:a.toggleButton,offline:a.props.offline,updateInterventionSeenData:a.props.updateInterventionSeenData,removeIntervention:a.props.removeIntervention,injectComponentinDOM:a.props.injectComponentinDOM,tab:t}):a.props.showLoader?null:(0,n.default)("div",{className:g.default.noConversation},void 0,(0,n.default)(v.FormattedMessage,{id:"noConversation"}))},a.handleChange=function(e){var t=e&&e.target.value;1!==t.length||a.searchStart||(a.searchStart=!0,a.context.track("chat_search_start")),a.setState({searchedVal:t}),a.search(t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))},a.toggleSearch=function(){if(a.state.searchedVal.length>0){a.setState({isSearching:!1,searchedVal:""},function(){a.props.changeHeader(a.state.isSearching)}),a.searchStart=!1;var e=a.state.searchedUsers&&a.state.searchedUsers.length||0,t=a.state.searchedItems&&a.state.searchedItems.length||0,s=a.state.searchedMessages&&a.state.searchedMessages.length||0;a.context.track("chat_search_complete",{result_count:e+t+s,search_string:a.state.searchedVal})}else a.props.toggleSearch()},a.state={enableButton:!1,showConnecting:!1,isSearching:!1,searchedMessages:[],searchedItems:[],toMessage:{},searchedVal:"",focussed:!1,slideIndex:0},a.pendingActions=0,a.searchStart=!1,a}return(0,d.default)(t,e),t.prototype.componentWillMount=function(){this.context.track("chat_inbox",{select_from:"all"})},t.prototype.componentDidMount=function(){this.props.chatServiceStatus||this.props.showChatStatusMessage()},t.prototype.componentWillReceiveProps=function(e){var t=this;this.props.showRadioButton===e.showRadioButton||e.showRadioButton||(this.delObj=[],this.resetButtonVal()),this.props.chatServiceStatus===e.chatServiceStatus||e.chatServiceStatus||this.props.showChatStatusMessage(),this.props.currentConversation&&!e.currentConversation&&setTimeout(function(){window.scrollTo(0,t.props.mobileScroll)},100)},t.prototype.resetButtonVal=function(){var e=this.state.enableButton;this.delObj.length>0?e||this.setState({enableButton:!0}):e&&this.setState({enableButton:!1})},t.prototype.showInfo=function(){return this.state.showConnecting?(0,n.default)("div",{className:g.default.infoContainer},void 0,(0,n.default)(v.FormattedMessage,{id:"connectingInfo"}),(0,n.default)(c.default,{containerSize:"15px",stroke:"4px",className:g.default.loadingIcon+" "+g.default.loader})):this.props.offline?(0,n.default)("div",{className:g.default.infoContainer+" "+g.default.offline},void 0,(0,n.default)(v.FormattedMessage,{id:"offline"}),(0,n.default)("span",{className:g.default.refreshIcon+" "+_.panameraIcons+" "+_["icon-Refresh"],onClick:this.retryConnection})):this.props.showLoader?(0,n.default)(u.default,{}):null},t.prototype.filterConversations=function(e,t){var a=this,s=(0,o.default)({},e);return t?(s.otherActions=s.otherActions.filter(function(e){return a.props.items[e.itemId]&&a.props.items[e.itemId].user_id===a.props.user}),s.pendingActions=s.pendingActions.filter(function(e){return a.props.items[e.itemId]&&a.props.items[e.itemId].user_id===a.props.user})):(s.otherActions=s.otherActions.filter(function(e){return a.props.items[e.itemId]&&a.props.items[e.itemId].user_id!==a.props.user}),s.pendingActions=s.pendingActions.filter(function(e){return a.props.items[e.itemId]&&a.props.items[e.itemId].user_id!==a.props.user})),s},t.prototype.search=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.searchedVal,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.props,n={};(0,s.default)(a.conversations).forEach(function(e){a.conversations[e].forEach(function(e){n[e.userId+"_"+e.itemId]=e})}),this.props.getSearchResults(t).then(function(t){return e.updateMessageResult(t)}),t&&t.length?this.state.isSearching?this.setState({searchedUsers:this.searchUsers(t,n),userMessages:n}):this.setState({isSearching:!0,searchedUsers:this.searchUsers(t,n),userMessages:n},function(){e.props.changeHeader(e.state.isSearching)}):this.setState({isSearching:!1},function(){e.props.changeHeader(e.state.isSearching)}),this.searchItems(t,n)},t.prototype.updateMessageResult=function(e){var t=[];e.forEach(function(e){var a={};a.userId=e.userId,a.itemId=e.itemId,a.lastMessage=e,t.push(a)}),this.setState({searchedMessages:t})},t.prototype.updateItemsResult=function(e,t,a){var n=this,o=[];(0,s.default)(a).forEach(function(e){var s=a[e].lastMessage,i=n.props.items[s&&s.itemId];i&&i.title&&i.title.match(new RegExp(t,"gi"))&&o.push(a[e])}),o.sort(function(e,t){return t.lastMessage.date-e.lastMessage.date}),this.setState({searchedItems:o})},t.prototype.searchUsers=function(e,t){var a=this,n=[];return(0,s.default)(t).forEach(function(s){var o=a.props.users[t[s].userId];o&&o.name&&o.name.match(new RegExp(e,"gi"))&&n.push(t[s])}),n.sort(function(e,t){return t.lastMessage.date-e.lastMessage.date}),n},t.prototype.searchItems=function(e,t){var a=this;this.props.getItems().then(function(s){return a.updateItemsResult(s,e,t)})},t.prototype.render=function(){var e=this,t="undefined"!=typeof window&&window.screen.availWidth<this.context.config.get("breakpoint");return(0,n.default)("div",{className:g.default.myChatsPage+" "+g.default[this.props.className]},void 0,this.props.showRadioButton&&(0,n.default)("div",{className:" "+g.default.deleteButtonDiv+" "+(this.state.enableButton?g.default.enabled:g.default.disabled)},void 0,(0,n.default)("div",{className:g.default.deleteButton,"data-aut-id":"deleteChatConfirm",onClick:this.deleteUsersChat(this.delObj)},void 0,(0,n.default)(v.FormattedMessage,{id:"deleteChats"})),(0,n.default)("span",{className:g.default.closeButton+" "+_.panameraIcons+" "+_["icon-Cross"],"data-aut-id":"deleteChatCancel",onClick:this.props.showDeleteChatOption})),this.showInfo(),(0,n.default)("div",{className:g.default.chatList},void 0,!this.props.showLoader&&this.props.showSearch&&(0,n.default)("div",{className:g.default.searchBox},void 0,(0,n.default)(v.FormattedMessage,{id:"chatSearchBox"},void 0,function(a){return(0,n.default)("input",{placeholder:a,onChange:e.handleChange,className:g.default.messageSearchBox,value:e.state.searchedVal,autoFocus:t})}),(this.state.searchedVal.length>0||t)&&(0,n.default)("span",{className:g.default.crossIcon+" "+_.panameraIcons+" "+_["icon-Cross"],onClick:this.toggleSearch})),this.state.isSearching&&(0,n.default)(C.default,{searchedConversations:this.state.searchedMessages,searchedUsers:this.state.searchedUsers,searchedItems:this.state.searchedItems,onChatClick:this.props.onChatClick,searchQuery:this.state.searchedVal}),m.default.createElement(f.default,(0,o.default)({},this.props,{conversations:this.props.conversations,clearDelOnSwitch:this.clearDelOnSwitch,isSearching:this.state.isSearching,showChatList:this.showChatList}))))},t}(m.default.Component);y.propTypes={className:h.default.string.isRequired,onChatClick:h.default.func.isRequired,conversations:h.default.object,currentConversation:h.default.string,currentItem:h.default.string,usersPresence:h.default.object,deleteUsersChat:h.default.func,showDeleteChatOption:h.default.func,showRadioButton:h.default.bool,showLoader:h.default.bool,offline:h.default.bool,interventions:h.default.object,updateInterventionSeenData:h.default.func,removeIntervention:h.default.func,users:h.default.object,items:h.default.object,getSearchResults:h.default.func,getItems:h.default.func,changeHeader:h.default.func,showChatStatusMessage:h.default.func,chatServiceStatus:h.default.bool,showSearch:h.default.bool,toggleSearch:h.default.func,mobileScroll:h.default.number,injectComponentinDOM:h.default.func,user:h.default.string},y.defaultProps={conversations:{otherActions:[],pendingActions:[]},interventionIds:[],currentConversation:"",currentItem:"",showLoader:!1,interventions:{},mobileScroll:0,injectComponentinDOM:function(){},user:""},y.contextTypes={intl:h.default.object,config:h.default.object,track:h.default.func};var S=t.mapStateToProps=function(e){return{interventions:e.interventions||{},users:e.users.elements,items:e.items.elements,chatServiceStatus:e.chatServiceStatus}};t.MyChatsComponent=y,t.default=(0,I.connect)(S)(y)},2038:function(e,t,a){"use strict";t.__esModule=!0;var s=f(a(32)),n=f(a(24)),o=f(a(13)),i=f(a(20)),r=f(a(21)),d=f(a(1)),l=f(a(0)),u=a(64),c=f(a(1380)),p=f(a(1500));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){var a,s,n;(0,o.default)(this,t);for(var r=arguments.length,d=Array(r),l=0;l<r;l++)d[l]=arguments[l];return a=s=(0,i.default)(this,e.call.apply(e,[this].concat(d))),s.onClick=function(e,t,a){return function(){return s.props.onClick(e,t,a)}},n=a,(0,i.default)(s,n)}return(0,r.default)(t,e),t.prototype.showPendingActions=function(e){return e&&e.length?(0,n.default)("div",{},void 0,(0,n.default)("div",{className:c.default.actionHeader},void 0,(0,n.default)(u.FormattedMessage,{id:"chatListNewActions"})),this.showConversations(e)):null},t.prototype.showConversations=function(e){var t=this;return e.map(function(e){var a=t.props.usersPresence[e.userId+"_"+e.itemId]&&t.props.usersPresence[e.userId+"_"+e.itemId].status;return a=a||t.props.usersPresence[e.userId]&&t.props.usersPresence[e.userId].status,(0,n.default)(p.default,{conversation:e,currentItem:t.props.currentItem,onClick:t.onClick(e.userId,e.lastMessage.itemId,t.props.tab),currentConversation:t.props.currentConversation,userPresence:a,deleteChat:t.props.deleteChat,showDeleteChatOption:t.props.showDeleteChatOption,showRadioButton:t.props.showRadioButton,toggleButton:t.props.toggleButton(e.userId,e.itemId),offline:t.props.offline,updateInterventionSeenData:t.props.updateInterventionSeenData,injectComponentinDOM:t.props.injectComponentinDOM,removeIntervention:t.props.removeIntervention},e.userId.toString().concat(e.itemId))})},t.prototype.showOtherActions=function(e,t){return e&&e.length?(0,n.default)("div",{},void 0,t>0&&(0,n.default)("div",{className:c.default.actionHeader+" "+c.default.headerPart2},void 0,(0,n.default)(u.FormattedMessage,{id:"chatListActions"})),this.showConversations(e)):null},t.prototype.render=function(){if(this.props.conversations&&!(0,s.default)(this.props.conversations).length)return null;var e=this.props.conversations,t=e&&e.pendingActions,a=e&&e.otherActions;return(0,n.default)("div",{},void 0,this.showPendingActions(t),this.showOtherActions(a,t&&t.length))},t}(l.default.Component);h.propTypes={conversations:d.default.object,onClick:d.default.func.isRequired,currentConversation:d.default.string,currentItem:d.default.string,usersPresence:d.default.object,deleteChat:d.default.func,showDeleteChatOption:d.default.func,showRadioButton:d.default.bool,offline:d.default.bool,toggleButton:d.default.func,updateInterventionSeenData:d.default.func,removeIntervention:d.default.func,tab:d.default.string,injectComponentinDOM:d.default.func},h.defaultProps={conversations:{},injectComponentinDOM:function(){}},t.default=h},2039:function(e,t,a){"use strict";t.__esModule=!0,t.MakeAnOfferComponent=t.mapDispatchToProps=t.mapStateToProps=void 0;var s=I(a(24)),n=I(a(13)),o=I(a(20)),i=I(a(21)),r=I(a(1052)),d=I(a(165)),l=a(31),u=I(a(1)),c=I(a(0)),p=a(44),f=a(64),h=I(a(2040)),m=I(a(1381)),g=a(54),v=a(67);function I(e){return e&&e.__esModule?e:{default:e}}var C={min:"0",inputMode:"numeric",pattern:"[0-9]*"},M=function(e){function t(a){(0,n.default)(this,t);var i=(0,o.default)(this,e.call(this,a));return i.changeOfferAmount=function(e){var t=i.validate(e);i.setState({offerAmount:e},function(){i.setState({error:t})})},i.makeOffer=function(e){return function(){var t=i.state.offerAmount||e,a=i.props.config,s=a&&a.location&&a.location.currencies?a.location.currencies:[];return t&&(s.length&&(t=s[0].pre+" "+t+" "+s[0].post),i.props.onSubmit(t)),i.toggleModal(),null}},i.toggleModal=function(){document.body.classList.toggle("fixedPosition",!1),i.props.toggleModal()},i.state={offerAmount:""},i.price="",i.validator={mandatory:function(e,t){return t&&t.length?null:e.message},numeric:function(e,t){return isNaN(t)?e.message:null},min:function(e,t){return parseInt(t,10)<parseInt(e.value,10)?e.message:null},max:function(e,t){return parseInt(t,10)>parseInt(e.value,10)?e.message:null}},i.translations={makeAnOffer:(0,s.default)(f.FormattedMessage,{id:"makeAnOffer"}),offerPrice:(0,s.default)(f.FormattedMessage,{id:"offerPrice"})},i}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){document.body.classList.toggle("fixedPosition",!0),this.props.config||this.props.getConfig()},t.prototype.componentWillUnmount=function(){document.body.classList.toggle("fixedPosition",!1)},t.prototype.validate=function(e){if(!this.price){var t=this.props.item,a={min:.7,max:1.3};this.price=t&&t.price&&t.price.value;var n={minPrice:{value:Math.floor(this.price.raw*a.min)},maxPrice:{value:Math.ceil(this.price.raw*a.max)}};this.validationSchema={mandatory:{message:(0,s.default)(f.FormattedMessage,{id:"mandatoryField"},void 0,function(e){return(0,s.default)("span",{"data-aut-id":"rfPrice"},void 0,e)})},numeric:{message:(0,s.default)(f.FormattedMessage,{id:"fieldNumeric"},void 0,function(e){return(0,s.default)("span",{"data-aut-id":"rfPrice"},void 0,e)})},min:{value:n.minPrice.value,message:(0,s.default)(f.FormattedMessage,{id:"fieldMinValue",values:n.minPrice},void 0,function(e){return(0,s.default)("span",{"data-aut-id":"rfPrice"},void 0,e)})},max:{value:n.maxPrice.value,message:(0,s.default)(f.FormattedMessage,{id:"fieldMaxValue",values:n.maxPrice},void 0,function(e){return(0,s.default)("span",{"data-aut-id":"rfPrice"},void 0,e)})}}}var o=this.validationSchema,i=[];for(var r in o)this.validator.hasOwnProperty(r)&&i.push(this.validator[r](o[r],e));return i.filter(function(e){return!!e})},t.prototype.render=function(){var e=this.props.item,t=e&&e.price&&e.price.value,a=t&&t.currency,n=t&&t.raw;return(0,s.default)("div",{className:this.props.className},void 0,(0,s.default)(r.default,{onClick:this.toggleModal,title:this.translations.makeAnOffer,className:h.default.makeAnOfferModal},void 0,(0,s.default)(m.default,{label:this.translations.offerPrice,onChange:this.changeOfferAmount,errorText:this.state.error&&this.state.error[0],price:n.toString(),currency:a,extras:C}),(0,s.default)(d.default,{type:"btnMain",onClick:this.makeOffer(n),className:h.default.sendOffer+" "+(this.state.error&&this.state.error.length>0?h.default.disabled:""),"data-aut-id":"sendOfferBtn"},void 0,(0,s.default)(f.FormattedMessage,{id:"sendOffer",tagName:"div"}))))},t}(c.default.Component);M.propTypes={item:u.default.object,toggleModal:u.default.func,onSubmit:u.default.func,className:u.default.string,config:u.default.object,getConfig:u.default.func};var _=t.mapStateToProps=function(e,t){return{item:e.items.elements[t.itemId],config:e.config.collections[v.urls.getConfig]}},y=(t.mapDispatchToProps=function(e){return{getConfig:function(){return e((0,g.get)(v.urls.getConfig,"CONFIG"))}}},(0,l.compose)((0,p.connect)(_))(M));t.MakeAnOfferComponent=M,t.default=y},2040:function(e,t,a){e.exports={makeAnOfferModal:"_1c-RQ",sendOffer:"_3JMDQ",disabled:"_1EVxv"}},2041:function(e,t,a){"use strict";t.__esModule=!0;var s=r(a(24)),n=r(a(1376)),o=r(a(1)),i=(r(a(0)),a(44));function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){var t=e.item;if(!t)return null;var a=t&&t.price&&t.price.value;return(0,s.default)(n.default,{images:t.images,title:t.title,price:a&&a.display,itemId:e.itemId,onClick:e.toggleModal,callback:e.callback,userId:t.user_id})};d.propTypes={itemId:o.default.string,item:o.default.object,toggleModal:o.default.func,callback:o.default.func};t.default=(0,i.connect)(function(e,t){return{item:e.items.elements[t.itemId]}})(d)},2042:function(e,t,a){"use strict";t.__esModule=!0;var s=p(a(24)),n=p(a(13)),o=p(a(20)),i=p(a(21)),r=p(a(1)),d=p(a(0)),l=p(a(1502)),u=p(a(129)),c=p(a(236));function p(e){return e&&e.__esModule?e:{default:e}}var f=p(a(346)).default.icons,h=function(e){function t(a,s){(0,n.default)(this,t);var i=(0,o.default)(this,e.call(this,a,s));i.state={selected:[!0,!1,!1]};var r=s.config.get("theme");return i.icon=r&&r.icon,i}return(0,i.default)(t,e),t.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},t.prototype.startAnimationTimer=function(e){var t=this;this.timer=setTimeout(function(){var a=t.state.selected;a[e]=!1,a[e<2?e+1:0]=!0,t.setState({selected:a})},500)},t.prototype.showDots=function(){var e=this;return(0,s.default)("div",{className:l.default.dotContainer},void 0,this.state.selected.map(function(t,a){return t&&e.startAnimationTimer(a),(0,s.default)("span",{className:l.default.dot+" "+(t?l.default.active:"")},a)}))},t.prototype.render=function(){return(0,s.default)("div",{className:l.default.interventionContainer+" "+l.default.chatWindow},void 0,(0,s.default)("div",{className:l.default.interventionAnimation+" "+l.default.animation},void 0,(0,s.default)("div",{className:l.default.isTyping},void 0,(0,s.default)(u.default,{to:"/",className:c.default.className([f[this.icon],l.default[this.icon],l.default.icon,f.panameraIcons]),"data-aut-id":"btnOlxLogo"}),this.showDots())))},t}(d.default.Component);h.contextTypes={track:r.default.func,config:r.default.object},t.default=h},2043:function(e,t,a){"use strict";t.__esModule=!0;var s=o(a(24)),n=o(a(1));o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(e){return function(e,t,a){var n=e.split(new RegExp("("+t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+")","gi"));return(0,s.default)("span",{},void 0,n.map(function(e,n){return e.length?(0,s.default)("span",{className:""+(e.toLowerCase()===t.toLowerCase()?a:"")},n,e):null}))}(e.text,e.searchWord,e.className)};i.propTypes={className:n.default.string,text:n.default.string,searchWord:n.default.string},t.default=i},2044:function(e,t,a){"use strict";t.__esModule=!0;var s=i(a(24)),n=(i(a(0)),i(a(2045))),o=i(a(1504));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){for(var e=[],t=0;t<5;t++)e.push((0,s.default)(n.default,{},t));return(0,s.default)("div",{className:o.default.chatLoader},void 0,e)}},2045:function(e,t,a){"use strict";t.__esModule=!0;var s=o(a(24)),n=(o(a(0)),o(a(1504)));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return(0,s.default)("div",{className:n.default.chatContainer},void 0,(0,s.default)("div",{className:n.default.imageContainer},void 0,(0,s.default)("div",{className:n.default.item+" "+n.default.itemTile})),(0,s.default)("div",{className:n.default.itemInfoBox},void 0,(0,s.default)("div",{className:n.default.chatHeader},void 0,(0,s.default)("div",{className:n.default.item+" "+n.default.itemTileHeader})),(0,s.default)("div",{className:n.default.itemInfo},void 0,(0,s.default)("div",{className:n.default.item+" "+n.default.itemTileData})),(0,s.default)("div",{className:n.default.lastMessage},void 0,(0,s.default)("div",{className:n.default.item+" "+n.default.itemTileFooter}))),(0,s.default)("div",{className:n.default.clear}))}},2046:function(e,t,a){"use strict";t.__esModule=!0;var s=l(a(24)),n=l(a(13)),o=l(a(20)),i=l(a(21)),r=l(a(1)),d=l(a(0));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){return(0,n.default)(this,t),(0,o.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t.prototype.render=function(){return(0,s.default)(d.default.Fragment,{},void 0,!this.props.showLoader&&!this.props.isSearching&&this.props.showChatList(this.props.conversations,"all",this.props.showRadioButton))},t}(d.default.Component);u.propTypes={isSearching:r.default.bool.isRequired,showLoader:r.default.bool.isRequired,conversations:r.default.object,showChatList:r.default.func.isRequired,showRadioButton:r.default.bool},u.defaultProps={conversations:{},showRadioButton:!1},u.contextTypes={router:r.default.object},t.default=u},2047:function(e,t,a){"use strict";t.__esModule=!0;var s=f(a(24)),n=f(a(14)),o=f(a(13)),i=f(a(20)),r=f(a(21)),d=f(a(1)),l=f(a(0)),u=f(a(2048)),c=a(64),p=f(a(1500));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){(0,o.default)(this,t);var a=(0,i.default)(this,e.call(this));return a.onSearchItemClick=function(e,t,s){return function(){var n=a.props.searchedUsers&&a.props.searchedUsers.length||0,o=a.props.searchedItems&&a.props.searchedItems.length||0,i=a.props.searchedConversations&&a.props.searchedConversations.length||0;s.count=n+o+i,a.props.onChatClick(e,t,s)}},a.showMore=function(e,t){return function(){var e=(0,n.default)({},a.state.search);e[t]=!0,a.setState({search:e})}},a.state={enableButton:!1,showConnecting:!1,search:{users:!1,items:!1,messages:!1}},a}return(0,r.default)(t,e),t.prototype.showResults=function(e,t){var a=this,n={value:this.props.searchQuery,type:t};return e.length>0?(0,s.default)("div",{},void 0,e.map(function(o,i){var r={};return r.search=n.value,r.type=t,"messages"!==t&&"items"!==t||(r.msg=o.lastMessage),i<3||a.state.search[t]?(0,s.default)(p.default,{conversation:o,onClick:a.onSearchItemClick(o.userId,o.lastMessage.itemId,r),showActivity:!1,highLightQuery:n},i):3===i?(0,s.default)("div",{className:u.default.viewMore,onClick:a.showMore(e,t)},i,(0,s.default)("span",{className:u.default.viewMoreIcon}),"VIEW MORE"):null})):null},t.prototype.render=function(){var e=this.props.searchedUsers&&this.props.searchedUsers.length,t=this.props.searchedItems&&this.props.searchedItems.length,a=this.props.searchedConversations&&this.props.searchedConversations.length;return(0,s.default)("div",{className:u.default.searchResults},void 0,!e&&!t&&!a&&(0,s.default)("div",{className:u.default.noResults},void 0,(0,s.default)(c.FormattedMessage,{id:"noSearchResults"})),a>0&&(0,s.default)("div",{className:u.default.searchGroup},void 0,(0,s.default)(c.FormattedMessage,{id:"messageSearch"})),this.showResults(this.props.searchedConversations,"messages"),e>0&&(0,s.default)("div",{className:u.default.searchGroup},void 0,(0,s.default)(c.FormattedMessage,{id:"userSearch"})),this.showResults(this.props.searchedUsers,"users"),t>0&&(0,s.default)("div",{className:u.default.searchGroup},void 0,(0,s.default)(c.FormattedMessage,{id:"itemSearch"})),this.showResults(this.props.searchedItems,"items"))},t}(l.default.Component);h.propTypes={onChatClick:d.default.func.isRequired,searchedConversations:d.default.array,searchedUsers:d.default.array,searchedItems:d.default.array,searchQuery:d.default.string},h.defaultProps={searchedConversations:[],searchedUsers:[],searchedItems:[]},h.contextTypes={router:d.default.object,intl:d.default.object,track:d.default.func},t.default=h},2048:function(e,t,a){e.exports={searchResults:"_5TCqy",noResults:"_3wZjP",searchGroup:"_26hOW",viewMore:"k841w"}},2049:function(e,t,a){"use strict";t.__esModule=!0,t.NoChats=void 0;var s=d(a(24)),n=(d(a(0)),d(a(2050))),o=a(64),i=d(a(1)),r=d(a(1505));function d(e){return e&&e.__esModule?e:{default:e}}var l=t.NoChats=function(e){var t=e.isSelling;return(0,s.default)("div",{className:n.default.noChatsContainer},void 0,(0,s.default)("div",{className:n.default.noChatsText},void 0,(0,s.default)(o.FormattedMessage,{id:"noChatsText"})),(0,s.default)("div",{className:n.default.noChatsImage},void 0,(0,s.default)("img",{src:r.default})),(0,s.default)("div",{className:n.default.noChatsFooter},void 0,t?(0,s.default)(o.FormattedMessage,{id:"noChatsFooter"}):(0,s.default)(o.FormattedMessage,{id:"noChatsFooterBuying"})))};l.propTypes={isSelling:i.default.bool},l.defaultProps={isSelling:!0},t.default=l},2050:function(e,t,a){e.exports={noChatsContainer:"_2ZFwQ",noChatsHeader:"_2Jt-a",noChatsText:"_3AfGq",noChatsImage:"_3WOCp",noChatsFooter:"_30hp2",noChatslink:"_1LDgS"}},2051:function(e,t,a){"use strict";t.__esModule=!0;var s=w(a(24)),n=w(a(13)),o=w(a(20)),i=w(a(21)),r=w(a(0)),d=w(a(1)),l=w(a(2052)),u=w(a(1294)),c=a(64),p=w(a(1506)),f=w(a(1507)),h=w(a(1508)),m=w(a(1049)),g=w(a(1051)),v=w(a(129)),I=w(a(1080)),C=w(a(346)),M=a(1056),_=w(a(104)),y=w(a(1062)),S=w(a(37));function w(e){return e&&e.__esModule?e:{default:e}}var k=C.default.icons,b=function(e){function t(a){(0,n.default)(this,t);var i=(0,o.default)(this,e.call(this));return i.getDefaultUserName=function(){return(0,s.default)(c.FormattedMessage,{id:"defaultUserNameChat",values:i.brand})},i.bindings={smsClickHandler:i.smsClickHandler.bind(i)},i.optionsDropdownButton=(0,s.default)("span",{"data-aut-id":"ellipssisbtn",className:k.panameraIcons+" "+k["icon-more"]}),i.brand={brand:a.config.get("theme","brand")},i}return(0,i.default)(t,e),t.prototype.smsClickHandler=function(){this.props.smsClickHandler()},t.prototype.render=function(){var e=(0,M.getUserImage)(this.props.user),t=(0,M.getUserImage)(),a=null,n=null;return this.props.userId&&(this.props.user&&this.props.user.id?(a=this.props.user.id,n=this.props.user.name):(a=this.props.userId,n=this.getDefaultUserName())),(0,s.default)(r.default.Fragment,{},void 0,(0,s.default)("div",{className:""+l.default.defaultHeader},void 0,(0,s.default)(y.default,{searchTerm:this.props.searchTerm,user:S.default.getUser(),params:this.props.params})),(0,s.default)("header",{className:u.default.header+" "+l.default.chatHeader},void 0,(0,s.default)("div",{className:l.default.chatContainer},void 0,(0,s.default)("nav",{},void 0,(0,s.default)(g.default,{icon:"icon-Back",className:""+u.default.navIcon,onClick:this.props.onClickBack})),this.props.title&&(0,s.default)("h2",{className:l.default.sectionTitle},void 0,this.props.title),this.props.userId&&(0,s.default)(v.default,{to:"/nf/user/"+(this.props.user.id||this.props.userId),className:l.default.avatar,rel:"nofollow"},void 0,(0,s.default)(m.default,{diameter:"38px",image:e||t})),this.props.userId&&(0,s.default)("div",{className:l.default.userNameHeader+" "+(this.props.isUserPresenceMarquee?l.default.overflowHidden:"")},void 0,(0,s.default)(v.default,{to:"/nf/user/"+a,className:l.default.title+" "+(this.props.isUserNameShortened?l.default.shortName:"")+" "+(this.props.userPresence?l.default.titleTranslate:""),rel:"nofollow"},void 0,n),this.props.userPresence&&(0,s.default)("div",{className:l.default.userPresence+" "+(this.props.isUserPresenceMarquee?l.default.marquee:"")},void 0,this.props.userPresence)),(0,s.default)("div",{className:l.default.rightHeaderButtons},void 0,this.props.optionsMenu.length>0&&(0,s.default)("div",{className:l.default.headerBtn+" "+l.default.optionsMenu},void 0,(0,s.default)("div",{className:l.default.optionsMenu},void 0,(0,s.default)(I.default,{actionable:this.optionsDropdownButton,listClassName:l.default.dropDownList},void 0,this.props.optionsMenu))),this.props.phone&&this.props.showSmsButton&&(0,s.default)("div",{className:l.default.headerBtn+" "+l.default.smsButton},void 0,(0,s.default)(p.default,{phone:this.props.phone,smsButtonClassName:this.props.smsButtonClassName,smsClickHandler:this.bindings.smsClickHandler,isBlocked:this.props.isBlocked})),this.props.phone&&this.props.showCallButton&&(0,s.default)("div",{className:l.default.headerBtn+" "+l.default.smsButton},void 0,(0,s.default)(f.default,{phone:this.props.phone,smsButtonClassName:this.props.smsButtonClassName,track:this.props.track,callClickHandler:this.props.callClickHandler,isBlocked:this.props.isBlocked})),this.props.showUserTipsIcon&&this.props.showFlagIconInMenu&&(0,s.default)("div",{className:l.default.headerBtn+" "+l.default.tipsBtn},void 0,(0,s.default)(h.default,{toggleFirstTimeUserTips:this.props.toggleFirstTimeUserTips})),this.props.showFlagIcon&&!this.props.showFlagIconInMenu&&(0,s.default)("div",{className:l.default.headerBtn+" "+l.default.flagBtn},void 0,(0,s.default)("i",{onClick:this.props.toggleReportModal,className:k.panameraIcons+" "+k["icon-Flag"]+" "}))),this.props.editOption&&(0,s.default)("div",{className:l.default.edit,onClick:this.props.onEditClick},void 0,(0,s.default)(c.FormattedMessage,{id:this.props.editOption})),this.props.searchOption&&(0,s.default)("div",{className:l.default.searchChat,onClick:this.props.onSearchClick},void 0,(0,s.default)("span",{className:l.default.searchIcon+" "+k.panameraIcons+" "+k["icon-Search"]})))))},t}(r.default.Component);b.contextTypes={router:d.default.object,config:d.default.object,track:d.default.func,trackerOrigins:d.default.object},b.propTypes={onClickBack:d.default.func,user:d.default.object,userId:d.default.string,searchTerm:d.default.string,userPresence:d.default.oneOfType([d.default.element,d.default.string]),isUserPresenceMarquee:d.default.bool,isUserNameShortened:d.default.bool,isBlocked:d.default.bool,title:d.default.oneOfType([d.default.element,d.default.string]),optionsMenu:d.default.array,onEditClick:d.default.func,editOption:d.default.string,onSearchClick:d.default.func,searchOption:d.default.string,phone:d.default.oneOfType([d.default.string,d.default.bool]),smsButtonClassName:d.default.string,smsClickHandler:d.default.func,callClickHandler:d.default.func,track:d.default.func,showUserTipsIcon:d.default.bool,toggleFirstTimeUserTips:d.default.func,toggleReportModal:d.default.func,showFlagIcon:d.default.bool,showFlagIconInMenu:d.default.bool,params:d.default.object,showSmsButton:d.default.bool,showCallButton:d.default.bool,config:d.default.shape({get:d.default.func.isRequired}).isRequired},b.defaultProps={onClickBack:function(){},user:{},userId:null,searchTerm:"",userPresence:"",isUserPresenceMarquee:!1,isUserNameShortened:!1,isBlocked:!1,icon:"",title:"",optionsMenu:[],showUserTipsIcon:!1,toggleFirstTimeUserTips:function(){},toggleReportModal:function(){},showSmsButton:!1,showCallButton:!1},t.default=(0,_.default)(b)},2052:function(e,t,a){e.exports={chatHeader:"_3goDe",sellCTA:"SZd2_",chatBtn:"_3XoIx",chatContainer:"_3iW4f",rotate180:"_3fppx",sectionTitle:"_2QwKC",userInfo:"_3fmEI",avatar:"_2F74i",userNameHeader:"_1__ae",overflowHidden:"qGhI1",title:"G9f4H",titleTranslate:"PRYT-",shortName:"_1YjT4",userPresence:"_2JEcv",marquee:"_3cTl_",rightHeaderButtons:"_1n_Hv",headerBtn:"_2I4NX",smsButton:"_2DFJg",tipsBtn:"RRKcm",flagBtn:"_3C-Pf",optionsMenu:"_1Hqhm",dropDownList:"_3XL6g",edit:"_15Jnd",searchIcon:"_1KB7X",searchChat:"_30t6G",search:"f8Ht1",defaultHeader:"_2o0-Q"}},2053:function(e,t,a){e.exports={tips:"_1riCS",toolTipShow:"_3N1eV",animate:"_3Rw-6"}},2054:function(e,t,a){e.exports={chatThreadScreen:"_3Y32P",chatContainer:"rSvNp",chatScreen:"_23_3V",myChatsScreen:"_2RgLO",noThread:"_2FgBW",noChatImage:"_2f19f",selectChatText:"_1IEEi",hidden:"_33y6y",onChatThread:"_25m0Z",isSearching:"_1vZo1",myChats:"C43E5"}},2055:function(e,t,a){"use strict";t.__esModule=!0,t.ChatThreadComponent=t.mapDispatchToProps=t.mapStateToProps=void 0;var s=$(a(26)),n=$(a(32)),o=$(a(56)),i=$(a(4)),r=$(a(90)),d=$(a(14)),l=$(a(24)),u=$(a(13)),c=$(a(20)),p=$(a(21)),f=a(239),h=a(350),m=$(a(1506)),g=$(a(1507)),v=$(a(1508)),I=a(67),C=$(a(1366)),M=$(a(1049)),_=$(a(129)),y=$(a(238)),S=$(a(1080)),w=$(a(346)),k=$(a(1276)),b=$(a(1501)),T=$(a(1)),N=$(a(0)),x=a(31),D=a(64),P=$(a(172)),U=a(44),O=$(a(2056)),B=a(54),F=X(a(1386)),L=$(a(37)),R=$(a(1079)),A=$(a(2094)),E=$(a(2111)),j=$(a(2115)),H=$(a(2116)),V=a(380),W=X(a(170)),q=a(396),z=a(1422),K=$(a(1110)),G=$(a(1111)),Q=$(a(1112)),Y=$(a(1113)),Z=$(a(104)),J=$(a(355));function X(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function $(e){return e&&e.__esModule?e:{default:e}}var ee=(0,P.default)().fetch,te=[K.default,G.default,Q.default,Y.default],ae=w.default.icons,se=function(e){function t(a,s){(0,u.default)(this,t);var n=(0,c.default)(this,e.call(this,a,s));return ne.call(n),n.state={currentMessage:"",openLocation:!1,selectedFile:"",showPopup:!1,showDeletePopup:!1,showBlockPopup:!1,timer:0,showConnecting:!1,showTips:!(window&&window.localStorage&&window.localStorage.getItem("seenFirstTimeUserTips")),initiationPoint:"chat",voiceMessageCount:{},openReportModal:!1,showCallModal:!1},n.chatState={composing:(0,l.default)(D.FormattedMessage,{id:"typingStatus"}),active:(0,l.default)(D.FormattedMessage,{id:"onlineStatus"}),paused:(0,l.default)(D.FormattedMessage,{id:"onlineStatus"}),available:(0,l.default)(D.FormattedMessage,{id:"onlineStatus"}),unavailable:""},n.sendSystemMsg=!0,n.location="",n.chatConfig=a.config.get("chat").newChat,n.imgData=n.chatConfig.imgData,n.voiceData=n.chatConfig.voiceData,n.requestId=(0,z.createHmac)("sha256",n.chatConfig.hmacPwd).update(n.imgData.hmacKey).digest("hex"),n.voiceData&&(n.vrequestId=n.voiceData.hmacKey?(0,z.createHmac)("sha256",n.chatConfig.hmacPwd).update(n.voiceData.hmacKey).digest("hex"):null),n.translations={lastSeen:function(e){return(0,l.default)(D.FormattedMessage,{id:"lastSeen",values:e})},shareLoc:(0,l.default)(D.FormattedMessage,{id:"shareLoc"}),selectLoc:(0,l.default)(D.FormattedMessage,{id:"selectLoc"})},n.oCategoryBrandTrack=n.chatConfig.tracking,n.elements={dropdownButton:(0,l.default)("span",{"data-aut-id":"ellipssisbtn",className:ae.panameraIcons+" "+ae["icon-more"]}),dropdownOptions:[!n.state.showTips&&(0,l.default)("div",{"data-aut-id":"reportUsr",onClick:n.toggleReportModal},0,(0,l.default)(D.FormattedMessage,{id:"reportUserModalTitle"})),(0,l.default)("div",{onClick:n.toggleDeletePopup},1,(0,l.default)(D.FormattedMessage,{id:"deleteChat"}))]},n.brand={brand:a.config.get("theme","brand")},n}return(0,p.default)(t,e),t.prototype.componentWillMount=function(){this.setState({readMessageCount:this.getReadMessageCount()}),this.props.getUsers()},t.prototype.componentDidMount=function(){this.props.itemsCollection[this.props.params.itemId]||this.props.isFetchingItem(this.props.params.itemId)||this.props.getItem(this.props.params.itemId),this.props.params.itemId&&this.props.params.amount&&this.sendMessage(this.context.intl.messages.makeOfferMsg+" "+this.props.params.amount,this.props.params.userId,this.props.params.itemId);var e=this.props.interventionMsg;e&&this.sendIntervention(e.data,e.userId,e.itemId),this.onUpdate(),this.props.params.itemId&&this.props.sendThreadOpenEvent(this.props.params.itemId,this.props.params.userId),this.props.chatServiceStatus||this.props.showChatStatusMessage(),this.props.checkUnreadThreads()},t.prototype.componentWillReceiveProps=function(e){var t=e.interventionMsg,a=e.messages,s=this.props.messages;t&&t!==this.props.interventionMsg&&this.sendIntervention(t.data,t.userId,t.itemId),s.length!==a.length&&a.length&&a[a.length-1].isMine&&this.resetReadCount(),this.props.chatServiceStatus===e.chatServiceStatus||e.chatServiceStatus||this.props.showChatStatusMessage(),this.props.params.itemId===e.params.itemId&&this.props.params.userId===e.params.userId||this.props.sendThreadOpenEvent(e.params.itemId,e.params.userId)},t.prototype.componentWillUpdate=function(e){var t=this;this.props.isBlocked!==e.isBlocked?this.onUpdate(e):!e.showRetry||this.props.showRetry||e.connectImmediate?this.props.userTypingStatus&&e.userTypingStatus&&this.props.userTypingStatus.status!==e.userTypingStatus.status||this.props.userPresence&&e.userPresence&&(this.props.userPresence.status!==e.userPresence.status||this.props.userPresence.lastSeen!==e.userPresence.lastSeen)||this.props.connAvailable!==e.connAvailable||this.props.params.userId!==e.params.userId||this.props.user!==e.user||this.props.offline!==e.offline||this.props.showRetry!==e.showRetry||!this.props.messages.length&&e.messages.length?this.onUpdate(e,!1):(void 0===this.props.userPresence&&e.userPresence||void 0===this.props.userTypingStatus&&e.userTypingStatus||void 0===e.userTypingStatus&&this.props.userTypingStatus)&&this.onUpdate(e,!1):(this.setState({timer:this.chatConfig.retryTime/1e3}),this.interval=setInterval(function(){return t.startTimer()},1e3))},t.prototype.componentDidUpdate=function(){this.shouldShowSmsButton()&&this.onUpdate()},t.prototype.componentWillUnmount=function(){this.sendState("active",this.props.params.itemId)},t.prototype.onUpdate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state;if(t){var s=e.isBlocked;this.elements.dropdownOptions[2]=(0,l.default)("div",{onClick:this.toggleBlockDialog},2,(0,l.default)(D.FormattedMessage,{id:(s?"unblock":"block")+"User"}))}this.elements.dropdownOptions[0]=(0,l.default)("div",{onClick:this.showSafetyTips},0,(0,l.default)(D.FormattedMessage,{id:"safetyTips"})),this.props.setHeaderParams({onClickBack:this.props.chatThreadBackClick,user:this.props.user,userId:this.props.params.userId,userPresence:this.lastseen(e),isUserPresenceMarquee:this.isUserPresenceMarquee(),isUserNameShortened:this.isUserNameShortened(),isBlocked:e.isBlocked,optionsMenu:this.getOptionsMenu(e),phone:this.getUserPhone(),showCallButton:this.shouldShowCallButton(),showSmsButton:this.shouldShowSmsButton(),smsClickHandler:this.smsClickHandler,callClickHandler:this.callClickHandler,track:this.trackCall,showUserTipsIcon:!0,toggleFirstTimeUserTips:this.toggleFirstTimeUserTips,toggleReportModal:this.toggleReportModal,showFlagIconInMenu:a.showFlagIconInMenu,showFlagIcon:!0})},t.prototype.getReadMessageCount=function(){var e=this.props.messages,t=e.filter(function(e){var t=e.isMine,a=e.info;return!(t||a)});return e.indexOf(t[t.length-this.props.unreadCount])},t.prototype.getUserPhone=function(){var e=this.props.itemsCollection[this.props.params.itemId];if(e&&e.parameters){var t=e.parameters.find(function(e){return e&&"phone"===e.key});return t&&t.value}return!1},t.prototype.shouldShowSmsButton=function(){return this.props.config.get("adDetails","showSmsButton")&&this.getUserPhone()&&this.checkUserNotOwnAd()},t.prototype.shouldShowCallButton=function(){return this.props.config.get("adDetails","showCallButton")&&this.getUserPhone()&&this.checkUserNotOwnAd()},t.prototype.checkUserNotOwnAd=function(){var e=this.props.itemsCollection[this.props.params.itemId];return L.default.getUser()&&e&&L.default.getUser().id!==e.user_id},t.prototype.startTimer=function(){this.state.timer>0?this.setState({timer:this.state.timer-1}):clearInterval(this.interval)},t.prototype.getStatus=function(e){var t="normal";return e.hot?t="hot":e.new&&(t="new"),t},t.prototype.trackVoice=function(e,t){var a=this.props.params.itemId?{item_id:this.props.params.itemId}:{};this.context.track(e,(0,d.default)(a,t))},t.prototype.trackFirstMsg=function(e){var t=this.props.messages&&this.props.messages.length&&this.props.messages.find(function(e){var t=e.call,a=e.sms;return!t&&!a}),a=(0,d.default)({origin:this.props.trackOrigin},{filters:this.props.trackFilters},this.props.trackFiltersMetadata);!t&&e&&(this.props.itemsCollection&&this.props.itemsCollection[e]&&this.props.itemsCollection[e].category_id&&this.oCategoryBrandTrack&&this.oCategoryBrandTrack[this.props.itemsCollection[e].category_id]&&this.track(this.oCategoryBrandTrack[this.props.itemsCollection[e].category_id],e,a),this.track("item_chat_tap_send_1st_reply",e,a))},t.prototype.sendState=function(e,t){this.props.sendState(e,t)},t.prototype.showPresence=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return e.connAvailable&&!e.isBlocked&&!e.offline},t.prototype.lastseen=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,a=(t.userTypingStatus||{}).status,s=(t.userPresence||{}).lastSeen;if(a||(a=t.userPresence&&t.userPresence.status),this.showPresence(t)){if(a&&this.chatState[a])return(0,l.default)("div",{className:R.default.userStatus},void 0,this.chatState[a]);if(s)return(0,l.default)("div",{className:R.default.userStatus},void 0,(0,l.default)("div",{},void 0,(0,l.default)(D.FormattedDate,{day:"numeric",month:"short",value:new Date(s)},void 0,function(t){return(0,l.default)(D.FormattedTime,{hour12:!1,value:new Date(s)},void 0,function(a){return(new Date).toDateString()===new Date(s).toDateString()?e.translations.lastSeen({date:"Today",time:a}):e.translations.lastSeen({date:t,time:a})})})))}return null},t.prototype.isUserPresenceMarquee=function(){var e=(this.props.userPresence||{}).lastSeen;return this.showPresence()&&this.shouldShowSmsButton()&&e&&window.screen.availWidth<=320},t.prototype.isUserNameShortened=function(){return this.shouldShowSmsButton()&&window.screen.availWidth<=420},t.prototype.updateKey=function(e,t){var a=(0,d.default)({},this.props.imagesData);a[this.props.params.userId][t]=(0,d.default)({},this.props.imagesData[this.props.params.userId][e]),delete a[this.props.params.userId][e],this.props.saveImagesData(a)},t.prototype.updateImgObj=function(e,t,a){var s,n=this.props.params.userId,o=((s={})[n]={},s);this.props.imagesData[n]?(o[n][e]=(0,d.default)({},this.props.imagesData[n][e],t),o[n]=(0,d.default)({},this.props.imagesData[n],o[n])):o[n][e]=t,a&&this.setState({selectedFile:""}),this.props.saveImagesData((0,d.default)({},this.props.imagesData,o))},t.prototype.increementVoiceMessageCount=function(){var e,t=0;this.state.voiceMessageCount&&this.state.voiceMessageCount[this.props.params.userId]&&(t=this.state.voiceMessageCount[this.props.params.userId]),this.setState({voiceMessageCount:(0,d.default)({},this.state.voiceMessageCount,(e={},e[this.props.params.userId]=t+1,e))})},t.prototype.decreementVoiceMessageCount=function(){if(this.state.voiceMessageCount&&this.state.voiceMessageCount[this.props.params.userId]){var e,t=this.state.voiceMessageCount[this.props.params.userId];this.setState({voiceMessageCount:(0,d.default)({},this.state.voiceMessageCount,(e={},e[this.props.params.userId]=t-1,e))})}},t.prototype.renderOptionsMenu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return e.messages&&e.messages.length>0?(0,l.default)("div",{className:R.default.optionsMenu},void 0,(0,l.default)(S.default,{actionable:this.elements.dropdownButton,listClassName:R.default.dropDownList},void 0,this.elements.dropdownOptions)):null},t.prototype.getOptionsMenu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return e.messages&&e.messages.length>0?this.elements.dropdownOptions:[]},t.prototype.renderSMSButton=function(){return this.shouldShowSmsButton()?(0,l.default)("div",{className:R.default.rightHeaderIcons},void 0,(0,l.default)(m.default,{phone:this.getUserPhone(),smsButtonClassName:R.default.smsButton,smsClickHandler:this.smsClickHandler,isBlocked:this.props.isBlocked})):null},t.prototype.renderCallButton=function(){return this.shouldShowCallButton()?(0,l.default)("div",{className:R.default.rightHeaderIcons},void 0,(0,l.default)(g.default,{phone:this.getUserPhone(),callButtonClassName:R.default.callButton,track:this.trackCall,callClickHandler:this.callClickHandler,isBlocked:this.props.isBlocked})):null},t.prototype.renderTipsButton=function(){return(0,l.default)("div",{className:" "+R.default.rightHeaderIcons+" "+R.default.tipsBtn},void 0,(0,l.default)(v.default,{toggleFirstTimeUserTips:this.toggleFirstTimeUserTips}))},t.prototype.renderFlagButton=function(){return(0,l.default)("div",{className:R.default.rightHeaderIcons+" "+R.default.flagBtn},void 0,(0,l.default)("i",{onClick:this.toggleReportModal,className:ae.panameraIcons+" "+ae["icon-Flag"]+" "}))},t.prototype.showInfoMessage=function(){if(this.state.showConnecting)return(0,l.default)("div",{className:R.default.messageInfo},void 0,(0,l.default)(D.FormattedMessage,{id:"connectingInfo"}),(0,l.default)(y.default,{containerSize:"15px",stroke:"4px",className:R.default.loadingIcon+" "+R.default.loader}));if(this.props.offline)return(0,l.default)("div",{className:R.default.messageInfo},void 0,(0,l.default)(D.FormattedMessage,{id:"offline"}),(0,l.default)("span",{className:R.default.refreshIcon+" "+ae.panameraIcons+" "+ae["icon-Refresh"],onClick:this.retryConnection}));if(this.props.showRetry&&this.props.connectImmediate)return(0,l.default)("div",{className:R.default.messageInfo},void 0,(0,l.default)(D.FormattedMessage,{id:"connectingInfo"}),(0,l.default)(y.default,{containerSize:"15px",stroke:"4px",className:R.default.loadingIcon+" "+R.default.loader}));if(this.props.showRetry&&this.state.timer){var e={timer:this.state.timer};return(0,l.default)("div",{className:R.default.messageInfo},void 0,(0,l.default)(D.FormattedMessage,{id:"chatConnecting",values:e}),(0,l.default)(y.default,{containerSize:"15px",stroke:"4px",className:R.default.loadingIcon+" "+R.default.loader}))}return null},t.prototype.render=function(){var e=this;if(!this.props.user)return null;var t=void 0,a=R.default.userTitle,s=(this.props.userTypingStatus||{}).status,n=(this.props.userPresence||{}).lastSeen,o=this.props.params.userId;s||(s=this.props.userPresence&&this.props.userPresence.status),t=this.props.user.images&&this.props.user.images.length?(0,l.default)(M.default,{diameter:"40px",className:R.default.avatarWithImage,image:this.props.user.images[0].small.url}):(0,l.default)(M.default,{diameter:"40px",className:R.default.avatar,image:te[this.props.user.avatar_id-1]}),this.showPresence()&&(this.chatState[s]||n)&&(a=a+" "+R.default.titleTranslate),this.props.user.id?o=this.props.user.id:this.props.params&&this.props.params.userId&&(t=(0,l.default)(M.default,{diameter:"40px",className:R.default.avatar,image:te[0]}));var i=this.props.messages;return(0,l.default)("div",{className:R.default.chatThread+" "+R.default[this.props.className]},void 0,(0,l.default)("div",{className:R.default.userName},void 0,(0,l.default)(_.default,{className:R.default.profileLink,to:"/nf/user/"+o,rel:"nofollow"},void 0,t),(0,l.default)("div",{className:R.default.userInfo},void 0,(0,l.default)(_.default,{to:"/nf/user/"+o,className:a,rel:"nofollow"},void 0,this.props.user.name||this.getDefaultUserName()),this.lastseen()),(0,l.default)("div",{className:R.default.chatHeaderIcons},void 0,this.renderOptionsMenu(),this.renderSMSButton(),this.renderCallButton(),this.state.showTips&&this.renderTipsButton(),!this.state.showTips&&this.renderFlagButton())),this.state.showBlockPopup&&(0,l.default)(H.default,{value:this.props.isBlocked?"unblock":"block",userName:this.props.user&&this.props.user.name||this.getDefaultUserName(),blockUser:this.blockUser,toggleBlockDialog:this.toggleBlockDialog}),this.state.showDeletePopup&&(0,l.default)(j.default,{toggleDeletePopup:this.toggleDeletePopup,confirmDelete:this.deleteChat}),this.showInfoMessage(),(0,l.default)(A.default,{focusMessage:this.props.focusMessage,messages:i,itemId:this.props.itemId,userId:this.props.params.userId,user:this.props.user,previewImgObj:this.props.imagesData[this.props.params.userId],previewVoiceMessage:this.state.voiceMessageCount[this.props.params.userId],sendImage:this.sendImage,chatConfig:this.chatConfig,showSystemMsg:this.showSystemMsg,track:this.track,actionTriggered:this.actionTriggered,removeKey:this.removeImgObj,readMessageCount:this.state.readMessageCount,userName:this.props.user.name||this.getDefaultUserName(),interventionBox:"object"===(0,r.default)(this.props.intervention),toggleFirstTimeUserTips:this.toggleFirstTimeUserTips,config:this.props.configData}),this.props.intervention&&(0,l.default)(b.default,{userId:this.props.params.userId,intervention:this.props.intervention,shareLocation:this.shareLocation,sharePhoto:this.sharePhoto(),screen:"chat_window",sendMessage:this.sendIntervention,lastMsg:i&&i[i.length-1],removeIntervention:this.props.removeIntervention,injectComponentinDOM:this.props.injectComponentinDOM,updateInterventionSeenData:this.props.updateInterventionSeenData}),this.state.showTips&&(0,l.default)(C.default,{toggleModal:this.toggleFirstTimeUserTips,initationPoint:this.state.initiationPoint,origin:"chat"}),N.default.createElement(E.default,{ref:function(t){e.messageInputRef=t},chatConfig:this.chatConfig,sendImage:this.sendImage,uploadVoiceData:this.uploadVoiceData,shareLocation:this.shareLocation,sendUserState:this.sendUserState,sendMessage:this.sendMessage,track:this.track,itemId:this.props.itemId,userId:this.props.params.userId,isBlocked:this.props.isBlocked,showUnblockPopup:this.showBlockInfoDialog,deleteOption:this.props.deleteOption,hideDeleteOption:this.props.hideDeleteOption,offline:this.props.offline,connAvailable:this.props.connAvailable,currentMessage:this.state.currentMessage,showInfoMsg:this.showInfoMsg}),this.state.openLocation&&(0,l.default)(O.default,{isOpened:this.state.openLocation,lat:this.location.lat,lng:this.location.lon,submitButtonText:this.translations.shareLoc,onClose:this.onClose,onSubmit:this.onSubmit,title:this.translations.selectLoc,country:this.props.config.get("countryCode")}),this.state.openReportModal&&(0,l.default)(k.default,{ID:this.props.params.userId,onClick:this.toggleReportModal,type:"users"}))},t}(N.default.Component);se.contextTypes={intl:T.default.object,track:T.default.func,config:T.default.object,location:T.default.shape({get:T.default.func}),localStorage:T.default.object},se.propTypes={sendMessage:T.default.func,className:T.default.string,chatThreadBackClick:T.default.func,sendState:T.default.func,user:T.default.object,params:T.default.object,messages:T.default.array,itemId:T.default.string,userPresence:T.default.object,connAvailable:T.default.bool,getItem:T.default.func,blockUser:T.default.func,isBlocked:T.default.bool,deleteUsersChat:T.default.func,hideDeleteOption:T.default.func,deleteOption:T.default.bool,showRetry:T.default.bool,offline:T.default.bool,retryConnection:T.default.func,itemsCollection:T.default.object,isFetchingItem:T.default.func,unreadCount:T.default.number,connectImmediate:T.default.bool,trackFilters:T.default.object,trackFiltersMetadata:T.default.object,trackOrigin:T.default.string,intervention:T.default.object,interventionMsg:T.default.object,onInterventionClick:T.default.func,sendThreadOpenEvent:T.default.func,removeIntervention:T.default.func,updateInterventionSeenData:T.default.func,focusMessage:T.default.oneOfType([T.default.object,T.default.bool]),imagesData:T.default.object,saveImagesData:T.default.func,showChatStatusMessage:T.default.func,chatServiceStatus:T.default.bool,userTypingStatus:T.default.object,config:T.default.object,configData:T.default.object,injectComponentinDOM:T.default.func,getUsers:T.default.func,checkUnreadThreads:T.default.func,setHeaderParams:T.default.func,setToastMessageState:T.default.func.isRequired},se.defaultProps={sendMessage:function(){},className:"",chatThreadBackClick:function(){},getUsers:function(){},user:{},item:{},messages:[],itemId:"",offline:!1,unreadCount:0,connectImmediate:!1,trackFilters:{},trackFiltersMetadata:{},trackOrigin:"",interventionMsg:null,imagesData:{},config:{},configData:{},injectComponentinDOM:function(){},checkUnreadThreads:function(){},setHeaderParams:function(){}};var ne=function(){var e=this;this.showSafetyTips=function(){e.toggleFirstTimeUserTips("toolTip")},this.sharePhoto=function(){return e.messageInputRef&&e.messageInputRef.sharePhoto},this.track=function(t,a,s){var n=e.props.itemsCollection[a],o=n?{item_id:n.id,seller_id:n.user_id,item_status:e.getStatus(n.status&&n.status.flags),creation_date:n.created_at,category_id:n.category_id}:{};e.context.track(t,(0,d.default)(o,s))},this.showInfoMsg=function(t){e.props.setToastMessageState({isOpen:!0,message:t,expiration:5e3})},this.trackCall=function(t,a){var s=(0,d.default)({origin:e.props.trackOrigin},{filters:e.props.trackFilters},e.props.trackFiltersMetadata);e.track(t,e.props.params.itemId,(0,i.default)({},s,a))},this.sendMessage=function(t,a,s,n,o){return e.props.isBlocked&&t?(e.showBlockInfoDialog(),void(n||e.setState({currentMessage:t}))):(e.state.currentMessage&&e.setState({currentMessage:""}),e.props.connAvailable?("sms"!==n&&e.trackFirstMsg(s),"location"===n?e.location.lat===o.lat&&e.location.lon===o.lon?e.track("item_chat_shared_current_location",s):e.track("item_chat_shared_search_location",s):"image"===n&&e.track("item_chat_image_uploaded",s),e.sendUserState("active"),e.props.sendMessage(t,a,s,n,o)):(e.context.track("item_chat_send_message_error",{timerVisible:e.props.showRetry}),void e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"connectionLost"}))))},this.sendIntervention=function(t,a,s){e.props.onInterventionClick({reset:!0});var n={actionId:t.actionId,interventionId:t.id};t.params&&(n.params=(0,o.default)(t.params)),e.sendMessage(t.msg,a,s,"intervention",n)},this.sendUserState=function(t){e.props.isBlocked||(clearTimeout(e.timeout),e.sendState(t,e.props.params.itemId),e.timeout=setTimeout(e.sendState.bind(e,"active",e.props.params.itemId),3e3))},this.resetReadCount=function(){null!==e.state.readMessageCount&&e.setState({readMessageCount:null})},this.removeImgObj=function(t){var a=(0,d.default)({},e.props.imagesData);delete a[e.props.params.userId][t],e.props.saveImagesData(a)},this.sendImage=function(t,a){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t,r=null;if((r=a).type.match("image.*"))if(r.size>=e.imgData.maxSize||r.size<=e.imgData.minSize)e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"imageLimitSize"}));else{var d=new FileReader,u={method:"POST",body:new FormData,headers:{"x-request-id":e.requestId},mode:"cors"};d.onloadend=function(){var t=e.props.imagesData&&e.props.imagesData[e.props.params.userId];t&&t[i]&&o&&(i=(0,n.default)(t).length+1),e.updateImgObj(i,{imagePreviewUrl:d.result,status:"uploading",file:r},!0),r&&(u.body.append("image",r),ee(e.imgData.imgUploadUrl,u).then(function(e){return e.ok?e.json():(e.status===W.statusCodes.SERVICE_UNAVAILABLE&&(0,q.setChatStatus)(!1),s.default.reject(e))}).then(function(t){return t.error?s.default.reject():((0,q.setChatStatus)(!0),e.updateKey(i,t.url),e.sendMessage(e.context.intl.messages.appUpgradeChatMsg,e.props.params.userId,e.props.params.itemId,"image",{url:t.url,thumb:t.url_thumb}))}).catch(function(t){if(e.track("item_chat_image_upload_error",e.props.params.itemId),t&&void 0!==t.ok&&!0!==t.ok)return e.removeImgObj(i),void e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"imageError"}));e.props.connAvailable||e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"noInternetError"})),e.updateImgObj(i,{status:"error"})}))},d.readAsDataURL(r)}else e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"imageFormatError"}))},this.uploadVoiceData=function(t){var a={method:"POST",body:new FormData,headers:{"x-request-id":e.vrequestId},mode:"cors"};a.body.append("voice",t),e.increementVoiceMessageCount(),ee(e.voiceData.voiceUploadUrl,a).then(function(e){return e.ok?e.json():(e.status===W.statusCodes.SERVICE_UNAVAILABLE&&(0,q.setChatStatus)(!1),s.default.reject(e))}).then(function(a){return a.error?s.default.reject():((0,q.setChatStatus)(!0),e.messageInputRef.getDuration().then(function(s){e.decreementVoiceMessageCount();var n=e.sendMessage(e.context.intl.messages.voiceSupportText,e.props.params.userId,e.props.params.itemId,"voice",{url:a.url,duration:1e3*s});e.trackVoice("item_chat_voice_uploaded",{select_from:"sender",result_count:s,file_size:t.size,resultset_id:n})}))}).catch(function(a){e.decreementVoiceMessageCount(),e.messageInputRef.getDuration().then(function(s){e.trackVoice("item_chat_voice_upload_error",{select_from:"sender",result_count:s,file_size:t.size,reason:a.message})}),a&&void 0!==a.ok&&!0!==a.ok?e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"voiceUploadError"})):e.props.connAvailable?e.showInfoMsg(a.message):e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"noInternetError"}))})},this.shareLocation=function(){e.location||(e.location=e.context.location.get()),e.track("item_chat_tap_location",e.props.params.itemId),e.setState({openLocation:!e.state.openLocation})},this.onClose=function(){e.setState({openLocation:!1})},this.onSubmit=function(t,a){e.setState({openLocation:!1},function(){e.sendMessage(e.context.intl.messages.appUpgradeChatMsg,e.props.params.userId,e.props.params.itemId,"location",{lat:t,lon:a})})},this.retryConnection=function(){e.setState({showConnecting:!0}),setTimeout(function(){e.setState({showConnecting:!1})},1e3),e.props.offline||e.props.retryConnection()},this.showSystemMsg=function(t){e.sendSystemMsg=t},this.blockUser=function(t){return function(){e.props.offline?e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:"noInternetError"})):e.props.connAvailable?e.props.blockUser(e.props.params.userId,"unblock"===t).then(function(a){"result"===a.type?e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:t+"SuccessMsg"})):e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:t+"ErrorMsg"}))}):e.showInfoMsg((0,l.default)(D.FormattedMessage,{id:t+"ErrorMsg"})),e.toggleBlockDialog()}},this.toggleBlockDialog=function(){e.setState({showBlockPopup:!e.state.showBlockPopup})},this.showBlockInfoDialog=function(){e.state.showBlockPopup||e.setState({showBlockPopup:!0})},this.smsClickHandler=function(){var t=L.default.getUser();e.sendMessage(e.context.intl.formatMessage(F.getString(e.context.intl.messages.smsDefaultMsg,"smsDefaultMsg"),{name:t&&t.name?t.name:e.getDefaultUserName()}),e.props.params.userId,e.props.params.itemId,"sms"),e.context.track("item_chat_tap_sms",{select_from:"conversation"}),e.context.track("item_tap_sms",{select_from:"chat"})},this.callClickHandler=function(){var t=L.default.getUser();e.sendMessage(e.context.intl.formatMessage(F.getString(e.context.intl.messages.callDefaultMsg,"callDefaultMsg"),{name:t&&t.name?t.name:e.getDefaultUserName()}),e.props.params.userId,e.props.params.itemId,"call")},this.getDefaultUserName=function(){return(0,l.default)(D.FormattedMessage,{id:"defaultUserNameChat",values:e.brand})},this.toggleDeletePopup=function(){e.setState({showDeletePopup:!e.state.showDeletePopup})},this.deleteChat=function(){var t=e.props.params,a=t.userId,s=t.itemId;e.props.deleteUsersChat([{userId:a,itemId:s}]),e.toggleDeletePopup()},this.actionTriggered=function(){e.props.deleteOption&&e.props.hideDeleteOption()},this.toggleFirstTimeUserTips=function(t){t="string"==typeof t?t:"chat",e.setState({showTips:!e.state.showTips,initiationPoint:t},function(){e.state.showFlagIconInMenu&&e.setState({showFlagIconInMenu:!1},function(){e.state.showFlagIconInMenu||e.onUpdate()})})},this.toggleReportModal=function(){e.setState({openReportModal:!e.state.openReportModal},function(){e.state.openReportModal&&e.context.track("trust_tap_report_user_start",{user_affected:e.props.params.userId})})}},oe=t.mapStateToProps=function(e,t){var a=e.chat&&e.chat.threadMessages&&e.chat.threadMessages[t.params.userId+"_"+t.params.itemId]||[];return a.sort(function(e,t){return e.date-t.date}),{user:e.users.elements[t.params.userId],itemsCollection:e.items.elements,isFetchingItem:function(t){return e.items.isFetching[t]},trackFilters:e.track.filters,trackFiltersMetadata:e.track.filtersMetadata,trackOrigin:e.track.origin,intervention:e.interventions&&e.interventions[t.params.userId+"_"+t.params.itemId],messages:a,interventionMsg:e.sendIntervention,imagesData:e.chatImagesData||{},chatServiceStatus:e.chatServiceStatus,configData:e.config&&e.config.collections[I.urls.getConfig]}},ie=t.mapDispatchToProps=function(e,t){return{getItem:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return e((0,B.get)(f.urls.getItem(t),"ELEMENT_ITEMS")).then(function(e){return a(e)})},getUser:function(){return e((0,B.get)(h.urls.getExistingUser(t.conversation.userId),"ELEMENT_USERS"))},onInterventionClick:function(t,a){return e((0,V.onInterventionClick)(t,a))},saveImagesData:function(t){return e((0,V.updateImagesData)(t))},setToastMessageState:function(t){return e((0,J.default)(t))}}};t.ChatThreadComponent=se,t.default=(0,x.compose)(Z.default,(0,U.connect)(oe,ie))(se)},2056:function(e,t,a){"use strict";t.__esModule=!0;var s=f(a(24)),n=f(a(13)),o=f(a(20)),i=f(a(21)),r=f(a(1)),d=f(a(0)),l=f(a(1051)),u=f(a(241)),c=f(a(2057)),p=f(a(2058));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(a){(0,n.default)(this,t);var s=(0,o.default)(this,e.call(this,a));return s.bindings={close:s.close.bind(s)},s}return(0,i.default)(t,e),t.prototype.close=function(){this.props.onClose()},t.prototype.render=function(){var e=this.props,t=e.bucketSize,a=e.lat,n=e.lng,o=e.onSubmit,i=e.country,r=e.onAfterChangeSlider,d=e.trackLocationInput,f=e.countryString,h=e.submitButtonText;return(0,s.default)(u.default,{isOpened:this.props.isOpened,overlayClassName:c.default.overlay,contentClassName:c.default.modal,onClose:this.bindings.close},void 0,(0,s.default)("header",{className:c.default.header},void 0,(0,s.default)("h3",{className:c.default.title},void 0,this.props.title),(0,s.default)(l.default,{icon:"icon-Cross",name:"Close",className:c.default.close,onClick:this.bindings.close})),(0,s.default)(p.default,{bucketSize:t,lat:a,lng:n,onSubmit:o,country:i,onAfterChangeSlider:r,trackLocationInput:d,countryString:f,buttonText:h}))},t}(d.default.Component);h.propTypes={isOpened:r.default.bool.isRequired,title:r.default.oneOfType([r.default.string,r.default.element]),bucketSize:r.default.number,lat:r.default.number.isRequired,lng:r.default.number.isRequired,onClose:r.default.func,onSubmit:r.default.func,trackLocationInput:r.default.func,country:r.default.string,countryString:r.default.string,onAfterChangeSlider:r.default.func,submitButtonText:r.default.oneOfType([r.default.string,r.default.element])},h.defaultProps={title:"Location",onClose:function(){}},t.default=h},2057:function(e,t,a){e.exports={overlay:"_3ZB-j",modal:"_2Gz-T",header:"_2uLM6",title:"_1mM1Q",close:"_3kzk5"}},2058:function(e,t,a){"use strict";t.__esModule=!0;var s=h(a(24)),n=h(a(13)),o=h(a(20)),i=h(a(21)),r=h(a(1)),d=h(a(0)),l=h(a(165)),u=h(a(2059)),c=h(a(2060)),p=h(a(2061)),f=a(64);function h(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(a){(0,n.default)(this,t);var i=(0,o.default)(this,e.call(this,a));return i.bindings={submit:i.submit.bind(i),onChange:i.onChange.bind(i)},i.translations={allCountry:(0,s.default)(f.FormattedMessage,{id:"all-country"}),sliderBucketSize:function(e){return(0,s.default)(f.FormattedMessage,{id:"slider-bucket-size",values:e})}},i}return(0,i.default)(t,e),t.prototype.componentWillMount=function(){this.coordinates={lat:this.props.lat,lng:this.props.lng}},t.prototype.componentWillReceiveProps=function(e){e.bucketSize===this.props.bucketSize&&(this.coordinates={lat:e.lat,lng:e.lng})},t.prototype.onChange=function(e,t){this.coordinates={lat:e,lng:t}},t.prototype.submit=function(){this.props.onSubmit(this.coordinates.lat,this.coordinates.lng)},t.prototype.getSliderOptions=function(){var e,t=this,a={tooltipStyle:{zIndex:999},maxValue:505,minValue:1,step:5,defaultValue:this.props.bucketSize},s=function(e){return t.translations.sliderBucketSize({bucketSize:e})},n=function(){return t.translations.allCountry};return a.tooltipMarks=((e={})[a.minValue]=s(a.minValue),e[a.maxValue]=n(),e),a.getValueFromStep=function(e,t,a){return e===a?1:(a-t)/t+2},a.getValueStepped=function(e,t,a){return 1===a?e:(a-2)*t+t},a.tipFormatter=function(e){return e===a.maxValue?n():s(e)},a},t.prototype.renderSubmitButton=function(){var e=(0,s.default)(l.default,{type:"btnMain",className:c.default.submit,onClick:this.bindings.submit},void 0,this.props.buttonText);return this.props.bucketSize?(0,s.default)("div",{className:c.default.buttonWrapper},void 0,e):e},t.prototype.render=function(){var e=this.props.bucketSize?c.default.footerWithSlider:c.default.footer,t=c.default.map+" "+(this.props.bucketSize?c.default.mapWithSlider:""),a=this.props.bucketSize&&this.getSliderOptions(),n=this.renderSubmitButton();return(0,s.default)("div",{className:c.default.wrapper},void 0,(0,s.default)(u.default,{className:t,latitude:this.coordinates.lat,longitude:this.coordinates.lng,onChange:this.bindings.onChange,autocompleteClassName:c.default.autocomplete,trackLocationInput:this.props.trackLocationInput,country:this.props.country,countryString:this.props.countryString,bucketSize:this.props.bucketSize}),(0,s.default)("footer",{className:e},void 0,this.props.bucketSize&&(0,s.default)("div",{className:c.default.sliderWrapper},void 0,(0,s.default)(p.default,{defaultValue:a.defaultValue,getValueFromStep:a.getValueFromStep,getValueStepped:a.getValueStepped,hasTooltip:!0,marks:a.tooltipMarks,max:a.maxValue,min:a.minValue,onAfterChange:this.props.onAfterChangeSlider,step:a.step,tipFormatter:a.tipFormatter,tooltipStyle:a.tooltipStyle,wrapperClassName:c.default.slider})),n))},t}(d.default.Component);m.propTypes={bucketSize:r.default.number,lat:r.default.number.isRequired,lng:r.default.number.isRequired,onSubmit:r.default.func,trackLocationInput:r.default.func,country:r.default.string,countryString:r.default.string,onAfterChangeSlider:r.default.func,buttonText:r.default.oneOfType([r.default.string,r.default.element])},m.defaultProps={text:"submit",onSubmit:function(){},country:"",trackLocationInput:function(){},countryString:"",bucketSize:null,onAfterChangeSlider:function(){},buttonText:(0,s.default)(f.FormattedMessage,{id:"submitLocation"})},t.default=m},2060:function(e,t,a){e.exports={wrapper:"_3fbH1",map:"_18DWP",autocomplete:"_2fbSt",mapWithSlider:"_2MUb-",footer:"_1mukg",submit:"faMEa",footerWithSlider:"_3fMQu",sliderWrapper:"_3Wmhm",slider:"_20dmI",buttonWrapper:"_1_tHt"}},2061:function(e,t,a){"use strict";t.__esModule=!0;var s=h(a(24)),n=h(a(4)),o=h(a(38)),i=h(a(13)),r=h(a(20)),d=h(a(21));a(2062);var l=h(a(1)),u=h(a(2404)),c=h(a(1555)),p=h(a(0)),f=h(a(2093));function h(e){return e&&e.__esModule?e:{default:e}}var m=u.default.Handle,g=function(e){function t(a){(0,i.default)(this,t);var s=(0,r.default)(this,e.call(this)),n=a.defaultValue||a.value||0;return s.state={tooltipVisible:!1,value:a.getValueFromStep(a.min,a.step,n),valueStepped:n},s.getValueFromStep=a.getValueFromStep.bind(s,a.min,a.step),s.getValueStepped=a.getValueStepped.bind(s,a.min,a.step),s.handleOnAfterChange=s.handleOnAfterChange.bind(s),s.handleOnBeforeChange=s.handleOnBeforeChange.bind(s),s.handleOnChange=s.handleOnChange.bind(s),s.handleWithTooltip=s.handleWithTooltip.bind(s),s}return(0,d.default)(t,e),t.prototype.componentWillReceiveProps=function(e){this.props.value!==e.value&&this.setState({value:this.getValueFromStep(e.value),valueStepped:e.value})},t.prototype.handleOnAfterChange=function(e){this.props.onAfterChange(this.getValueStepped(e))},t.prototype.handleOnBeforeChange=function(e){this.props.onBeforeChange(this.getValueStepped(e))},t.prototype.handleOnChange=function(e){var t=this.getValueStepped(e);this.props.onChange(t),this.setState({value:e,valueStepped:t})},t.prototype.handleTooltipVisibleChange=function(e){this.setState({tooltipVisible:e})},t.prototype.handleWithTooltip=function(e){var t=this,a=e.value,s=e.dragging,i=e.index,r=e.disabled,d=(0,o.default)(e,["value","dragging","index","disabled"]),l=this.props,u=l.tipFormatter,f=l.tipProps,h=l.tooltipStyle,g=f.prefixCls,v=void 0===g?"rc-slider-tooltip":g,I=f.overlay,C=void 0===I?u(this.state.valueStepped):I,M=f.placement,_=void 0===M?"top":M,y=(0,o.default)(f,["prefixCls","overlay","placement"]),S=function(e){return t.handleTooltipVisibleChange.bind(t,e)},w=S(!0),k=S(!1);return p.default.createElement(c.default,(0,n.default)({},y,{prefixCls:v,overlay:C,placement:_,visible:!r&&(this.state.tooltipVisible||s),key:i,overlayStyle:h}),p.default.createElement(m,(0,n.default)({},d,{value:a,onMouseEnter:w,onMouseLeave:k})))},t.prototype.render=function(){var e=this.props,t=e.defaultValue,a=e.dots,n=e.dotStyle,o=e.handleStyle,i=e.marks,r=e.max,d=e.min,l=e.railStyle,c=e.sliderClassName,p=e.hasTooltip,h=e.trackStyle,m=e.wrapperClassName;return(0,s.default)("div",{className:m+" "+f.default.slider},void 0,(0,s.default)(u.default,{className:c+" "+f.default.sliderWrapper,defaultValue:this.getValueFromStep(t),dots:a,dotStyle:n,handle:p?this.handleWithTooltip:void 0,handleStyle:o,max:this.getValueFromStep(r),min:this.getValueFromStep(d),onAfterChange:this.handleOnAfterChange,onBeforeChange:this.handleOnBeforeChange,onChange:this.handleOnChange,railStyle:l,step:1,trackStyle:h,value:this.state.value}),(0,s.default)("div",{className:f.default.marksWrapper},void 0,(0,s.default)("span",{className:f.default.minMark},void 0,i[d]),(0,s.default)("span",{className:f.default.maxMark},void 0,i[r])))},t}(p.default.Component);g.propTypes={defaultValue:l.default.number,dots:l.default.bool,dotStyle:l.default.object,getValueFromStep:l.default.func,getValueStepped:l.default.func,handleStyle:l.default.oneOfType([l.default.array,l.default.object]),hasTooltip:l.default.bool,marks:l.default.object,max:l.default.number,min:l.default.number,onAfterChange:l.default.func,onBeforeChange:l.default.func,onChange:l.default.func,railStyle:l.default.object,sliderClassName:l.default.string,step:l.default.number,tipFormatter:l.default.func,tipProps:l.default.object,tooltipStyle:l.default.object,trackStyle:l.default.object,value:l.default.number,wrapperClassName:l.default.string},g.defaultProps={defaultValue:0,dots:!1,dotStyle:{},getValueFromStep:function(e,t,a){return(a-e)/t+1},getValueStepped:function(e,t,a){return(a-1)*t+e},handleStyle:[{}],hasTooltip:!1,marks:{},max:100,min:0,onAfterChange:function(){},onBeforeChange:function(){},onChange:function(){},railStyle:{},sliderClassName:"",step:1,tipFormatter:function(e){return e},tipProps:{},tooltipStyle:{},trackStyle:{},value:0,wrapperClassName:""},t.default=g},2062:function(e,t,a){e.exports={rcSliderTooltipZoomDownIn:"_3aj2Y",rcSliderTooltipZoomDownOut:"_2ngl0"}},2093:function(e,t,a){e.exports={slider:"pPN_-",sliderWrapper:"_2yTVw",marksWrapper:"_5QSh0",minMark:"_1SeFp",maxMark:"_1F9vP"}},2094:function(e,t,a){"use strict";t.__esModule=!0;var s=x(a(24)),n=x(a(32)),o=x(a(14)),i=x(a(13)),r=x(a(20)),d=x(a(21)),l=x(a(2095)),u=x(a(2096)),c=x(a(2097)),p=x(a(2098)),f=x(a(2099)),h=x(a(2100)),m=x(a(2101)),g=x(a(2102)),v=x(a(2103)),I=x(a(1207)),C=x(a(1049)),M=x(a(1051)),_=x(a(238)),y=x(a(346)),S=x(a(1)),w=x(a(0)),k=x(a(1079)),b=x(a(37)),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(1061)),N=a(1056);function x(e){return e&&e.__esModule?e:{default:e}}var D=y.default.icons,P=function(e){function t(){(0,i.default)(this,t);var a=(0,r.default)(this,e.call(this));return a.onAudioMessagePlayed=function(e,t){if(void 0!==a.state.audioList){var s={};s[e]=t,a.setState({audioList:s})}},a.retryImage=function(e){return function(){a.props.actionTriggered(),a.props.sendImage(e,a.props.previewImgObj[e].file,!1)}},a.toggleImg=function(e){return function(){e?(a.props.actionTriggered(),a.setState({fullScreen:!a.state.fullScreen,image:[{src:[e]}]}),a.props.track("item_chat_open_image",a.props.itemId)):a.setState({fullScreen:!a.state.fullScreen})}},a.track=function(e,t){var s=a.props.itemId?{item_id:a.props.itemId}:{};a.context.track(e,(0,o.default)(s,t))},a.openLocation=function(){a.props.actionTriggered(),a.props.track("item_chat_open_location",a.props.itemId)},a.sendSystemMsgTracking=function(e,t){a.props.track(e,a.props.itemId,t)},a.state={fullScreen:!1,didRefresh:!1,audioList:{}},a.messageRef={},a.onKeyboardOpen=a.onKeyboardOpen.bind(a),a}return(0,d.default)(t,e),t.prototype.componentWillMount=function(){"undefined"!=typeof window&&(this.totalHeight=window.innerHeight,window.addEventListener("resize",this.onKeyboardOpen,!1))},t.prototype.componentDidMount=function(){var e=this;(0,n.default)(this.messageRef).length?this.scrollToMessage():this.focus?this.scrollUnreadToastIntoView(this.focus):this.scrollToBottom(),setTimeout(function(){e.setState({didRefresh:!0})},3e3)},t.prototype.componentWillUpdate=function(e){this.props.userId!==e.userId||this.props.messages.length!==e.messages.length||(0,n.default)(this.props.previewImgObj).length!==(0,n.default)(e.previewImgObj).length||this.props.readMessageCount===e.readMessageCount&&-1!==this.props.readMessageCount&&null!==this.props.readMessageCount?this.shouldScrollToBottom=!0:this.shouldScrollToBottom=!1},t.prototype.componentDidUpdate=function(){this.shouldScrollToBottom&&this.unreadToast?this.scrollUnreadToastIntoView(this.unreadToast):this.shouldScrollToBottom&&this.scrollToBottom()},t.prototype.componentWillUnmount=function(){"undefined"!=typeof window&&window.removeEventListener("resize",this.onKeyboardOpen,!1)},t.prototype.onKeyboardOpen=function(){this.totalHeight>window.innerHeight&&this.scrollToBottom()},t.prototype.scrollToBottom=function(){this.messagesEnd&&this.messagesEnd.scrollIntoView()},t.prototype.scrollToMessage=function(){var e=this.props.focusMessage;if(e&&e.msg.id){var t=this.messageRef[e.msg.id];this.context.config.get("breakpoint")<=window.screen.availWidth?this.messageListEl.scrollTop=t.offsetTop-60-10:this.messageListEl.scrollTop=t.offsetTop-10}},t.prototype.scrollUnreadToastIntoView=function(e){this.context.config.get("breakpoint")<=window.screen.availWidth?this.messageListEl.scrollTop=e.offsetTop-60-10:this.messageListEl.scrollTop=e.offsetTop-10},t.prototype.showMessageStatus=function(e,t){return e.displayed?(0,s.default)("span",{className:D.panameraIcons+" "+k.default.msgIcons+" "+k.default.displayed+" "+D["icon-DoubleCheckRead"]}):e.received?(0,s.default)("span",{className:D.panameraIcons+" "+k.default.msgIcons+" "+(t?k.default.notDisplayedFeature:k.default.notDisplayed)+" "+D["icon-DoubleCheckRead"]}):(0,s.default)("span",{className:D.panameraIcons+" "+k.default.msgIcons+" "+(t?k.default.notDisplayedFeature:k.default.notDisplayed)+" "+D["icon-OK"]})},t.prototype.isOutboundMessage=function(e){return b.default.getUser()&&b.default.getUser().id==e},t.prototype.showImagePreview=function(){var e=this,t=this.props.previewImgObj;return t&&(0,n.default)(t).length?(0,n.default)(t).map(function(a,n){var i=(0,o.default)({},t[a]);return(0,s.default)("div",{className:k.default.msgContainer},n,(0,s.default)("div",{className:k.default.shareMsgContainer+" "+k.default.sentMsg},void 0,(0,s.default)("div",{className:k.default.loadingContainer},void 0,"uploading"===i.status&&(0,s.default)(_.default,{containerSize:"32px",className:k.default.icon+" "+k.default.loader}),"error"===i.status&&(0,s.default)("span",{className:k.default.icon+" "+D.panameraIcons+" "+D["icon-Refresh"],onClick:e.retryImage(a)})),(0,s.default)("img",{className:k.default.shareImgMsg+" "+k.default.imagePreview,src:i.imagePreviewUrl})))}):null},t.prototype.showVoiceLoader=function(){for(var e=this.props.previewVoiceMessage,t=[],a=0;a<e;a++){var n=(0,s.default)("div",{className:""+k.default.msgContainer},a,(0,s.default)("div",{className:k.default.voiceMessageContainer+" "+k.default.sentMsg},void 0,(0,s.default)("div",{className:""+k.default.voiceAvatarContainer},void 0,(0,s.default)(C.default,{image:(0,N.getUserImage)(b.default.getUser()),diameter:"40px"}),(0,s.default)(M.default,{icon:"icon-mic",className:k.default.senderVoiceIcon})),(0,s.default)("div",{className:k.default.voiceLoadError},void 0,(0,s.default)("div",{className:k.default.voiceErrorMessage},void 0,(0,s.default)(_.default,{containerSize:"32px",className:k.default.icon+" "+k.default.loader+" "+k.default.sentloaderColor})))));t.push(n)}return(0,s.default)("div",{},void 0,t)},t.prototype.getUnreadCount=function(e,t){return t.slice(e).filter(function(e){var t=e.isMine,a=e.info;return!(t||a)}).length},t.prototype.renderItemBanner=function(e){var t=this,a=this.props.focusMessage,n=a&&"items"===a.type&&e.itemId===a.msg.itemId;return w.default.createElement("div",{ref:function(e){n&&(t.focus=e)}},(0,s.default)(l.default,{itemId:e.itemId,focus:n,automationId:"adBanner"}))},t.prototype.renderMessageList=function(){var e=this;if(!this.props.messages||!this.props.messages.length)return null;var t="",a=void 0,n=void 0,o=void 0,i=void 0,r=this.props.readMessageCount,d=this.getUnreadCount(r,this.props.messages),l=this.context.config.get("breakpoint")<=window.screen.availWidth,I={};return this.props.messages.map(function(C,M){var _=T.daysUntilNow(C.date),y=o!==_,S=i!==C.from||o!==_,N=null!==r&&r===M&&d>0,x=void 0;if(o=_,i=C.from,C.ref&&(I[C.id]=!0),t===C.itemId?a=!1:(a=!0,C.info||(t=C.itemId),M&&(e.props.showSystemMsg(!1),e.sendSystemMsg=!1)),n=e.isOutboundMessage(C.from),C.info)return null;if(C.image&&e.props.chatConfig.imgData.enableImgFeature)e.props.previewImgObj[C.image.url]&&e.props.removeKey(C.image.url),x=(0,s.default)(p.default,{handleClick:e.toggleImg(C.image.url),message:C,isMine:n,showMessageStatus:e.showMessageStatus});else if(C.voice&&e.props.chatConfig.voiceData.enableVoicePlayback)x=(0,s.default)(m.default,{message:C,isMine:n,showMessageStatus:e.showMessageStatus,user:e.props.user,onAudioMessagePlayed:e.onAudioMessagePlayed,isPlaying:e.state.audioList[C.id],track:e.track,currentUser:b.default.getUser()});else if(C.location)x=(0,s.default)(f.default,{message:C,isMine:n,showMessageStatus:e.showMessageStatus,openLocation:e.openLocation});else if(C.sms)x=e.props.chatConfig.showSmsHistory&&e.props.userName?(0,s.default)(g.default,{type:"sms",isMine:C.isMine,userName:e.props.userName,timeStamp:C.date}):null;else if(C.call)x=e.props.chatConfig.showCallHistory&&e.props.userName?(0,s.default)(g.default,{type:"call",isMine:C.isMine,userName:e.props.userName,timeStamp:C.date}):null;else if(C.system)x=(0,s.default)(v.default,{message:C,sendTracking:e.sendSystemMsgTracking,onShowTips:e.props.toggleFirstTimeUserTips,config:e.props.config});else{var D=e.props.focusMessage,P=D&&"messages"===D.type&&C.id===D.msg.id;x=w.default.createElement("div",{className:!e.state.didRefresh&&P?k.default.popup:"",ref:function(t){P&&(e.messageRef[C.id]=t)}},(0,s.default)(h.default,{message:C,isMine:n,showMessageStatus:e.showMessageStatus,showArrow:S}))}return(0,s.default)("div",{className:k.default.msgContainer+" "+(x?"":k.default.noMsgPadding)},M,y&&(0,s.default)(u.default,{timeStamp:C.date}),a&&e.renderItemBanner(C),N&&w.default.createElement("div",{ref:function(t){e.unreadToast=t}},(0,s.default)(c.default,{unreadCount:d,desktopView:l})),x)})},t.prototype.render=function(){var e=this;return w.default.createElement("div",{className:k.default.chatContainer,ref:function(t){e.messageListEl=t}},this.renderMessageList(),(!this.props.messages||!this.props.messages.length)&&this.props.itemId&&(0,s.default)(l.default,{itemId:this.props.itemId,automationId:"adBanner"}),this.showImagePreview(),this.showVoiceLoader(),this.state.fullScreen&&(0,s.default)(I.default,{images:this.state.image,toggleFullScreen:this.toggleImg(!1)}),w.default.createElement("div",{className:""+(this.props.interventionBox?k.default.increasedSroller:k.default.chatScroller),ref:function(t){return e.messagesEnd=t}}))},t}(w.default.Component);P.contextTypes={config:S.default.object,track:S.default.func},P.propTypes={messages:S.default.array,previewImgObj:S.default.object,previewVoiceMessage:S.default.number,itemId:S.default.string,userId:S.default.string,user:S.default.object,sendImage:S.default.func,showSystemMsg:S.default.func,track:S.default.func,chatConfig:S.default.object,actionTriggered:S.default.func,removeKey:S.default.func,readMessageCount:S.default.number,userName:S.default.string,interventionBox:S.default.bool,toggleFirstTimeUserTips:S.default.func,focusMessage:S.default.oneOfType([S.default.object,S.default.bool]),config:S.default.object},P.defaultProps={messages:[],previewImgObj:{},config:{},readMessageCount:null,interventionBox:!1},t.default=P},2095:function(e,t,a){"use strict";t.__esModule=!0;var s=g(a(24)),n=g(a(13)),o=g(a(20)),i=g(a(21)),r=g(a(1)),d=g(a(0)),l=a(44),u=a(54),c=g(a(1049)),p=g(a(129)),f=g(a(1514)),h=a(239),m=a(10);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(){(0,n.default)(this,t);var a=(0,o.default)(this,e.call(this));return a.styles={avatar:{margin:"auto"}},a}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){"undefined"==typeof window||this.props.item||this.props.isFetchingItem(this.props.itemId)||this.props.getItem()},t.prototype.render=function(){var e=this.props,t=e.item,a=e.automationId;return t?(0,s.default)("div",{"data-aut-id":a,className:f.default.itemBanner},void 0,(0,s.default)(p.default,{to:(0,m.getItemUrl)(t.id,t.title),className:f.default.adContainer},void 0,(0,s.default)("div",{className:f.default.adImg},void 0,(0,s.default)(c.default,{image:t.images&&t.images.length&&t.images[0].small?t.images[0].small.url:"",diameter:"57px",style:this.styles.avatar})),(0,s.default)("div",{className:f.default.adInfo},void 0,(0,s.default)("div",{className:f.default.adTitle},void 0,t.title),(0,s.default)("div",{},void 0,t.price?t.price.value.display:"")))):null},t}(d.default.Component);v.propTypes={item:r.default.object,getItem:r.default.func,isFetchingItem:r.default.func,itemId:r.default.string,automationId:r.default.string};t.default=(0,l.connect)(function(e,t){return{item:e.items.elements[t.itemId],isFetchingItem:function(t){return e.items.isFetching[t]}}},function(e,t){return{getItem:function(){return e((0,u.get)(h.urls.getItem(t.itemId),"ELEMENT_ITEMS"))}}})(v)},2096:function(e,t,a){"use strict";t.__esModule=!0;var s=d(a(24)),n=(d(a(0)),d(a(1))),o=a(64),i=d(a(1079)),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(1061));function d(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.timeStamp;return(0,s.default)("div",{className:i.default.toastContainer},void 0,(0,s.default)("span",{className:i.default.toastWrapper},void 0,(0,s.default)("span",{className:i.default.toastText+" "+i.default.timeToast},void 0,function(){var e=r.daysUntilNow(t);return 0===e?(0,s.default)(o.FormattedMessage,{id:"today"}):1===e?(0,s.default)(o.FormattedMessage,{id:"yesterday"}):r.formatDate(new Date(t),"Day, DD Month")}())))};l.propTypes={timeStamp:n.default.number.isRequired},t.default=l},2097:function(e,t,a){"use strict";t.__esModule=!0;var s=r(a(24)),n=(r(a(0)),r(a(1))),o=a(64),i=r(a(1079));function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){var t=e.unreadCount,a=e.desktopView,n={unreadCount:t},r=t>1?(0,s.default)(o.FormattedMessage,{id:"unreadMessages",values:n}):(0,s.default)(o.FormattedMessage,{id:"unreadMessage",values:n});return(0,s.default)("div",{className:i.default.toastContainer+" "+i.default.unreadToastContainer+" "+(a?i.default.desktopUnreadToast:"")},void 0,(0,s.default)("span",{className:i.default.toastWrapper+" "+i.default.unreadMsgToastWrapper},void 0,(0,s.default)("span",{className:i.default.toastText+" "+i.default.unreadMsgToastText},void 0,r)))};d.propTypes={unreadCount:n.default.number.isRequired,desktopView:n.default.bool},t.default=d},2098:function(e,t,a){"use strict";t.__esModule=!0;var s=r(a(24)),n=(r(a(0)),r(a(1))),o=a(64),i=r(a(1079));function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){return(0,s.default)("div",{"data-aut-id":"imgMsg",className:i.default.shareMsgContainer+" "+(e.isMine?i.default.sentMsg:i.default.recievedMsg),onClick:e.handleClick},void 0,(0,s.default)("img",{className:i.default.shareImgMsg,src:e.message.image.url}),(0,s.default)("div",{className:i.default.timeBox},void 0,(0,s.default)("div",{className:i.default.time},void 0,(0,s.default)("span",{className:i.default.chatDate},void 0,(0,s.default)(o.FormattedTime,{value:new Date(e.message.date),hour12:!1})),e.isMine&&e.showMessageStatus(e.message,!0))))};d.propTypes={message:n.default.object.isRequired,isMine:n.default.bool.isRequired,showMessageStatus:n.default.func.isRequired,handleClick:n.default.func.isRequired},t.default=d},2099:function(e,t,a){"use strict";t.__esModule=!0;var s=d(a(24)),n=(d(a(0)),d(a(1))),o=a(64),i=d(a(1171)),r=d(a(1079));function d(e){return e&&e.__esModule?e:{default:e}}var l=function(e){return(0,s.default)("div",{"data-aut-id":"locMsg",className:r.default.shareMsgContainer+"  "+r.default.shareLocMsg+" "+(e.isMine?r.default.sentMsg:r.default.recievedMsg),onClick:e.openLocation},void 0,(0,s.default)(i.default,{latitude:String(e.message.location.lat),longitude:String(e.message.location.lon),hrefToGoogle:!0,size:"150x150",markers:"size:mid|color:red|label:A|"+e.message.location.lat+","+e.message.location.lon}),(0,s.default)("div",{className:r.default.timeBox},void 0,(0,s.default)("div",{className:r.default.time},void 0,(0,s.default)("span",{className:r.default.chatDate},void 0,(0,s.default)(o.FormattedTime,{value:new Date(e.message.date),hour12:!1})),e.isMine&&e.showMessageStatus(e.message,!0))))};l.propTypes={message:n.default.object.isRequired,isMine:n.default.bool.isRequired,showMessageStatus:n.default.func.isRequired,openLocation:n.default.func.isRequired},t.default=l},2100:function(e,t,a){"use strict";t.__esModule=!0;var s=r(a(24)),n=r(a(1)),o=(r(a(0)),a(64)),i=r(a(1079));function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){var t=void 0;return t=e.isMine?e.showArrow?i.default.chatMsg+" "+i.default.sentMsg+" "+i.default.msgArrow+" "+i.default.sentArrow:i.default.chatMsg+" "+i.default.sentMsg:e.showArrow?i.default.chatMsg+" "+i.default.recievedMsg+" "+i.default.msgArrow+" "+i.default.recievedArrow:i.default.chatMsg+" "+i.default.recievedMsg,(0,s.default)("pre",{"data-aut-id":"textMsg",className:t},void 0,e.message.body,(0,s.default)("div",{className:i.default.dateContainer},void 0,(0,s.default)("span",{className:i.default.chatDate},void 0,(0,s.default)(o.FormattedTime,{value:new Date(e.message.date),hour12:!1})),e.isMine&&e.showMessageStatus(e.message)))};d.propTypes={message:n.default.object.isRequired,isMine:n.default.bool.isRequired,showMessageStatus:n.default.func.isRequired,showArrow:n.default.bool.isRequired},t.default=d},2101:function(e,t,a){"use strict";t.__esModule=!0;var s=g(a(24)),n=g(a(13)),o=g(a(20)),i=g(a(21)),r=g(a(1049)),d=g(a(1051)),l=g(a(238)),u=g(a(1)),c=g(a(0)),p=g(a(237)),f=g(a(1079)),h=a(64),m=a(1056);function g(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(a){(0,n.default)(this,t);var s=(0,o.default)(this,e.call(this,a));return s.rerunSlider=function(e){s.getAudioNode().currentTime=parseInt(e.target.value,10)},s.onTimeUpdate=function(e){s.setState({playingTime:Math.round(e.target.currentTime)})},s.onMessageEnded=function(){s.setState({playingTime:0}),s.props.onAudioMessagePlayed(s.props.message.id,!1)},s.onErrorLoading=function(e){s.setState({hasError:!0}),s.props.track("item_chat_voice_download_error",{select_from:s.props.isMine?"sender":"receiver",reason:e.message,resultset_id:s.props.message.id})},s.setDuration=function(e){s.state.duration||s.setState({duration:Math.round(e.target.duration)})},s.playAudio=function(){var e=s.getAudioNode();s.props.onAudioMessagePlayed(s.props.message.id,e&&e.paused)},s.audio=void 0,s.state={duration:0,playingTime:0,hasError:!1},s}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){var e=this.getAudioNode();e&&(e.addEventListener("loadeddata",this.setDuration),e.addEventListener("loadedmetadata",this.setDuration),e.addEventListener("timeupdate",this.onTimeUpdate),e.addEventListener("ended",this.onMessageEnded),e.addEventListener("error",this.onErrorLoading),e.load())},t.prototype.componentWillUpdate=function(e){if(this.props.isPlaying!==e.isPlaying){var t=this.getAudioNode();e.isPlaying?(t&&0===t.currentTime&&this.props.track("item_chat_tap_voice_play",{select_from:this.props.isMine?"sender":"receiver",result_count:t.duration,resultset_id:this.props.message.id}),t&&t.play()):t&&t.pause()}},t.prototype.componentWillUnmount=function(){var e=this.getAudioNode();e&&(e.removeEventListener("loadeddata",this.setDuration),e.removeEventListener("loadedmetadata",this.setDuration),e.removeEventListener("timeupdate",this.onTimeUpdate),e.removeEventListener("ended",this.onMessageEnded),e.removeEventListener("error",this.onErrorLoading))},t.prototype.getAudioNode=function(){return p.default.findDOMNode(this.audio)},t.prototype.secondsToTimer=function(e){for(var t=0,a=e,s="",n="";a>60;)a-=60*(t=parseInt(a/60,10));return s=t<10?"0".concat(t.toString()):t.toString(),n=a<10?"0".concat(a.toString()):a,s.concat(":").concat(n)},t.prototype.render=function(){var e=this,t=null,a=null,n=null;return this.props.isMine?(t=(0,s.default)(r.default,{image:(0,m.getUserImage)(this.props.currentUser),diameter:"40px"}),a=(0,s.default)(d.default,{icon:"icon-mic",className:f.default.senderVoiceIcon})):(t=(0,s.default)(r.default,{image:(0,m.getUserImage)(this.props.user),diameter:"40px"}),a=(0,s.default)(d.default,{icon:"icon-mic",className:f.default.recieverVoiceIcon})),n=this.state.duration?(0,s.default)("div",{className:f.default.voiceMessagePlayer},void 0,(0,s.default)(d.default,{icon:this.props.isPlaying?"icon-pause":"icon-play",name:"play-pause",className:f.default.playButton,onClick:this.playAudio}),(0,s.default)("div",{},void 0,(0,s.default)("div",{className:f.default.sliderContainer},void 0,(0,s.default)("span",{className:f.default.filledSlider,style:{width:parseInt(100*this.state.playingTime/this.state.duration,10).toString().concat("%")}}),(0,s.default)("input",{type:"range",min:"0",max:this.state.duration,value:this.state.playingTime,className:f.default.slider+" "+f.default.playingSlider,onChange:this.rerunSlider,onInput:this.rerunSlider})),(0,s.default)("div",{className:f.default.dataContainer},void 0,(0,s.default)("div",{className:f.default.durationContainer},void 0,this.props.isPlaying?this.secondsToTimer(this.state.playingTime):this.secondsToTimer(this.state.duration)),(0,s.default)("div",{className:f.default.dateContainer},void 0,(0,s.default)("div",{className:f.default.time},void 0,(0,s.default)("span",{className:f.default.chatDate},void 0,(0,s.default)(h.FormattedTime,{value:new Date(this.props.message.date),hour12:!1})),this.props.isMine&&this.props.showMessageStatus(this.props.message)))))):this.state.hasError?(0,s.default)("div",{className:f.default.voiceLoadError},void 0,(0,s.default)("div",{className:f.default.voiceErrorMessage},void 0,(0,s.default)(h.FormattedMessage,{id:"voiceLoadError"}))):(0,s.default)("div",{className:f.default.voiceLoadError},void 0,(0,s.default)("div",{className:f.default.voiceErrorMessage},void 0,(0,s.default)(l.default,{containerSize:"32px",className:f.default.icon+" "+f.default.loader+" "+(this.props.isMine?f.default.sentloaderColor:f.default.recievedloaderColor)}))),(0,s.default)("div",{"data-aut-id":"voiceMsg",className:f.default.voiceMessageContainer+" "+(this.props.isMine?f.default.sentMsg:f.default.recievedMsg)},void 0,(0,s.default)("div",{className:""+f.default.voiceAvatarContainer},void 0,t,a),c.default.createElement("audio",{ref:function(t){e.audio=t},src:this.props.message.voice.url,preload:"auto"}),n)},t}(c.default.Component);v.propTypes={message:u.default.object.isRequired,isMine:u.default.bool.isRequired,showMessageStatus:u.default.func.isRequired,user:u.default.object,currentUser:u.default.object,onAudioMessagePlayed:u.default.func,isPlaying:u.default.bool,track:u.default.func},v.defaultProps={isPlaying:!1},t.default=v},2102:function(e,t,a){"use strict";t.__esModule=!0;var s=d(a(24)),n=d(a(346)),o=d(a(1)),i=(d(a(0)),a(64)),r=d(a(1079));function d(e){return e&&e.__esModule?e:{default:e}}var l=n.default.icons,u=function(e){var t=e.type,a=e.isMine,n=e.userName,o=e.timeStamp,d=void 0,u={userName:n};return d=a?(0,s.default)(i.FormattedMessage,{id:"call"===t?"userOwnCallMessage":"userOwnSmsMessage",values:u}):(0,s.default)(i.FormattedMessage,{id:"call"===t?"callMessage":"smsMessage",values:u}),(0,s.default)("div",{className:r.default.toastContainer+" "+r.default.smsCalltoast},void 0,(0,s.default)("span",{className:r.default.toastWrapper},void 0,(0,s.default)("span",{className:l.panameraIcons+" "+("sms"===t?l["icon-SMS"]:l["icon-PhoneProfile"]+" "+r.default.phoneIcon)+" "+r.default.toastIcon}),(0,s.default)("span",{className:r.default.toastText},void 0,d,(0,s.default)(i.FormattedTime,{value:new Date(o),hour12:!0}))))};u.propTypes={type:o.default.string.isRequired,isMine:o.default.bool,userName:o.default.string,timeStamp:o.default.number},t.default=u},2103:function(e,t,a){"use strict";t.__esModule=!0;var s=u(a(24)),n=u(a(14)),o=u(a(1)),i=(u(a(0)),u(a(2104))),r=u(a(2106)),d=u(a(2108)),l=u(a(2110));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){var t=null,a=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={result_set_format:e.message.system.layout,resultset_type:e.message.system.subType,interv_msg_id:e.message.id};e.sendTracking(t,(0,n.default)(a,s))};switch(e.message.system.layout){case"layout_email":t=(0,s.default)(i.default,{message:e.message,track:a,config:e.config});break;case"layout_safety_tip":t=(0,s.default)(r.default,{title:e.message.system.title,subtitle:e.message.system.subtitle,onShowTips:e.onShowTips,actionLabel:e.message.system.actionLabel,track:a});break;case"layout_item_deeplink":t=(0,s.default)(l.default,{itemId:e.message.itemId,message:e.message.system});break;default:t="true"===e.message.system.useDefault?(0,s.default)(d.default,{message:e.message}):null}return t};c.propTypes={message:o.default.object.isRequired,sendTracking:o.default.func.isRequired,config:o.default.object},t.default=c},2104:function(e,t,a){"use strict";t.__esModule=!0;var s=r(a(24)),n=r(a(1)),o=(r(a(0)),r(a(2105))),i=r(a(1049));function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){var t=e.message,a=e.track,n=e.config,r=(0,s.default)("div",{className:o.default.contactSection},void 0,(0,s.default)("a",{onClick:function(){a("system_msg_tap_contact")},target:"_blank",rel:"noopener noreferrer",href:n&&n.location?n.location.country.zendesk_url:"/"},void 0,t.system.actionLabel));return(0,s.default)("div",{className:o.default.fraudWarningCard},void 0,(0,s.default)("div",{className:o.default.mainCard},void 0,(0,s.default)("div",{className:o.default.warningTextSec},void 0,(0,s.default)("div",{className:o.default.imgSection},void 0,(0,s.default)(i.default,{image:t.system.icon||"",diameter:"60px",style:{avatar:{margin:"auto"}}})),(0,s.default)("div",{className:o.default.txtSection},void 0,(0,s.default)("p",{className:o.default.heading1},void 0,t.system.title),(0,s.default)("p",{className:o.default.heading2},void 0,t.system.subtitle))),r))};d.propTypes={message:n.default.object.isRequired,track:n.default.func.isRequired,config:n.default.object},t.default=d},2105:function(e,t,a){e.exports={fraudWarningCard:"f6n4x",mainCard:"_39eOY",warningTextSec:"SwNkQ",heading1:"_2kpwN",heading2:"_37ldO",imgSection:"_1FquF",txtSection:"_1OP6d",infoTextSec:"_3AL8j",contactSection:"_3RkMe",feedbackSection:"_2k-Ti"}},2106:function(e,t,a){"use strict";t.__esModule=!0;var s=d(a(24)),n=d(a(1)),o=(d(a(0)),d(a(2107))),i=d(a(1049)),r=d(a(1301));function d(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=e.title,a=e.subtitle,n=e.actionLabel,d=e.onShowTips,l=e.track;return(0,s.default)("div",{className:o.default.contextualTipsContainer,onClick:function(){d("contextualTip"),l("system_msg_tap_safety_tip",{reason:a})}},void 0,(0,s.default)("div",{className:o.default.tipsIcon},void 0,(0,s.default)(i.default,{diameter:"40px",image:r.default,className:o.default.tipsImage})),(0,s.default)("div",{className:o.default.tipsText},void 0,(0,s.default)("div",{className:o.default.tipsTitle},void 0,t),(0,s.default)("div",{className:o.default.tipsDescription},void 0,a),(0,s.default)("div",{className:o.default.tipsBtn},void 0,n)))};l.propTypes={title:n.default.string.isRequired,subtitle:n.default.string.isRequired,actionLabel:n.default.string.isRequired,onShowTips:n.default.func.isRequired,track:n.default.func.isRequired},t.default=l},2107:function(e,t,a){e.exports={contextualTipsContainer:"Uqk4R",tipsIcon:"_23RnM",tipsImage:"n9p77",tipsText:"_3kyfc",tipsTitle:"k2xqa",tipsDescription:"_2GoZG",tipsBtn:"_3W7LU"}},2108:function(e,t,a){"use strict";t.__esModule=!0;var s=r(a(24)),n=r(a(1)),o=(r(a(0)),r(a(2109))),i=r(a(1049));function r(e){return e&&e.__esModule?e:{default:e}}var d=function(e){var t=e.message&&e.message.system;return(0,s.default)("div",{className:o.default.mainCard},void 0,(0,s.default)("div",{className:o.default.warningTextSec},void 0,t&&t.icon&&(0,s.default)("div",{className:o.default.imgSection},void 0,(0,s.default)(i.default,{image:t.icon||"",diameter:"45px",style:{avatar:{margin:"auto"}}})),(0,s.default)("div",{className:o.default.txtSection},void 0,(0,s.default)("p",{className:o.default.heading1},void 0,t.title),(0,s.default)("p",{className:o.default.heading2},void 0,t.subtitle))))};d.propTypes={message:n.default.object.isRequired},t.default=d},2109:function(e,t,a){e.exports={mainCard:"_2Da-9",warningTextSec:"C-fXN",heading1:"_3F5yD",heading2:"_9bdOz",imgSection:"_3Ra8l",txtSection:"_2EBmQ"}},2110:function(e,t,a){"use strict";t.__esModule=!0;var s=v(a(24)),n=v(a(13)),o=v(a(20)),i=v(a(21)),r=v(a(1)),d=v(a(0)),l=a(31),u=a(44),c=a(82),p=a(54),f=v(a(1049)),h=v(a(165)),m=v(a(1514)),g=a(239);function v(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(){var a,s,i;(0,n.default)(this,t);for(var r=arguments.length,d=Array(r),l=0;l<r;l++)d[l]=arguments[l];return a=s=(0,o.default)(this,e.call.apply(e,[this].concat(d))),s.goToHome=function(){s.props.router.push("/")},i=a,(0,o.default)(s,i)}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){"undefined"==typeof window||this.props.item||this.props.isFetchingItem(this.props.itemId)||this.props.getItem()},t.prototype.getSubTitle=function(e){var t=e&&e.deeplinks&&e.deeplinks.deeplink;return t?(0,s.default)(h.default,{type:"btnMain",className:m.default.moreDeals,onClick:this.goToHome,href:"/"},void 0,t.label):null},t.prototype.render=function(){if(!this.props.item)return null;var e=this.props.message;return(0,s.default)("div",{className:m.default.itemBanner},void 0,(0,s.default)("div",{className:m.default.adContainer},void 0,(0,s.default)("div",{className:m.default.adImg},void 0,(0,s.default)(f.default,{image:this.props.item.images&&this.props.item.images.length&&this.props.item.images[0].small?this.props.item.images[0].small.url:"",diameter:"57px",style:t.style})),(0,s.default)("div",{className:m.default.adInfo},void 0,(0,s.default)("div",{className:m.default.adTitle},void 0,e&&e.title),(0,s.default)("div",{},void 0,this.getSubTitle(e)))))},t}(d.default.Component);I.propTypes={item:r.default.object,getItem:r.default.func,isFetchingItem:r.default.func,itemId:r.default.string,message:r.default.object,router:r.default.object.isRequired},I.defaultProps={message:{}},I.style={margin:"auto"};t.default=(0,l.compose)(c.withRouter,(0,u.connect)(function(e,t){return{item:e.items.elements[t.itemId],isFetchingItem:function(t){return e.items.isFetching[t]}}},function(e,t){return{getItem:function(){return e((0,p.get)(g.urls.getItem(t.itemId),"ELEMENT_ITEMS"))}}}))(I)},2111:function(e,t,a){"use strict";t.__esModule=!0;var s=M(a(26)),n=M(a(14)),o=M(a(24)),i=M(a(13)),r=M(a(20)),d=M(a(21)),l=M(a(346)),u=M(a(1052)),c=M(a(165)),p=M(a(1)),f=M(a(0)),h=M(a(237)),m=a(64),g=M(a(1079)),v=M(a(2112)),I=M(a(89)),C=M(a(2113));function M(e){return e&&e.__esModule?e:{default:e}}var _=l.default.icons,y=function(e){function t(a,s){(0,i.default)(this,t);var n=(0,r.default)(this,e.call(this,a,s));return n.sharePhoto=function(){n.checkBlockedUser()||(n.actionTriggered(),n.props.track("item_chat_tap_gallery",n.props.itemId),n.input.click())},n.uploadImage=function(e){var t=++n.index;n.props.sendImage(t,e.target.files[0])},n.uploadSound=function(){n.checkBlockedUser()||(n.isRecordingSupported?(n.track("item_chat_tap_voice",{select_from:"sender"}),window.navigator.getUserMedia({audio:!0},n.onSoundStreamOpen,n.onSoundStreamBlocked)):console.log("recording not supported"))},n.onSoundStreamOpen=function(e){n.audioContext=new window.AudioContext,n.audioStream=e,"running"===n.audioContext.state?n.recordAudio():n.setState({streamHanged:!0})},n.resumeStream=function(){n.audioContext.resume().then(function(){n.recordAudio()})},n.endStreamConnection=function(){n.setState({streamHanged:!1})},n.sendRecording=function(){n.state.showStopRecording&&(n.recorder.stop(),clearInterval(n.startTimer),n.setTextBoxState(!1),n.setState({showStopRecording:!1,secondsRecorded:0},function(){n.recorder.exportWAV(function(e,t){n.sendVoiceData(e,t),n.audioContext.close&&n.audioContext.close(),n.getDuration().then(function(t){n.track("item_chat_voice_complete",{select_from:"sender",result_count:t,file_size:e.size})})})}))},n.stopRecording=function(e){n.state.showStopRecording&&(n.track("item_chat_voice_cancel",{select_from:"sender"}),n.setTextBoxState(!1),n.recorder.stop(),n.recorder.clear(),clearInterval(n.startTimer),n.setState({showStopRecording:!1,secondsRecorded:0},function(){})),e.stopPropagation()},n.onSoundStreamBlocked=function(){n.props.showInfoMsg((0,o.default)(m.FormattedMessage,{id:"voicePermissionError"}))},n.onEnterKey=function(e){n.state.currentMessage&&""!==n.state.currentMessage.trim()&&(n.isMobile||13!==e.keyCode||e.shiftKey||(n.sendMessage(n.state.currentMessage.trim(),n.props.userId,n.props.itemId)(),e.preventDefault()))},n.handleChange=function(e){n.actionTriggered();var t=!1;e.target.value&&(n.props.sendUserState("composing"),t=!0),n.setState({currentMessage:e.target.value,showSend:t})},n.sendMessage=function(e,t,a){return function(){n.props.offline||n.checkBlockedUser()||(n.props.sendMessage(e,t,a),n.props.connAvailable&&n.setState({currentMessage:"",showSend:!1}))}},n.onMouseDown=function(e){e.preventDefault()},n.shareLocation=function(){n.checkBlockedUser()||(n.actionTriggered(),n.props.shareLocation())},n.checkBlockedUser=function(){return!!n.props.isBlocked&&(n.props.showUnblockPopup(),!0)},n.setDuration=function(e){n.state.recordingDuration||n.setState({recordingDuration:e.target.duration},function(){n.resolveDuration(n.state.recordingDuration),n.setState({recordingDuration:0})})},n.preventDefaultEvent=function(e){e.preventDefault()},n.state={currentMessage:"",showSend:!1,showStopRecording:!1,sourceURL:"",secondsRecorded:0,streamHanged:!1,recordingDuration:void 0},n.index=0,n.isMobile=window.screen.availWidth<s.config.get("breakpoint"),n.isRecordingSupported=n.isVoiceRecordingAvailable(),n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){var e=this.getAudioNode();e&&(e.addEventListener("loadeddata",this.setDuration),e.addEventListener("loadedmetadata",this.setDuration))},t.prototype.componentWillReceiveProps=function(e){this.props.currentMessage!==e.currentMessage?this.setState({currentMessage:e.currentMessage}):this.state.currentMessage!==e.currentMessage&&e.currentMessage&&this.setState({currentMessage:e.currentMessage})},t.prototype.componentWillUnmount=function(){this.recorder&&this.recorder.destroy();var e=this.getAudioNode();e&&(e.removeEventListener("loadeddata",this.setDuration),e.removeEventListener("loadedmetadata",this.setDuration))},t.prototype.sendVoiceData=function(e,t){this.setState({sourceURL:window.URL.createObjectURL(e)}),this.props.uploadVoiceData(e,t)},t.prototype.track=function(e,t){var a=this.props.itemId?{item_id:this.props.itemId}:{};this.context.track(e,(0,n.default)(a,t))},t.prototype.isVoiceRecordingAvailable=function(){if("undefined"!=typeof window){var e=!1,t=!1,a=!1,s=!1;return(window.URL||window.webkitURL)&&(window.URL=window.URL||window.webkitURL,e=!0),void 0!==window.navigator&&(window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia)&&(window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.webkitGetUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia,t=!0),(window.webkitAudioContext||window.mozAudioContext||window.AudioContext)&&(window.AudioContext=window.webkitAudioContext||window.mozAudioContext||window.AudioContext,a=!0),e&&t&&a&&(s=!0),s}return!1},t.prototype.getDuration=function(){return this.durationPromise},t.prototype.setTextBoxState=function(e){this.textBox.readOnly=e},t.prototype.recordAudio=function(){var e=this;this.setTextBoxState(!0);var t=this.audioContext.createMediaStreamSource(this.audioStream);this.recorder?this.recorder.setData(t,this.audioStream):this.recorder=new C.default(t,this.audioStream),this.durationPromise=new s.default(function(t,a){e.resolveDuration=t,e.rejectDuration=a});this.recorder.record(),this.track("item_chat_voice_start",{select_from:"sender"}),this.setState({showStopRecording:!0,streamHanged:!1}),this.startTimer=setInterval(function(){e.state.secondsRecorded+1>=parseInt(e.props.chatConfig.voiceData.maxLength,10)?e.sendRecording():e.setState({secondsRecorded:++e.state.secondsRecorded})},1e3)},t.prototype.secondsToTimer=function(e){for(var t=0,a=e,s="",n="";a>60;)a/=60,t++;return s=t<10?"0".concat(t.toString()):t,n=a<10?"0".concat(a.toString()):a,s.concat(":").concat(n)},t.prototype.isRTL=function(){var e=I.default.readCookie("lang")||this.context.config.get("langs")[0].code,t=this.context.config.get("langs").find(function(t){return t.code===e});return t&&"rtl"===t.dir},t.prototype.renderMessageButtons=function(){return this.props.chatConfig.voiceData&&this.props.chatConfig.voiceData.enableVoiceRecording&&this.isRecordingSupported&&!this.state.showSend?this.state.showStopRecording?(0,o.default)("div",{className:g.default.recordingActionsContainer},void 0,(0,o.default)("span",{className:""+g.default.recordingSign}),(0,o.default)("span",{className:""+g.default.recordingText},void 0,(0,o.default)(m.FormattedMessage,{id:"voiceRecordingMessage"})),(0,o.default)("span",{className:_.panameraIcons+" "+_["icon-ErrorHaired"]+" "+g.default.messageStopVoice+" "+(this.props.offline?g.default.disabled:g.default.enabled)+" "+(this.isRTL()?g.default.rotate180:""),"data-aut-id":"btnStopRecording",onClick:this.stopRecording,onMouseDown:this.onMouseDown}),(0,o.default)("span",{className:""+g.default.secondsRecordedText},void 0,this.secondsToTimer(this.state.secondsRecorded)),(0,o.default)("span",{className:_.panameraIcons+" "+_["icon-OKHaired"]+" "+g.default.messageSendVoice+" "+(this.props.offline?g.default.disabled:g.default.enabled)+" "+(this.isRTL()?g.default.rotate180:""),"data-aut-id":"btnSendRecording",onClick:this.sendRecording,onMouseDown:this.onMouseDown})):(0,o.default)("span",{className:_.panameraIcons+" "+_["icon-mic"]+" "+g.default.messageBoxVoice+" "+(this.props.offline?g.default.disabled:g.default.enabled)+" "+(this.isRTL()?g.default.rotate180:""),"data-aut-id":"btnStartRecording",onClick:this.uploadSound,onMouseDown:this.onMouseDown}):(0,o.default)("span",{className:_.panameraIcons+" "+_["icon-SendMessage"]+" "+g.default.messageBoxSend+" "+(""===this.state.currentMessage.trim()||this.props.offline?g.default.disabled:g.default.enabled)+" "+(this.isRTL()?g.default.rotate180:""),"data-aut-id":"btnSend",onClick:this.sendMessage(this.state.currentMessage.trim(),this.props.userId,this.props.itemId),onMouseDown:this.onMouseDown})},t.prototype.getAudioNode=function(){return h.default.findDOMNode(this.audio)},t.prototype.actionTriggered=function(){this.props.deleteOption&&this.props.hideDeleteOption()},t.prototype.render=function(){var e=this;return(0,o.default)("div",{className:g.default.messageBox},void 0,(0,o.default)(v.default,{sharePhoto:this.sharePhoto,shareLocation:this.shareLocation,enableImgFeature:this.props.chatConfig.imgData.enableImgFeature,onClick:this.preventDefaultEvent}),this.state.streamHanged&&(0,o.default)(u.default,{onClick:this.endStreamConnection,className:g.default.blockModal},void 0,(0,o.default)("div",{className:g.default.modalTitle},void 0,(0,o.default)(m.FormattedMessage,{id:"voicePermissionText"})),(0,o.default)(c.default,{type:"btnMain",onClick:this.resumeStream,className:g.default.buttonStyle+" "+g.default.cancelOption},void 0,(0,o.default)(m.FormattedMessage,{id:"ok"}))),f.default.createElement("input",{ref:function(t){return e.input=t},type:"file",accept:"image/*",style:{display:"none"},value:this.props.selectedFile,onChange:this.uploadImage}),(0,o.default)(m.FormattedMessage,{id:"msgBoxPlaceholder"},void 0,function(t){return f.default.createElement("textarea",{className:g.default.messageTextBox,placeholder:t,"data-aut-id":"inputBox",onChange:e.handleChange,value:e.state.currentMessage,onKeyDown:e.onEnterKey,ref:function(t){return e.textBox=t}})}),this.renderMessageButtons(),!this.state.showSend&&(0,o.default)("div",{className:g.default.voiceRecordedContainer},void 0,f.default.createElement("audio",{ref:function(t){e.audio=t},controls:!0,src:this.state.sourceURL})))},t}(f.default.Component);y.contextTypes={config:p.default.object,track:p.default.func},y.propTypes={sendMessage:p.default.func,sendImage:p.default.func,uploadVoiceData:p.default.func,shareLocation:p.default.func,sendUserState:p.default.func,track:p.default.func,selectedFile:p.default.string,itemId:p.default.string,userId:p.default.string,chatConfig:p.default.object,isBlocked:p.default.bool,showUnblockPopup:p.default.func,deleteOption:p.default.bool,hideDeleteOption:p.default.func,offline:p.default.bool,connAvailable:p.default.bool,currentMessage:p.default.string,showInfoMsg:p.default.func.isRequired},y.defaultProps={selectedFile:""},t.default=y},2112:function(e,t,a){"use strict";t.__esModule=!0;var s=p(a(24)),n=p(a(13)),o=p(a(20)),i=p(a(21)),r=p(a(0)),d=p(a(1)),l=p(a(346)),u=a(64),c=p(a(1079));function p(e){return e&&e.__esModule?e:{default:e}}var f=l.default.icons,h=function(e){function t(){(0,n.default)(this,t);var a=(0,o.default)(this,e.call(this));return a.handleClickOutside=function(e){var t=a.container;t&&t.contains(e.target)||!a.state.open||a.setState({open:!1})},a.toggleContainer=function(){a.setState({open:!a.state.open})},a.onMouseDown=function(e){e.preventDefault()},a.onClick=function(e){return function(){"photo"===e?a.props.sharePhoto():a.props.shareLocation(),a.toggleContainer()}},a.state={open:!1},a.index=0,a}return(0,i.default)(t,e),t.prototype.componentDidMount=function(){"undefined"!=typeof document&&(document.addEventListener("click",this.handleClickOutside,!0),document.addEventListener("touchstart",this.handleClickOutside,!0))},t.prototype.componentWillUnmount=function(){"undefined"!=typeof document&&(document.removeEventListener("click",this.handleClickOutside,!0),document.removeEventListener("touchstart",this.handleClickOutside,!0))},t.prototype.render=function(){var e=this;return r.default.createElement("div",{className:c.default.attachmentIcon,"data-aut-id":"btnAttachment",ref:function(t){return e.container=t},onClick:this.props.onClick},(0,s.default)("span",{className:f.panameraIcons+" "+f["icon-attach"]+" "+c.default.attachIcon,onMouseDown:this.onMouseDown,onClick:this.toggleContainer}),this.state.open&&(0,s.default)("div",{className:c.default.attachmentContainer},void 0,(0,s.default)("div",{className:c.default.attachmentEmptyChild}),this.props.enableImgFeature&&(0,s.default)("div",{className:c.default.attachmentChild+" "+c.default.first,"data-aut-id":"btnCamera",onClick:this.onClick("photo")},void 0,(0,s.default)("span",{className:f.panameraIcons+" "+f["icon-Photo"]+" "+c.default.shareIcon}),(0,s.default)("span",{className:c.default.shareText},void 0,(0,s.default)(u.FormattedMessage,{id:"shareImage"}))),(0,s.default)("div",{className:c.default.attachmentChild+" "+c.default.last,"data-aut-id":"btnLocation",onClick:this.onClick("loc")},void 0,(0,s.default)("span",{className:f.panameraIcons+" "+f["icon-Location"]+" "+c.default.shareIcon+"  "+c.default.locIcon}),(0,s.default)("span",{className:c.default.shareText},void 0,(0,s.default)(u.FormattedMessage,{id:"shareLoc"}))),(0,s.default)("div",{className:c.default.attachmentEmptyChild})))},t}(r.default.Component);h.propTypes={shareLocation:d.default.func,sharePhoto:d.default.func,enableImgFeature:d.default.bool,onClick:d.default.func},t.default=h},2113:function(e,t,a){"use strict";t.__esModule=!0;var s=o(a(13)),n=o(a(2114));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(t,a,o){(0,s.default)(this,e),this.worker=new window.Worker(n.default),this.setData(t,a,o)}return e.prototype.setData=function(e,t,a){var s=this;this.clear(),this.config=a||{},this.stream=t,this.source=e;var n=this.config.bufferLen||4096;this.context=e.context,this.node=this.context.createScriptProcessor(n,2,2),this.postMessage({command:"init",config:{sampleRate:this.context.sampleRate}}),this.recording=!1,this.currCallback=null,this.duration=0,this.node.onaudioprocess=function(e){if(!s.recording)return s.duration=e.outputBuffer.duration,s.node.onaudioprocess=null,s.node.disconnect(),s.source.disconnect(),void(s.stream&&(s.stream.getTracks().forEach(function(e){e.stop()}),delete s.stream));s.postMessage({command:"record",buffer:[e.inputBuffer.getChannelData(0),e.inputBuffer.getChannelData(1)]})},this.worker.onmessage=function(e){var t=e.data;s.node.onaudioprocess=null,s.node.disconnect(),s.source.disconnect(),s.stream&&(s.stream.getTracks().forEach(function(e){e.stop()}),delete s.stream),s.currCallback(t,s.duration)},this.source.connect(this.node),this.node.connect(this.context.destination)},e.prototype.configure=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t])},e.prototype.record=function(){this.recording=!0},e.prototype.stop=function(){this.recording=!1},e.prototype.postMessage=function(e){this.worker&&this.worker.postMessage&&this.worker.postMessage(e)},e.prototype.clear=function(){this.postMessage({command:"clear"})},e.prototype.destroy=function(){this.worker.terminate()},e.prototype.getBuffer=function(e){this.currCallback=e||this.config.callback,this.postMessage({command:"getBuffer"})},e.prototype.exportWAV=function(e,t){if(this.currCallback=e||this.config.callback,t=t||this.config.type||"audio/wav",!this.currCallback)throw new Error("Callback not set");this.postMessage({command:"exportWAV",type:t})},e}();t.default=i},2114:function(e,t,a){"use strict";e.exports="/recorder.worker.94c4634d5731f0816fb0e07232b91158.js"},2115:function(e,t,a){"use strict";t.__esModule=!0;var s=l(a(24)),n=l(a(1052)),o=l(a(165)),i=l(a(1)),r=(l(a(0)),a(64)),d=l(a(1079));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){return(0,s.default)(n.default,{onClick:e.toggleDeletePopup,className:d.default.blockModal},void 0,(0,s.default)("div",{className:d.default.modalTitle},void 0,(0,s.default)(r.FormattedMessage,{id:"deleteUserDialog"})),(0,s.default)(o.default,{type:"btnMain",onClick:e.confirmDelete,className:d.default.buttonStyle},void 0,(0,s.default)(r.FormattedMessage,{id:"ok"})),(0,s.default)(o.default,{type:"btnMain",onClick:e.toggleDeletePopup,className:d.default.buttonStyle+" "+d.default.cancelOption},void 0,(0,s.default)(r.FormattedMessage,{id:"cancel"})))};u.propTypes={toggleDeletePopup:i.default.func,confirmDelete:i.default.func},t.default=u},2116:function(e,t,a){"use strict";t.__esModule=!0;var s=l(a(24)),n=l(a(1052)),o=l(a(165)),i=l(a(1)),r=(l(a(0)),a(64)),d=l(a(1079));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){var t={user:e.userName};return(0,s.default)(n.default,{onClick:e.toggleBlockDialog,className:d.default.blockModal},void 0,(0,s.default)("div",{className:d.default.modalTitle},void 0,(0,s.default)(r.FormattedMessage,{id:e.value+"UserDialog",values:t})),(0,s.default)(o.default,{type:"btnMain",onClick:e.blockUser(e.value),className:d.default.buttonStyle},void 0,(0,s.default)(r.FormattedMessage,{id:""+e.value})),(0,s.default)(o.default,{type:"btnMain",onClick:e.toggleBlockDialog,className:d.default.buttonStyle+" "+d.default.cancelOption},void 0,(0,s.default)(r.FormattedMessage,{id:"cancel"})))};u.propTypes={toggleBlockDialog:i.default.func,blockUser:i.default.func,value:i.default.string,userName:i.default.string},t.default=u},926:function(e,t,a){"use strict";t.__esModule=!0;var s=a(2036);Object.defineProperty(t,"Chat",{enumerable:!0,get:function(){return o(s).default}});var n=a(2055);function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"ChatThread",{enumerable:!0,get:function(){return o(n).default}})}}]);
//# sourceMappingURL=desktop-chat.olx.d7be703174fed543e516.js.map